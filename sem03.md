<!--
author:     Alexander Trofimov
attribute:  **Editor:** Daria Gudkova
email:    
date:       21/02/2025
version:    0.2
language:   en
narrator:   English

icon:    ./icon.png
logo:    ./course_logo.png

comment:  –ö—É—Ä—Å "–í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ"

import:   ./macro.md
          https://raw.githubusercontent.com/LiaScript/CodeRunner/master/README.md

link:     ./custom.css

-->

## –°–µ–º–∏–Ω–∞—Ä. –û—Å–Ω–æ–≤—ã –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
-----

!?[Lecture03 Video](https://www.youtube.com/watch?v=8pTEmbeENF4)

> **üç≤ –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –≥–æ—Ç–æ–≤–∏—Ç–µ —Å—É–ø –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤.** –£ –≤–∞—Å –µ—Å—Ç—å –º–æ—Ä–∫–æ–≤—å (–æ–≥—Ä–æ–º–Ω–∞—è), –∫–∞—Ä—Ç–æ—à–∫–∞ (–∫—Ä–æ—à–µ—á–Ω–∞—è), –ª—É–∫ (—Å —à–µ–ª—É—Ö–æ–π), –∏ –º—è—Å–æ (—á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø–æ—Ä—á–µ–Ω–Ω–æ–µ). –ï—Å–ª–∏ —Å—Ä–∞–∑—É –≤—Å—ë –±—Ä–æ—Å–∏—Ç—å –≤ –∫–∞—Å—Ç—Ä—é–ª—é ‚Äî —Å—É–ø –ø–æ–ª—É—á–∏—Ç—Å—è –Ω–µ–≤–∫—É—Å–Ω—ã–º. –°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ: –ø–æ—á–∏—Å—Ç–∏—Ç—å, –ø–æ—Ä–µ–∑–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ, –≤—ã–±—Ä–æ—Å–∏—Ç—å –∏—Å–ø–æ—Ä—á–µ–Ω–Ω–æ–µ. –¢–æ –∂–µ —Å–∞–º–æ–µ —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è!

–í –¥–∞–Ω–Ω–æ–º —Å–µ–º–∏–Ω–∞—Ä–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è: —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö.

–û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ—É—Ç–±—É–∫ —Å —Å–µ–º–∏–Ω–∞—Ä–æ–º –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ: [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1uF7NTcqFQUmNaO4H2_IMm4DbxdqT8aeR?usp=sharing)

----
<h3 style="text-align: center;">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</h3>



----
### –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
----

> **üè™ –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: –í—ã —É—Å—Ç—Ä–æ–∏–ª–∏—Å—å Data Scientist'–æ–º –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω.** –î–∏—Ä–µ–∫—Ç–æ—Ä –≥–æ–≤–æ—Ä–∏—Ç: "–£ –Ω–∞—Å –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –∑–∞ $5$ –ª–µ—Ç, –ø–æ—Å—Ç—Ä–æ–π –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ–∫—É–ø–æ–∫!" –í—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ —Ñ–∞–π–ª –∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–æ. –í–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è?

```ascii
| –ò–º—è    | –í–æ–∑—Ä–∞—Å—Ç | –î–æ—Ö–æ–¥  | –ì–æ—Ä–æ–¥       | –ü–æ–∫—É–ø–∫–∏ |
|--------|---------|--------|-------------|---------|
| –ê–Ω–Ω–∞   | 25      | 50000  | –ú–æ—Å–∫–≤–∞      | 15      |
| –ë–æ—Ä–∏—Å  | NaN     | 75000  | –°–ü–±         | 8       |
| –°–≤–µ—Ç–∞  | 35      | NaN    | –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥| 22      |
| –î–º–∏—Ç—Ä–∏–π| 40      | 120000 | –º–æ—Å–∫–≤–∞      | NaN     |
```

–í–∏–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã? –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (NaN), —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∑–∞–ø–∏—Å–∏ –≥–æ—Ä–æ–¥–æ–≤, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–∫—É–ø–∫–∞—Ö... –ò–º–µ–Ω–Ω–æ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Ç–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –Ω—É–∂–Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞!

–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º —ç—Ç–∞–ø–æ–º –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ Data Scientist'–∞ —Ç—Ä–∞—Ç–∏—Ç—Å—è –∏–º–µ–Ω–Ω–æ –Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É!

–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–æ–±–ª–µ–º—ã:

- **–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø–∏—Å—è—Ö
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** ‚Äî –Ω–µ—á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç—Ä–µ–±—É—é—â–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è  
- **–†–∞–∑–ª–∏—á–Ω—ã–µ –º–∞—Å—à—Ç–∞–±—ã** ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—â–∏–º–∏—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ –∑–Ω–∞—á–µ–Ω–∏–π
- **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** ‚Äî –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, —Å–æ–∑–¥–∞—é—â–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å
- **–í—ã–±—Ä–æ—Å—ã** ‚Äî –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ—Ä—Ç–∏—Ç—å –º–æ–¥–µ–ª—å
- **–ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã** ‚Äî "–ú–æ—Å–∫–≤–∞" vs "–º–æ—Å–∫–≤–∞" vs "Moscow"

@NB(`**Garbage in, garbage out**. –î–∞–∂–µ —Å–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–µ —Å–º–æ–∂–µ—Ç –¥–∞—Ç—å —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –ø–ª–æ—Ö–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.`)

@img02(GIGO.png, GIGO, 30)

**–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:**

1. **–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö**
2. **–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤, –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –æ—à–∏–±–æ–∫)
3. **–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π**
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**
5. **–û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** (—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏, —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)

---
### –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
---

–ü–µ—Ä–≤–æ–µ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ª—é–±—ã–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º, -- –ø–æ–ª—É—á–∏—Ç—å –æ–±—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö.

**–ö–ª—é—á–µ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –¥–∞–Ω–Ω—ã—Ö:**

- –ö–∞–∫–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö?
- –ö–∞–∫–∏–µ —Ç–∏–ø—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤?
- –ù–µ—Ç –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤?
- –ï—Å—Ç—å –ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö?
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –¥–∞–Ω–Ω—ã—Ö (–º–∏–Ω–∏–º—É–º 10-20 –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫ –¥–ª—è –ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π)?
- –ö–∞–∫–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π?
- –†–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã –ª–∏ –¥–∞–Ω–Ω—ã–µ (–æ—Ç—Ä–∞–∂–∞—é—Ç –ª–∏ –æ–Ω–∏ —Ä–µ–∞–ª—å–Ω—ã–π –º–∏—Ä)?
- –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã –ª–∏ –∫–ª–∞—Å—Å—ã (–≤–∞–∂–Ω–æ –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)?
- –ï—Å—Ç—å –ª–∏ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑ –±—É–¥—É—â–µ–≥–æ –∏–ª–∏ –ø—Ä—è–º–æ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π)?
- –ï—Å—Ç—å –ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è (–Ω—É–∂–Ω–æ –ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –¥–∞–Ω–Ω—ã—Ö)?

**–û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:**

1. `.head()`/`.tail()` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –ø–µ—Ä–≤—ã–µ/–ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
2. `.info()` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —Ç–∏–ø—ã, –ø—Ä–æ–ø—É—Å–∫–∏
3. `.describe()` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
4. `.shape` ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
5. `.dtypes` ‚Äî —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
6. `.nunique()` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å `.info()` ‚Äî —ç—Ç–æ –¥–∞—Å—Ç –æ–±—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –¥–∞–Ω–Ω—ã—Ö
- –ò—â–∏—Ç–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö ‚Äî —Ä–∞–∑–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä, –æ–ø–µ—á–∞—Ç–∫–∏, —Å–∏–Ω–æ–Ω–∏–º—ã
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å ‚Äî –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—ã, –¥–∞—Ç—ã –∏–∑ –±—É–¥—É—â–µ–≥–æ
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ‚Äî –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –ø–æ–º–æ–≥—É—Ç —É–≤–∏–¥–µ—Ç—å –≤—ã–±—Ä–æ—Å—ã
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Ö–æ–¥–∫–∏ ‚Äî –∑–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ –≤—Å–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

@NB(`–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∞–Ω–∞–ª–∏–∑—É, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã –∏ –Ω–µ –ø–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ!`)

–≠—Ç–æ—Ç —ç—Ç–∞–ø –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–∞–±–æ—Ç—ã. –¢—â–∞—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç –µ—ë –∫–∞—á–µ—Å—Ç–≤–æ.

---
**üìã –ü—Ä–∏–º–µ—Ä.** –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏.

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ü–µ–Ω –Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã. –ü—Ä–æ–≤–µ–¥–µ–º –ø–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö.

**–ó–∞–º–µ—á–∞–Ω–∏–µ**: –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–∞–ø—ã –∞–Ω–∞–ª–∏–∑–∞ –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã, –æ–¥–Ω–∞–∫–æ —ç—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –Ω–∞—Ü–µ–ª–µ–Ω –Ω–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ—ç—Ç–æ–º—É –¥–∞–≤–∞–π—Ç–µ —Å—Ä–∞–≤–Ω–∏–º –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

```python
import pandas as pd
import numpy as np
import warnings
warnings.filterwarnings('ignore')

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
np.random.seed(42)
n = 1000

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏
data = {
    'id': range(1, n+1),
    '–ø–ª–æ—â–∞–¥—å': np.random.normal(65, 25, n),
    '–∫–æ–º–Ω–∞—Ç—ã': np.random.choice([1, 2, 3, 4, 5], n, p=[0.15, 0.35, 0.30, 0.15, 0.05]),
    '—ç—Ç–∞–∂': np.random.randint(1, 25, n),
    '—Ä–∞–π–æ–Ω': np.random.choice(['–¶–µ–Ω—Ç—Ä', '–°–ø–∞–ª—å–Ω—ã–π', '–û–∫—Ä–∞–∏–Ω–∞', '—Ü–µ–Ω—Ç—Ä', '–¶–ï–ù–¢–†'], n),
    '–≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏': np.random.randint(1960, 2024, n),
    '–±–∞–ª–∫–æ–Ω': np.random.choice(['–µ—Å—Ç—å', '–Ω–µ—Ç', '1', '0', np.nan], n),
    '—Ü–µ–Ω–∞': [],
    '–º–µ—Ç—Ä–æ_–º–∏–Ω—É—Ç': np.random.choice([5, 10, 15, 20, 30, np.nan], n)
}

# –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—É—é —Ü–µ–Ω—É
for i in range(n):
    base_price = 100000 * data['–ø–ª–æ—â–∞–¥—å'][i]
    if data['—Ä–∞–π–æ–Ω'][i] in ['–¶–µ–Ω—Ç—Ä', '—Ü–µ–Ω—Ç—Ä', '–¶–ï–ù–¢–†']:
        base_price *= 1.5
    data['—Ü–µ–Ω–∞'].append(base_price + np.random.normal(0, 500000)) # Append to the list

df = pd.DataFrame(data)

# –î–æ–±–∞–≤–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
df = pd.concat([df, df.iloc[10:15]], ignore_index=True)

# –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏
df.loc[np.random.choice(len(df), 50), '–ø–ª–æ—â–∞–¥—å'] = np.nan
df.loc[np.random.choice(len(df), 100), '–≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏'] = np.nan

# –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±—Ä–æ—Å—ã
df.loc[0, '–ø–ª–æ—â–∞–¥—å'] = 500  # –ù–µ—Ä–µ–∞–ª—å–Ω–æ –±–æ–ª—å—à–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞
df.loc[1, '—Ü–µ–Ω–∞'] = -100000  # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (–æ—à–∏–±–∫–∞)

print("\n", "="*60, "\n–≠–¢–ê–ü 1: –ü–ï–†–í–´–ô –í–ó–ì–õ–Ø–î –ù–ê –î–ê–ù–ù–´–ï\n", "="*60)

print("\n–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:")
print(f"–°—Ç—Ä–æ–∫: {df.shape[0]}, –°—Ç–æ–ª–±—Ü–æ–≤: {df.shape[1]}")

print("\n–ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫:")
print(df.head())

print("\n–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å—Ç—Ä–æ–∫–∏:")
print(df.tail(3))

print("\n", "="*60, "\n–≠–¢–ê–ü 2: –°–¢–†–£–ö–¢–£–†–ê –ò –¢–ò–ü–´ –î–ê–ù–ù–´–•\n", "="*60)

print("\n–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–∞—Å–µ—Ç–µ:")
df.info()

print("\n–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º:")
print(df.dtypes)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–∏–ø–æ–≤
for col in df.columns:
    if col in ['–ø–ª–æ—â–∞–¥—å', '—Ü–µ–Ω–∞', '–º–µ—Ç—Ä–æ_–º–∏–Ω—É—Ç']:
        if df[col].dtype == 'object':
            print(f"{col}: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–≤—ã–º, –Ω–æ —è–≤–ª—è–µ—Ç—Å—è {df[col].dtype}")
    elif col in ['—Ä–∞–π–æ–Ω', '–±–∞–ª–∫–æ–Ω']:
        if df[col].dtype != 'object':
            print(f"{col}: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º, –Ω–æ —è–≤–ª—è–µ—Ç—Å—è {df[col].dtype}")

print("\n", "="*60, "\n–≠–¢–ê–ü 3: –°–¢–ê–¢–ò–°–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó\n", "="*60)

print("\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:")
print(df.describe().round(2))

print("\n–ê–Ω–∞–ª–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:")
categorical_cols = df.select_dtypes(include='object').columns
for col in categorical_cols:
    print("\n", df[col].value_counts())
    if df[col].nunique() < df[col].count():
        print(f"–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: {df[col].nunique()}")

print("\n", "="*60, "\n–≠–¢–ê–ü 4: –ü–†–û–í–ï–†–ö–ê –ö–ê–ß–ï–°–¢–í–ê –î–ê–ù–ù–´–•\n", "="*60)

# –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
print("\n–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:")
missing = df.isnull().sum()
missing_percent = (missing / len(df) * 100).round(2)
missing_df = pd.DataFrame({
    '–ü—Ä–æ–ø—É—Å–∫–æ–≤': missing,
    '–ü—Ä–æ—Ü–µ–Ω—Ç': missing_percent
}).sort_values('–ü—Ä–æ–ø—É—Å–∫–æ–≤', ascending=False)
print(missing_df[missing_df['–ü—Ä–æ–ø—É—Å–∫–æ–≤'] > 0])

# –î—É–±–ª–∏–∫–∞—Ç—ã
print(f"\n–î—É–±–ª–∏–∫–∞—Ç—ã:")
duplicates = df.duplicated().sum()
print(f"–ù–∞–π–¥–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å—Ç—Ä–æ–∫: {duplicates}")
if duplicates > 0:
    print("–ü—Ä–∏–º–µ—Ä—ã –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫:")
    print(df[df.duplicated(keep=False)].head())

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å ID
if 'id' in df.columns:
    unique_ids = df['id'].nunique()
    total_ids = len(df['id'])
    if unique_ids < total_ids:
        print(f"\n–í–ù–ò–ú–ê–ù–ò–ï: ID –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã! –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö: {unique_ids}, –í—Å–µ–≥–æ: {total_ids}")

print("\n", "="*60, "\n–≠–¢–ê–ü 5: –ü–û–ò–°–ö –ê–ù–û–ú–ê–õ–ò–ô\n", "="*60)

# –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≥–¥–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å
for col in ['–ø–ª–æ—â–∞–¥—å', '—Ü–µ–Ω–∞', '–∫–æ–º–Ω–∞—Ç—ã', '—ç—Ç–∞–∂']:
    if col in df.columns:
        negative = df[df[col] < 0]
        if len(negative) > 0:
            print(f"\n–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ '{col}':")
            print(negative[[col]].head())

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—É–º–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–π:")
if '–ø–ª–æ—â–∞–¥—å' in df.columns:
    huge_flats = df[df['–ø–ª–æ—â–∞–¥—å'] > 300]
    if len(huge_flats) > 0:
        print(f"–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–∏–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã (>300 –º¬≤): {len(huge_flats)} —à—Ç.")
        print(huge_flats[['–ø–ª–æ—â–∞–¥—å', '—Ü–µ–Ω–∞']].head())

if '–≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏' in df.columns:
    future_buildings = df[df['–≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏'] > 2024]
    if len(future_buildings) > 0:
        print(f"–ó–¥–∞–Ω–∏—è –∏–∑ –±—É–¥—É—â–µ–≥–æ: {len(future_buildings)} —à—Ç.")

# –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
print("\n–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:")
if '—Ä–∞–π–æ–Ω' in df.columns:
    unique_districts = df['—Ä–∞–π–æ–Ω'].unique()
    print(f"–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–π–æ–Ω–∞: {unique_districts}")
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –¥—É–±–ª–∏ —Å —Ä–∞–∑–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–º
    lower_districts = [d.lower() if pd.notna(d) else d for d in unique_districts]
    if len(set(lower_districts)) < len(unique_districts):
        print("–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã —Å —Ä–∞–∑–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–º!")

print("\n", "="*60, "\n–≠–¢–ê–ü 6: –ê–ù–ê–õ–ò–ó –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ô\n", "="*60)

# –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ –∏ —ç–∫—Å—Ü–µ—Å—Å–∞
print("\n–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π:")
numerical_cols = df.select_dtypes(include=[np.number]).columns
for col in numerical_cols:
    if col != 'id':
        skewness = df[col].skew()
        kurtosis = df[col].kurtosis()
        print(f"{col}:")
        print(f"  –ê—Å–∏–º–º–µ—Ç—Ä–∏—è: {skewness:.2f} {'(—Å–∏–ª—å–Ω–æ —Å–∫–æ—à–µ–Ω–æ –≤–ø—Ä–∞–≤–æ)' if skewness > 1 else '(—Å–∏–ª—å–Ω–æ —Å–∫–æ—à–µ–Ω–æ –≤–ª–µ–≤–æ)' if skewness < -1 else '(–±–ª–∏–∑–∫–æ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É)'}")
        print(f"  –≠–∫—Å—Ü–µ—Å—Å: {kurtosis:.2f} {'(—Ç—è–∂–µ–ª—ã–µ —Ö–≤–æ—Å—Ç—ã)' if kurtosis > 3 else '(–ª–µ–≥–∫–∏–µ —Ö–≤–æ—Å—Ç—ã)' if kurtosis < -1 else '(–Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ö–≤–æ—Å—Ç—ã)'}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

<details>
<summary>~~**–†–∞–∑–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞**~~</summary>

–î–∞–≤–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º, —á—Ç–æ –º—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ –∞–Ω–∞–ª–∏–∑–∞ –∏ –∫–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

**–≠–¢–ê–ü 1: –ü–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥ –Ω–∞ –¥–∞–Ω–Ω—ã–µ**

–ö–æ–º–∞–Ω–¥—ã `.head()` –∏ `.tail()` –ø–æ–∑–≤–æ–ª—è—é—Ç –±—ã—Å—Ç—Ä–æ –æ—Ü–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö:

- –ú—ã –≤–∏–¥–∏–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–≤–∞—Ä—Ç–∏—Ä–∞—Ö (–ø–ª–æ—â–∞–¥—å, –∫–æ–º–Ω–∞—Ç—ã, —ç—Ç–∞–∂, —Ä–∞–π–æ–Ω)
- –°—Ä–∞–∑—É –∑–∞–º–µ—Ç–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ ‚Äî –ø–ª–æ—â–∞–¥—å $500 –º¬≤$ –≤—ã–≥–ª—è–¥–∏—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ
- –í –∫–æ–ª–æ–Ω–∫–µ "—Ä–∞–π–æ–Ω" –≤–∏–¥–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–≥–∏—Å—Ç—Ä–æ–º ("–¶–µ–Ω—Ç—Ä" vs "—Ü–µ–Ω—Ç—Ä")
- –ö–æ–ª–æ–Ω–∫–∞ "–±–∞–ª–∫–æ–Ω" —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö ("–µ—Å—Ç—å"/"–Ω–µ—Ç" –∏ "$1$"/"$0$")

**–≠–¢–ê–ü 2: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**

–ú–µ—Ç–æ–¥ `.info()` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ ($1005$)
- –í–∏–¥–Ω—ã –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö "–ø–ª–æ—â–∞–¥—å", "–≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏", "–±–∞–ª–∫–æ–Ω", "–º–µ—Ç—Ä–æ_–º–∏–Ω—É—Ç"
- –í—Å–µ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö (float64 –∏–ª–∏ int64)
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–∞–∫ object

**–≠–¢–ê–ü 3: –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑**

–ú–µ—Ç–æ–¥ `.describe()` –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ü–µ–Ω–∞ –∏ –ø–ª–æ—â–∞–¥—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ ($-100000$, $-16.03$) ‚Äî —è–≤–Ω–∞—è –æ—à–∏–±–∫–∞!
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å ($500 –º¬≤$) —Å–∏–ª—å–Ω–æ –≤—ã–±–∏–≤–∞–µ—Ç—Å—è –∏–∑ –æ–±—â–µ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- –°—Ä–µ–¥–Ω—è—è –ø–ª–æ—â–∞–¥—å ($65 –º¬≤$) –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ($25 –º¬≤$) –≤—ã–≥–ª—è–¥—è—Ç —Ä–∞–∑—É–º–Ω–æ
- –ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è –æ—Ç $1960$ –¥–æ $2023$, —á—Ç–æ –ª–æ–≥–∏—á–Ω–æ

–î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ `.value_counts()` –≤—ã—è–≤–ª—è–µ—Ç:

- –í –∫–æ–ª–æ–Ω–∫–µ "—Ä–∞–π–æ–Ω" –µ—Å—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã —Å —Ä–∞–∑–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–º
- –í –∫–æ–ª–æ–Ω–∫–µ "–±–∞–ª–∫–æ–Ω" —Å–º–µ—à–∞–Ω—ã —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∑–∞–ø–∏—Å–∏ –æ–¥–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–≠–¢–ê–ü 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö**

–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

- –ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–ø—É—â–µ–Ω –≤ $10\%$ —Å–ª—É—á–∞–µ–≤ ‚Äî –Ω—É–∂–Ω–∞ –∏–º–ø—É—Ç–∞—Ü–∏—è
- –ü–ª–æ—â–∞–¥—å –ø—Ä–æ–ø—É—â–µ–Ω–∞ –≤ $5\%$ —Å–ª—É—á–∞–µ–≤ ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã 5 –ø–æ–ª–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å—Ç—Ä–æ–∫ ‚Äî –Ω—É–∂–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ

**–≠–¢–ê–ü 5: –ü–æ–∏—Å–∫ –∞–Ω–æ–º–∞–ª–∏–π**

–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤—ã—è–≤–∏–ª–∞:

- –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞ ‚Äî –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ö–≤–∞—Ä—Ç–∏—Ä–∞ –ø–ª–æ—â–∞–¥—å—é $500 –º¬≤$ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–æ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ, –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞
- –î—É–±–ª–∏–∫–∞—Ç—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Ä–∞–π–æ–Ω–æ–≤ —Å —Ä–∞–∑–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–º ‚Äî —Ç—Ä–µ–±—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏

**–≠–¢–ê–ü 6: –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π**

–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ –∏ —ç–∫—Å—Ü–µ—Å—Å–∞ –≥–æ–≤–æ—Ä—è—Ç –Ω–∞–º:

- –¶–µ–Ω–∞ –∏–º–µ–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –∞—Å–∏–º–º–µ—Ç—Ä–∏—é (—Å–∫–æ—à–µ–Ω–∞ –≤–ø—Ä–∞–≤–æ) ‚Äî —Ç–∏–ø–∏—á–Ω–æ –¥–ª—è —Ü–µ–Ω –Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å
- –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–≤–∞—Ä—Ç–∏—Ä –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–¥–æ—Ä–æ–≥–∏–µ, –Ω–æ –µ—Å—Ç—å –¥–æ—Ä–æ–≥–∏–µ –≤—ã–±—Ä–æ—Å—ã
- –ü—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—ã
</details>

<br>

<details>

<summary>**~~–í—ã–≤–æ–¥—ã –∏ –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π~~**</summary>

–ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –º—ã –≤—ã—è–≤–∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–µ:

1. **–£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** ‚Äî —É–±—Ä–∞—Ç—å $5$ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å—Ç—Ä–æ–∫
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫**:

   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é —Ü–µ–Ω—É
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—É —Å –ø–ª–æ—â–∞–¥—å—é $500 –º¬≤$

3. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π**:

   - –ü—Ä–∏–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–∞–π–æ–Ω–æ–≤ –∫ –µ–¥–∏–Ω–æ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
   - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ "–±–∞–ª–∫–æ–Ω"

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤**:

   - –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–ª–æ—â–∞–¥–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –º–æ–¥–µ–ª–∏)
   - –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –≥–æ–¥—ã –ø–æ—Å—Ç—Ä–æ–π–∫–∏
   - –†–µ—à–∏—Ç—å, —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –≤ "–º–µ—Ç—Ä–æ_–º–∏–Ω—É—Ç" –∏ "–±–∞–ª–∫–æ–Ω"

5. **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è**:

   - –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—ã –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
   - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–æ–∑—Ä–∞—Å—Ç –¥–æ–º–∞)

</details>

<br>

---
### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
----

**–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** ‚Äî —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö. –¢–æ –µ—Å—Ç—å, –≤ —Ç–∞–±–ª–∏—Ü–µ (–¥–∞—Ç–∞—Å–µ—Ç–µ) –µ—Å—Ç—å —è—á–µ–π–∫–∏, –≥–¥–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å, –Ω–æ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –µ—ë –Ω–µ—Ç.

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

- **–û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö.** –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–µ–Ω—Å–æ—Ä –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞.
- **–ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç–æ—Ä.** –†–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç –≤ –∞–Ω–∫–µ—Ç–µ –Ω–µ –∑–∞—Ö–æ—Ç–µ–ª –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ –¥–æ—Ö–æ–¥).
- **–ù–µ—É–º–µ—Å—Ç–Ω–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–∞.** –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –∞–Ω–∫–µ—Ç–µ –µ—Å—Ç—å –ø–æ–ª–µ "–≤–æ–∑—Ä–∞—Å—Ç —Ä–µ–±—ë–Ω–∫–∞", –∞ —á–µ–ª–æ–≤–µ–∫ ‚Äî –±–µ–∑–¥–µ—Ç–Ω—ã–π. –õ–æ–≥–∏—á–Ω–æ, —á—Ç–æ –æ–Ω –æ—Å—Ç–∞–≤–∏—Ç —ç—Ç–æ –ø–æ–ª–µ –ø—É—Å—Ç—ã–º.
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏.** –û—à–∏–±–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ, –∑–∞–≥—Ä—É–∑–∫–µ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
- **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö.** –ö–æ–≥–¥–∞ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç —Ç–∞–±–ª–∏—Ü—ã, –≤ –æ–¥–Ω–æ–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø–æ–ª—è–º ‚Äî –ø–æ–ª—É—á–∞—é—Ç—Å—è –ø—Ä–æ–ø—É—Å–∫–∏.

**–¢–∏–ø—ã –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

| –¢–∏–ø | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-----|------------|---------|
| **MCAR** (Missing Completely at Random) | –ü—Ä–æ–ø—É—Å–∫–∏ —Å–ª—É—á–∞–π–Ω—ã –∏ –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –¥—Ä—É–≥–∏—Ö –¥–∞–Ω–Ω—ã—Ö | –ê–Ω–∫–µ—Ç–∞ –ø–æ—Ç–µ—Ä—è–ª–∞—Å—å –∏–∑-–∑–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏ |
| **MAR** (Missing at Random) | –ü—Ä–æ–ø—É—Å–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö | –ü–æ–∂–∏–ª—ã–µ –ª—é–¥–∏ —á–∞—â–µ –Ω–µ —É–∫–∞–∑—ã–≤–∞—é—Ç –¥–æ—Ö–æ–¥ |
| **MNAR** (Missing Not at Random) | –ü—Ä–æ–ø—É—Å–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å–∞–º–∏—Ö –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π | –õ—é–¥–∏ —Å –Ω–∏–∑–∫–∏–º –¥–æ—Ö–æ–¥–æ–º —Å–∫—Ä—ã–≤–∞—é—Ç —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é |

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, –≤—ã –∏–¥–µ—Ç–µ –ø–æ —É–ª–∏—Ü–µ, –∫ –≤–∞–º –ø–æ–¥—Ö–æ–¥–∏—Ç –Ω–µ–∑–Ω–∞–∫–æ–º–µ—Ü –∏ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –≤–∞–º –ª–µ—Ç –∏ —Å–∫–æ–ª—å–∫–æ –≤—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ. –ù–µ –∫–∞–∂–¥—ã–π –≥–æ—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —ç—Ç–∏ –≤–æ–ø—Ä–æ—Å—ã. –ü—Ä–æ–ø—É—Å–∫–∏ –≤ —Ç–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –±—É–¥—É—Ç –Ω–µ–∏–∑–±–µ–∂–Ω—ã. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ —Å–æ–±—Ä–∞—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ç–∞–∫–æ–≥–æ –æ–ø—Ä–æ—Å–∞, –∏ –æ–ø—Ä–µ–¥–µ–ª–∏–º –∑–∞–≤–∏—Å–∏—Ç –ª–∏ —Å–∫—Ä—ã—Ç–∏–µ –¥–æ—Ö–æ–¥–∞ –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞ –æ–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö.

```python
import pandas as pd
import numpy as np

df = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': [25, 30, np.nan, 45, 35, 50, np.nan, 28, 40, 55, 60],
    '–¥–æ—Ö–æ–¥': [45000, 60000, 55000, np.nan, 50000, np.nan, 40000, 48000, np.nan, np.nan, np.nan]
})

print(df)

print(f"–ü—Ä–æ–ø—É—Å–∫–∏ –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ: {df['–≤–æ–∑—Ä–∞—Å—Ç'].isnull().sum()} ({df['–≤–æ–∑—Ä–∞—Å—Ç'].isnull().mean()*100:.1f}\%)")
print(f"–ü—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–æ—Ö–æ–¥–µ: {df['–¥–æ—Ö–æ–¥'].isnull().sum()} ({df['–¥–æ—Ö–æ–¥'].isnull().mean()*100:.1f}\%)")

df['–≤–æ–∑—Ä–∞—Å—Ç_–≥—Ä—É–ø–ø–∞'] = pd.cut(df['–≤–æ–∑—Ä–∞—Å—Ç'], bins=[20, 30, 50, 100], labels=['–ú–æ–ª–æ–¥—ã–µ', '–°—Ä–µ–¥–Ω–∏–µ', '–°—Ç–∞—Ä—à–∏–µ'])
print("\n–î–æ–ª—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–æ—Ö–æ–¥–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –≥—Ä—É–ø–ø–∞–º:")
print(df.groupby('–≤–æ–∑—Ä–∞—Å—Ç_–≥—Ä—É–ø–ø–∞', observed=False)['–¥–æ—Ö–æ–¥'].apply(lambda x: x.isnull().mean() * 100))
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

@quizQuestion(`–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–∏–ø –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ—Ö–æ–¥–∞ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ:`)

<!-- data-randomize -->
[( )] MCAR
[(X)] MAR
[( )] MNAR

–ï—Å–ª–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –º–Ω–æ–≥–æ, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Ç–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å–∏–ª—å–Ω–æ —É—Ö—É–¥—à–∏—Ç –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏, –∞ —Ç–æ –∏ –æ–∫–∞–∂–µ—Ç—Å—è –≤–æ–≤—Å–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–π. –ú–Ω–æ–≥–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ç—Ä–µ–±—É—é—Ç –º–∞—Å—Å–∏–≤ –≤–∞–ª–∏–¥–Ω—ã—Ö —á–∏—Å–µ–ª –∏ –Ω–µ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å NaN –∏–ª–∏ –ø—É—Å—Ç—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.

–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:

- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∞–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏
- –£–¥–∞–ª–µ–Ω–∏–µ ‚Äî –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π
- –ò–º–ø—É—Ç–∞—Ü–∏—è ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π

> **üëò –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Ü–≤–µ—Ç–Ω–æ–π —É–∑–æ—Ä—á–∞—Ç—ã–π —Å–≤–∏—Ç–µ—Ä.** –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -- –∫–∞–∫ –¥—ã—Ä–∫–∏ –≤ —Å–≤–∏—Ç–µ—Ä–µ. –ï—Å–ª–∏ –¥—ã—Ä–∫–∏ –Ω–µ–±–æ–ª—å—à–∏–µ, –∏—Ö –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (–Ω–æ—Å–∏—Ç—å –¥—ã—Ä—è–≤—ã–π —Å–≤–∏—Ç–µ—Ä). –ú–æ–∂–Ω–æ –∑–∞—à—Ç–æ–ø–∞—Ç—å –≤—Å–µ –¥—ã—Ä–∫–∏ –Ω–∏—Ç–∫–∞–º–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ (–∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º). –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–∑–æ—Ä –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω–æ, –Ω–∞–π—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –¥—ã—Ä–∫–∏ –Ω–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Ü–≤–µ—Ç–∞ (–ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ). –†–∞—Å–ø—É—Å—Ç–∏–≤ –≤–µ—Å—å —Ä—è–¥, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏–ª–∞—Å—å –¥—ã—Ä–∫–∞, –º—ã –ø–æ—Ç–µ—Ä—è–µ–º –∏ –Ω–µ–¥—ã—Ä—è–≤—É—é —á–∞—Å—Ç—å —Å–≤–∏—Ç–µ—Ä–∞ (–ø–æ–º–∏–º–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–∑–Ω–∞–∫–µ, –º—ã —É–¥–∞–ª—è–µ–º –Ω–µ–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö).

#### –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤
----

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –ï—Å–ª–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥ -- –æ—Ç–¥–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—É –¥–∞—Ç–∞—Å–µ—Ç –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –≤–∏–¥–µ –∏ –Ω–∞–¥–µ—è—Ç—å—Å—è, —á—Ç–æ –æ–Ω —Å –Ω–∏–º –∫–∞–∫-–Ω–∏–±—É–¥—å —Ä–∞–∑–±–µ—Ä—ë—Ç—Å—è. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —É–º–µ—é—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –≤–æ –≤–Ω–∏–º–∞–Ω–∏–µ –∏ –¥–∞–∂–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–∏–º–µ—Ä—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö –ø—Ä–æ–ø—É—Å–∫–∏:**

- **XGBoost** ‚Äî –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∑–∞ —Å—á—ë—Ç —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏
- **LightGBM** ‚Äî –º–æ–∂–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `use_missing=False`
- **CatBoost** ‚Äî –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **–ê–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ä–µ–≤—å–µ–≤** ‚Äî –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –≤–µ—Ç–∫–∏ –¥–ª—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö –ø—Ä–æ–ø—É—Å–∫–∏:**

- –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (scikit-learn)
- –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
- SVM
- –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏
- k-NN

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import pandas as pd
import numpy as np

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
data = pd.DataFrame({
    'feature1': [1.0, 2.0, np.nan, 4.0, 5.0],
    'feature2': [10, np.nan, 30, 40, 50],
    'target': [0, 1, 1, 0, 1]
})

print("–î–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:")
print(data)

# –ü—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫ —Ä–∞–∑–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏
# TODO: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä—É–≥–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ
try:
    from sklearn.linear_model import LinearRegression
    from sklearn.model_selection import train_test_split
    
    X = data[['feature1', 'feature2']]
    y = data['target']
    
    # –ü–æ–ø—ã—Ç–∫–∞ –æ–±—É—á–∏—Ç—å –ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é
    lr = LinearRegression()
    lr.fit(X, y)  # –≠—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É!
    
except Exception as e:
    print(f"\n–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏: {type(e).__name__}")
    print("–ú–æ–¥–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏! \n–î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–∫–∏–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –Ω—É–∂–Ω–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö.")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

| ‚úÖ –ü–ª—é—Å—ã | ‚ùå –ú–∏–Ω—É—Å—ã |
|---------|----------|
| –ù–µ –Ω—É–∂–Ω–æ –¥—É–º–∞—Ç—å –æ–± –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö –∏–º–ø—É—Ç–∞—Ü–∏–∏ | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ |
| –ë—ã—Å—Ç—Ä–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ |
| –ê–ª–≥–æ—Ä–∏—Ç–º —Å–∞–º —Ä–µ—à–∞–µ—Ç, –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ | –†–∏—Å–∫ –ø–æ–ª—É—á–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ |
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ | –¢—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ |

@NB(`–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞, —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –æ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.`)

#### –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
----

**–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏** ‚Äî –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö, –Ω–æ –≥—Ä—É–±—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –û–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –Ω–∞ —ç—Ç–∞–ø–µ –ø–µ—Ä–≤–∏—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –∏–ª–∏ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö –∫ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ —Ä–µ–¥–∫–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫–∞–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ö–æ–≥–¥–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ–º–Ω–æ–≥–æ (–æ–±—ã—á–Ω–æ –¥–æ $5‚Äì10\%$ –æ—Ç –æ–±—â–µ–π –≤—ã–±–æ—Ä–∫–∏).
- –ö–æ–≥–¥–∞ –≤—ã–±–æ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∞—è, –∏ –ø–æ—Ç–µ—Ä—è —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞.
- –ö–æ–≥–¥–∞ –ø—Ä–æ–ø—É—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –∏ –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–∏–Ω–∞—á–µ –≤–æ–∑–º–æ–∂–Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞).
- –ö–æ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –º–æ–∂–µ—Ç –≤–Ω–µ—Å—Ç–∏ –∏—Å–∫–∞–∂–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã–µ.

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:**

- –í—ã–∫–∏–¥—ã–≤–∞—é—Ç—Å—è –≤—Å–µ —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ.
- –≠—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏.
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–º–µ—â–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã —Å –∫–∞–∫–∏–º–∏-—Ç–æ –≤–∞–∂–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏.

**–†–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω–∏—è:**

1. **–£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ —Å –ª—é–±—ã–º–∏ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏.** –ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Ç–æ–ª—å–∫–æ —Å "–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º–∏" –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º–∏. –ù–æ —á–∞—Å—Ç–æ —ç—Ç–æ —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ.

```python
data_clean = data.dropna()
```

2. **–£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö.** –ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–ª—å–∑—è –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª—å –±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (`target`). –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–∂–Ω–æ –ø–æ—Ç–æ–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É.

```python
data_clean = data.dropna(subset=['—Ü–µ–ª–µ–≤–∞—è_–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è'])
```

3. **–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫, –≥–¥–µ –ø—Ä–æ–ø—É—â–µ–Ω—ã –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è.** –¢–∞–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ –Ω–µ –Ω–µ—Å—É—Ç –Ω–∏–∫–∞–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ ~~–≤—Å–µ–≥–¥–∞~~ –¥–æ–ª–∂–Ω—ã —É–¥–∞–ª—è—Ç—å—Å—è.

```python
data_clean = data.dropna(how='all')
```

–î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏ —Å—Ä–∞–≤–Ω–∏–º —ç—Ç–∏ —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤:

``` python
import pandas as pd
import numpy as np

# –°–æ–∑–¥–∞—ë–º DataFrame —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤
data = pd.DataFrame({
    '–∏–º—è': ['–ê–Ω–Ω–∞', '–ë–æ—Ä–∏—Å', np.nan, '–î–µ–Ω–∏—Å', np.nan],
    '–≤–æ–∑—Ä–∞—Å—Ç': [25, np.nan, 35, 40, np.nan],
    '–≥–æ—Ä–æ–¥': ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', np.nan, '–ú–æ—Å–∫–≤–∞', np.nan],
    '—Ü–µ–ª–µ–≤–∞—è_–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è': [1, 0, 1, np.nan, np.nan]
})

print(f"–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n{data}")

data_clean = data.dropna()
print(f"\n1. –£–¥–∞–ª–µ–Ω—ã —Å—Ç—Ä–æ–∫–∏ —Å –ª—é–±—ã–º–∏ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:\n{data_clean}\n")

data_clean = data.dropna(subset=['—Ü–µ–ª–µ–≤–∞—è_–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è'])
print(f"2. –£–¥–∞–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –≤ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:\n{data_clean}\n")

data_clean = data.dropna(how='all')
print(f"3. –£–¥–∞–ª–µ–Ω—ã —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –≤–æ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö:\n{data_clean}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)


| ‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**                          | ‚ùå **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**                                       |
| ------------------------------------------- | ------------------------------------------------------ |
| –ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π –º–µ—Ç–æ–¥                     | –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö                                          |
| –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∏–ª–∏ –º–æ–¥–µ–ª–∏ | –ú–æ–∂–µ—Ç –∏—Å–∫–∞–∑–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö                    |
| –£–±–∏—Ä–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ "–º—É—Å–æ—Ä–Ω—ã–µ" –∑–∞–ø–∏—Å–∏      | –†–∏—Å–∫ –≤—ã–±—Ä–æ—Å–∏—Ç—å –≤–∞–∂–Ω—ã–µ, –Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ –Ω–µ–ø–æ–ª–Ω—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è |
| –ü–æ–¥—Ö–æ–¥–∏—Ç –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö      | –ù–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É, –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –º–Ω–æ–≥–æ           |

**–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è**:

- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ ‚Äî ~~–Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ~~, –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è ~~–≤ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ~~ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É —Å—Ç–∞—Ä—à–∏—Ö –ª—é–¥–µ–π —á–∞—â–µ –ø—Ä–æ–ø—É—â–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –∏—Ö —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –∏—Å–∫–∞–∂–µ–Ω–∏—é –≤—ã–±–æ—Ä–∫–∏).
- –£–¥–∞–ª–µ–Ω–∏–µ ‚Äî —ç—Ç–æ ~~–Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è~~. –õ—É—á—à–µ –¥–µ–ª–∞—Ç—å –µ—ë ~~–∫–æ–ø–∏–µ–π~~ –¥–∞–Ω–Ω—ã—Ö: `df_clean = df.dropna()` –∏ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–ª—å—à–µ —Å `df_clean`.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.info()` –∏–ª–∏ `.isnull().sum()` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: 
```python 
print(df.isnull().sum())
```

#### –ò–º–ø—É—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
----

**–ò–º–ø—É—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —Å–ª–æ–≤–∞ "impute", —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç "–ø—Ä–∏–ø–∏—Å—ã–≤–∞—Ç—å".

##### –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π –∏ –º–µ—Ä–∞–º–∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏
----

–î–æ–ø—É—Å—Ç–∏–º, –ø—Ä–∏ –æ–ø—Ä–æ—Å–µ, –ø–æ–º–∏–º–æ –∑–∞—Ä–ø–ª–∞—Ç—ã –∏ –≤–æ–∑—Ä–∞—Å—Ç–∞, —Ç–∞–∫–∂–µ —Å–ø—Ä–∞—à–∏–≤–∞–ª–æ—Å—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –≥–æ—Ç–æ–≤—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã, –∫–æ–º—É-—Ç–æ –Ω–µ —Ö–æ—á–µ—Ç—Å—è –æ–∑–≤—É—á–∏–≤–∞—Ç—å —Å–≤–æ–π –≤–æ–∑—Ä–∞—Å—Ç, –∫–æ–º—É-—Ç–æ –∑–∞—Ä–ø–ª–∞—Ç—É –∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–º—å–µ. –° —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –∞–Ω–∫–µ—Ç–µ —á–∞—Å—Ç–æ—Ç–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç –∏–∑-–∑–∞ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –Ω–µ–æ—Ç–≤–µ—Ç–æ–≤ –ø–æ —Ä–∞–∑–Ω—ã–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º. 
–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ —Å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∏–º –ø—Ä–æ–ø—É—Å–∫–æ–º –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ—Ç–µ—Ä–µ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—é –æ–±—ä–µ–º–∞ –≤—ã–±–æ—Ä–∫–∏, —á—Ç–æ —Å—Ç–∞–≤–∏—Ç –ø–æ–¥ —Å–æ–º–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

–í–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ–π —Å—Ç—Ä–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏, –º–æ–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π. –í —Å–ª—É—á–∞–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–µ—Ç–µ–π, –Ω–∞–∏–±–æ–ª–µ–µ –ª–æ–≥–∏—á–Ω—ã–º –∫–∞–∂–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ –Ω—É–ª—è–º–∏, –ø—Ä–∏ –¥–æ–ø—É—â–µ–Ω–∏–∏, —á—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ç–≤–µ—Ç–∞ –º–æ–∂–µ—Ç –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –¥–µ—Ç–µ–π.

–û–¥–Ω–∞–∫–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –∑–∞—Ä–ø–ª–∞—Ç–µ/–≤–æ–∑—Ä–∞—Å—Ç–µ/–ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ –Ω—É–ª—è–º–∏ —è–≤–Ω–æ –Ω–µ —Å—Ç–æ–∏—Ç. –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–æ–≥–∏—á–Ω–æ–π –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã? –î–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å, –¥–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ–Ω—è—Ç–∏–µ –º–µ—Ä —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏.

**–ú–µ—Ä—ã —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏** ‚Äî —ç—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç "—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ" –∏–ª–∏ "—Ç–∏–ø–∏—á–Ω–æ–µ" –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö.

–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ä—ã —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏:

- **–°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ (mean)** ‚Äî —Å—É–º–º–∞ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –¥–µ–ª–µ–Ω–Ω–∞—è –Ω–∞ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.

  - –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ –≤—ã–±—Ä–æ—Å–∞–º
  - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –ü—Ä–∏–º–µ—Ä—ã: —Ä–æ—Å—Ç –ª—é–¥–µ–π, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞

- **–ú–µ–¥–∏–∞–Ω–∞ (median)** ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–µ–ª–∏—Ç —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Ä—è–¥ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ø–æ–ª–∞–º

  - –£—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º
  - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–∫–æ—à–µ–Ω–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π (—É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º)
  - –ü—Ä–∏–º–µ—Ä—ã: –¥–æ—Ö–æ–¥—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è, —Ü–µ–Ω—ã –Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å, –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

- **–ú–æ–¥–∞ (mode)** ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–µ–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö.

  - –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥ –∏–ª–∏ –Ω–µ –±—ã—Ç—å –≤–æ–≤—Å–µ
  - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã—Ö —á–∏—Å–ª–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –ü—Ä–∏–º–µ—Ä—ã: –ø–æ–ª, –ø—Ä–æ—Ñ–µ—Å—Å–∏—è, –º–∞—Ä–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è, —Ä–∞–∑–º–µ—Ä –æ–±—É–≤–∏

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∑–∞—Ä–ø–ª–∞—Ç—ã –∏ –≤–æ–∑—Ä–∞—Å—Ç–∞. –ò —Ä–µ—à–∏—Ç–µ –∫–∞–∫–æ–π –º–µ—Ä–æ–π –±—É–¥–µ—Ç–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–º –∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

@img_sem03(salary_age_hist.png, –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –∑–∞—Ä–ø–ª–∞—Ç—ã –∏ –≤–æ–∑—Ä–∞—Å—Ç–∞, 60)

@quizQuestion(–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–∏–∑–Ω–∞–∫ –∏ –º–µ—Ä—É —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –Ω–µ–º:)

<!-- data-randomize -->
- [(–°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ) (–ú–µ–¥–∏–∞–Ω–∞) (–ú–æ–¥–∞)]
- [ (x) ( ) ( )]  –í–æ–∑—Ä–∞—Å—Ç
- [ ( ) (x) ( )]  –ó–∞—Ä–ø–ª–∞—Ç–∞
- [ ( ) ( ) (x)]  –ü—Ä–æ—Ñ–µ—Å—Å–∏—è

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
salary = np.append(np.random.normal(60000, 8000, 95), [250000, 300000, 500000, np.nan, np.nan])  # —Å –≤—ã–±—Ä–æ—Å–∞–º–∏ –∏ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
age = np.append(np.random.normal(30, 4, 98), [np.nan, np.nan])  # –±–ª–∏–∑–∫–æ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É
children = np.random.choice([0, 1, 2, np.nan], size=100, p=[0.3, 0.4, 0.2, 0.1])
professions = np.random.choice(['–∏–Ω–∂–µ–Ω–µ—Ä', '—É—á–∏—Ç–µ–ª—å', '–º–µ–Ω–µ–¥–∂–µ—Ä', None], size=100, p=[0.4, 0.3, 0.2, 0.1])  # –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

data = pd.DataFrame({
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': salary,
    '–≤–æ–∑—Ä–∞—Å—Ç': age,
    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–µ—Ç–µ–π': children,
    '–ø—Ä–æ—Ñ–µ—Å—Å–∏—è': professions
})

print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n", data.head())

print("–ß–∏—Å–ª–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤:\n", data.isna().sum())

# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
data[['–∑–∞—Ä–ø–ª–∞—Ç–∞', '–≤–æ–∑—Ä–∞—Å—Ç']].hist(figsize=(10, 4), bins=20, grid=False)
plt.tight_layout()
plt.show()

# –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤
data['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–µ—Ç–µ–π'] = data['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–µ—Ç–µ–π'].fillna(0)  # –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ–π
data['–∑–∞—Ä–ø–ª–∞—Ç–∞'] = data['–∑–∞—Ä–ø–ª–∞—Ç–∞'].fillna(data['–∑–∞—Ä–ø–ª–∞—Ç–∞'].median())  # –º–µ–¥–∏–∞–Ω–æ–π (–∏–∑-–∑–∞ –≤—ã–±—Ä–æ—Å–æ–≤)
data['–≤–æ–∑—Ä–∞—Å—Ç'] = data['–≤–æ–∑—Ä–∞—Å—Ç'].fillna(data['–≤–æ–∑—Ä–∞—Å—Ç'].mean())  # —Å—Ä–µ–¥–Ω–∏–º (–ø–æ—á—Ç–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ)
data['–ø—Ä–æ—Ñ–µ—Å—Å–∏—è'] = data['–ø—Ä–æ—Ñ–µ—Å—Å–∏—è'].fillna(data['–ø—Ä–æ—Ñ–µ—Å—Å–∏—è'].mode()[0])  # –º–æ–¥–æ–π

print("–î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:\n", data.head())
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

---
**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ–ø—Ä–æ—Å–∞ –æ –ø–∏—Ç–∞–Ω–∏–∏ –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

–í —Ç–∞–±–ª–∏—Ü–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:

- `calories` ‚Äî –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç—Ä–µ–±–ª—è–µ–º—ã—Ö –∫–∞–ª–æ—Ä–∏–π –≤ –¥–µ–Ω—å
- `weight` ‚Äî –º–∞—Å—Å–∞ —Ç–µ–ª–∞ –≤ –∫–∏–ª–æ–≥—Ä–∞–º–º–∞—Ö
- `sport` ‚Äî —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —á–µ–ª–æ–≤–µ–∫ –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Å–ø–æ—Ä—Ç–æ–º –≤ –Ω–µ–¥–µ–ª—é
- `diet` ‚Äî —Ç–∏–ø –¥–∏–µ—Ç—ã, –∫–æ—Ç–æ—Ä–æ–π —á–µ–ª–æ–≤–µ–∫ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∞—è, –∫–µ—Ç–æ, –æ–±—ã—á–Ω–∞—è)

–í–∞—à–∞ –∑–∞–¥–∞—á–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏—Ö –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º —Å–ø–æ—Å–æ–±–æ–º:

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

np.random.seed(0)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
calories = np.append(np.random.normal(2200, 300, 95), [4000, 5000, np.nan, np.nan, np.nan])
weight = np.append(np.random.normal(70, 5, 98), [np.nan, np.nan])
sport = np.random.choice([0, 1, 2, 3, np.nan], size=100, p=[0.2, 0.3, 0.3, 0.1, 0.1])
diet = np.random.choice(['–æ–±—ã—á–Ω–∞—è', '–≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∞—è', '–∫–µ—Ç–æ', None], size=100, p=[0.5, 0.2, 0.2, 0.1])

data = pd.DataFrame({
    '–∫–∞–ª–æ—Ä–∏–∏': calories,
    '–≤–µ—Å': weight,
    '—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏': sport,
    '–¥–∏–µ—Ç–∞': diet
})
print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n", data.head())
print("\n–ß–∏—Å–ª–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤:\n", data.isna().sum())

# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
data[['–∫–∞–ª–æ—Ä–∏–∏', '–≤–µ—Å']].hist(figsize=(10, 4), bins=20, grid=False)
plt.tight_layout()
plt.show()

# TODO: –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–ø—É—Å–∫–∏
# –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å:

print("\n–ü–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤:\n", data.head())
print("\n–ß–∏—Å–ª–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤:\n", data.isna().sum())
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

<details>
<summary>**~~üéØ –í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ~~**</summary>

```python
data['—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏'] = data['—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏'].fillna(0)  # –ª–æ–≥–∏—á–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞
data['–∫–∞–ª–æ—Ä–∏–∏'] = data['–∫–∞–ª–æ—Ä–∏–∏'].fillna(data['–∫–∞–ª–æ—Ä–∏–∏'].median())  # –≤—ã–±—Ä–æ—Å—ã ‚Üí –º–µ–¥–∏–∞–Ω–∞
data['–≤–µ—Å'] = data['–≤–µ—Å'].fillna(data['–≤–µ—Å'].mean())  # –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ‚Üí —Å—Ä–µ–¥–Ω–µ–µ
data['–¥–∏–µ—Ç–∞'] = data['–¥–∏–µ—Ç–∞'].fillna(data['–¥–∏–µ—Ç–∞'].dropna().mode()[0])  # –º–æ–¥–∞
```

</details>

<br>

##### –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
---

–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
–î–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é, –Ω–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏.

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é: —É –≤–∞—Å –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö –∫–æ–º–ø–∞–Ω–∏–∏, –≥–¥–µ —É–∫–∞–∑–∞–Ω—ã –≤–æ–∑—Ä–∞—Å—Ç, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –∏ –∑–∞—Ä–ø–ª–∞—Ç–∞. –ï—Å–ª–∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∞ —É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–µ–ª–æ–≤–µ–∫, –Ω–æ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã, –º–æ–∂–Ω–æ –ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∏—Ö –∑–∞—Ä–ø–ª–∞—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –¥—Ä—É–≥–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏?

–ò–º–µ–Ω–Ω–æ —ç—Ç–æ –∏ –¥–µ–ª–∞–µ—Ç –∏–º–ø—É—Ç–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è:

1. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏**: –µ—Å–ª–∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –∏ –æ–ø—ã—Ç–æ–º, –º–æ–¥–µ–ª—å –≤—ã—É—á–∏—Ç —ç—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. **–£—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ, –º–æ–∂–µ—Ç –≤—ã—è–≤–ª—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
3. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è**: –∫–∞–∂–¥–æ–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ

–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
---

**üî¥ –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.**
–ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç —Å–ª–∏—à–∫–æ–º —Ç–æ—á–Ω–æ –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—å—Å—è –ø–æ–¥ –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –≤—ã–±—Ä–æ—Å (–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π –≤ $10$ —Ä–∞–∑ –≤—ã—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö), –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –Ω–µ—Ä–µ–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã –¥–ª—è –ª—é–¥–µ–π —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏.

**üî¥ –ü—Ä–æ–±–ª–µ–º–∞ 2: –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö (Data Leakage).**
–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–∞–º–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∑–∞–≤—ã—à–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—É –ø–æ —Ä–∞–∑–º–µ—Ä—É –∫–≤–∞—Ä—Ç–∏—Ä—ã ‚Äî –Ω–æ —Ä–∞–∑–º–µ—Ä –∫–≤–∞—Ä—Ç–∏—Ä—ã —á–∞—Å—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞—Ä–ø–ª–∞—Ç—ã!

**üî¥ –ü—Ä–æ–±–ª–µ–º–∞ 3: –ò—Å–∫–∞–∂–µ–Ω–∏–µ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏.**
–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—ã—á–Ω–æ –º–µ–Ω–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã, —á–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ. –ú–æ–¥–µ–ª—å —Å–∫–ª–æ–Ω–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –±–ª–∏–∂–µ –∫ —Å—Ä–µ–¥–Ω–µ–º—É, —á—Ç–æ –º–æ–∂–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –¥–∏—Å–ø–µ—Ä—Å–∏—é –¥–∞–Ω–Ω—ã—Ö.

**üî¥ –ü—Ä–æ–±–ª–µ–º–∞ 4: –ö–∞—Å–∫–∞–¥–Ω–∞—è –æ—à–∏–±–∫–∞.**
–ï—Å–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –µ—Å—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –æ—à–∏–±–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–≥—É—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è. –ù–µ—Ç–æ—á–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –Ω–µ—Ç–æ—á–Ω–æ–º—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—é –∑–∞—Ä–ø–ª–∞—Ç—ã.

**üî¥ –ü—Ä–æ–±–ª–µ–º–∞ 5: –ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ MAR.**
–ú–µ—Ç–æ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ–ø—É—Å–∫–∏ —Å–ª—É—á–∞–π–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ª—é–¥–∏ —Å –≤—ã—Å–æ–∫–∏–º–∏ –∑–∞—Ä–ø–ª–∞—Ç–∞–º–∏ —á–∞—â–µ —Å–∫—Ä—ã–≤–∞—é—Ç –¥–æ—Ö–æ–¥—ã (MNAR), –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±—É–¥—É—Ç —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–Ω–∏–∂–µ–Ω—ã.

**–£—Å–ª–æ–≤–∏—è –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏ –º–µ—Ç–æ–¥–∞:**

|‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏**|‚ùå **–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–∏**|
|---|---|
|–í—ã—Å–æ–∫–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ ($|r| > 0.5$)|–°–ª–∞–±—ã—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑—è—Ö –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏|
|–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è|–ú–∞–ª–æ–º –æ–±—ä–µ–º–µ –≤—ã–±–æ—Ä–∫–∏|
|–¢–∏–ø–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ MAR (Missing at Random)|–¢–∏–ø–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ MNAR (Missing Not at Random)|
|–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –≤–∞–∂–Ω–æ—Å—Ç–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è|–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏|
|–ù–∞–ª–∏—á–∏–∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π –æ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏|–í—ã—Å–æ–∫–æ–π –¥–æ–ª–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞—Ö ($>30\%$)|

–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π ML-–∏–º–ø—É—Ç–∞—Ü–∏–µ–π
---

1. **–ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π**: –∏–∑—É—á–∏—Ç–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–æ–ª–∂–Ω—ã –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.
2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤**: –ø—Ä–æ–ø—É—Å–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∏–ø–∞ MAR.
3. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
4. **–û–±—É—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –≤—ã–±–æ—Ä–∞ –ª—É—á—à–µ–π**: –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –∏–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
5. **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ**: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
6. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**: –∞–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
7. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏**: –∏–Ω–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç—ã–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ª—É—á—à–µ.  
8. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è**: —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è –∏ –∏—Ö –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏—è. 

–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–±–æ—Ä–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
---

~~**–î–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:**~~

- **–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è**: –ø—Ä–∏ –ª–∏–Ω–µ–π–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö, –±—ã—Å—Ç—Ä–∞—è –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–∞—è
- **Random Forest**: –ø—Ä–∏ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö, —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –≤—ã–±—Ä–æ—Å–∞–º
- **XGBoost**: –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —Ç—é–Ω–∏–Ω–≥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **KNN**: —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö

~~**–î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:**~~

- **–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è**: –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- **Random Forest Classifier**: —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä
- **Naive Bayes**: –ø—Ä–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **SVM**: –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏

---
**üìã –ü—Ä–∏–º–µ—Ä.** –†–µ–≥—Ä–µ—Å—Å–∏—è –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏, –æ–ø—ã—Ç–µ —Ä–∞–±–æ—Ç—ã –∏ –≤–æ–∑—Ä–∞—Å—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–≤–∞–≤–ª–µ–Ω –∫–æ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å $20\%$ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –∑–∞—Ä–ø–ª–∞—Ç–µ.

–î–æ–ø–∏—à–∏—Ç–µ –∫–æ–¥ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Ä–∞–∑–Ω—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –í—ã–±–µ—Ä–∏—Ç–µ –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–ø—É—Å–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏. –ï—Å–ª–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å–ª–∞–±—ã–µ (<0.3), ML-–∏–º–ø—É—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–æ—Ö–æ.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è ‚Äî –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ —Å—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω–∞?

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import pandas as pd
import numpy as np
#from sklearn.ensemble import RandomForestRegressor
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.impute import SimpleImputer

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
np.random.seed(42)
n = 1000

education_years = np.random.normal(14, 3, n)
experience = np.maximum(0, education_years - 18 + np.random.normal(5, 3, n))
age = education_years + experience + 18 + np.random.normal(0, 2, n)
salary = (2000 * education_years + 
          1500 * experience + 
          500 * age + 
          np.random.normal(0, 8000, n))

df = pd.DataFrame({
    'education_years': education_years,
    'experience_years': experience,
    'age': age,
    'salary': salary
})

# –í–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
missing_idx = np.random.choice(n, size=int(0.2 * n), replace=False)
df.loc[missing_idx, 'salary'] = np.nan

print(f"–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n{df.head()}")
print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ salary: {df['salary'].isna().sum()} ({df['salary'].isna().mean()*100:.1f}\%)")
print("\n–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞:")
print(df.corr().round(3))

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
train_data = df.dropna()
predict_data = df[df['salary'].isna()]

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
X = train_data[['education_years', 'experience_years', 'age']]
y = train_data['salary']
X_predict = predict_data[['education_years', 'experience_years', 'age']]

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# –°–æ–∑–¥–∞–µ–º –∏ –æ–±—É—á–∞–µ–º –º–æ–¥–µ–ª–∏
models = {
    "Linear Regression": LinearRegression(),
    #TODO: –¥–æ–±–∞–≤—å—Ç–µ –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –≤—ã–±–æ—Ä–∞ –ª—É—á—à–µ–π –∏–∑ –Ω–∏—Ö
    #–ù–∞–ø—Ä–∏–º–µ—Ä: 
    #"Random Forest": RandomForestRegressor(random_state=42)
}

for name, model in models.items():
    print(f"\n--- {name} ---")
    
    # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
    model.fit(X_train, y_train)
    
    # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
    y_pred = model.predict(X_test)
    
    # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
    print(f"MAE: {mean_absolute_error(y_test, y_pred):.2f}")
    print(f"MSE: {mean_squared_error(y_test, y_pred):.2f}")
    print(f"R¬≤: {r2_score(y_test, y_pred):.2f}")
    
    # –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è
    scores = cross_val_score(model, X, y, cv=5, scoring='neg_mean_absolute_error')
    print(f"Cross-val MAE: {-scores.mean():.2f} (¬±{scores.std():.2f})")

# –í—ã–±–∏—Ä–∞–µ–º –ª—É—á—à—É—é –º–æ–¥–µ–ª—å 
# TODO: –≤—ã–±–µ—Ä–∏—Ç–µ —Ç—É –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑–∞–ª–∞ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
best_model = LinearRegression()
best_model.fit(X, y)  # –û–±—É—á–∞–µ–º –Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
predicted_salaries = best_model.predict(X_predict)

# –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤
df.loc[df['salary'].isna(), 'salary'] = predicted_salaries

print(f"\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:")
print(df['salary'].describe().round(0))
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

**–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**

1. **–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∏–ª—É —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤—ã—Å–æ–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ($>0.5$) –º–µ–∂–¥—É –∑–∞—Ä–ø–ª–∞—Ç–æ–π –∏ –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–∏–π –∑–Ω–∞–∫ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è ML-–∏–º–ø—É—Ç–∞—Ü–∏–∏.

2. **–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏:**

   - **MAE (Mean Absolute Error)** ‚Äî —Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ —Ä—É–±–ª—è—Ö. –ï—Å–ª–∏ $MAE = 5000$, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –º–æ–¥–µ–ª—å –æ—à–∏–±–∞–µ—Ç—Å—è –Ω–∞ $5000$ —Ä—É–±–ª–µ–π
   - **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏** ‚Äî –¥–æ–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏. $R¬≤ = 0.8$ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –æ–±—ä—è—Å–Ω—è–µ—Ç $80\%$ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞—Ä–ø–ª–∞—Ç
   - **Cross-val MAE** ‚Äî –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞, –ø–æ–ª—É—á–µ–Ω–Ω–∞—è —á–µ—Ä–µ–∑ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é

3. **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–≤–æ–¥—ã:**

   - –ï—Å–ª–∏ $R¬≤ > 0.7$ –∏ Cross-val MAE –Ω–µ–≤–µ–ª–∏–∫–∞, –∏–º–ø—É—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π
   - –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –º–µ—Ç–æ–¥—ã (–º–µ–¥–∏–∞–Ω–∞)
   - –ë–æ–ª—å—à–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –æ–±—É—á–∞—é—â–µ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π –æ—à–∏–±–∫–æ–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ

---
**üìã –ü—Ä–∏–º–µ—Ä.** –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é –∑–∞–¥–∞—á—É ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –±—É–¥–µ–º –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–æ–ª–∂–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞, –¥–æ—Ö–æ–¥–∞ –∏ —É—Ä–æ–≤–Ω—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏:**

1. **–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** ‚Äî –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —á–∏—Å–ª–∞–º–∏, –ø–æ—ç—Ç–æ–º—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —á–∏—Å–ª–∞
2. **–ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî –Ω—É–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –æ–¥–∏–Ω –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
3. **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è** ‚Äî –º–æ–¥–µ–ª—å –≤—ã–¥–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Å, –Ω–æ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏
4. **–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å (accuracy) –≤–º–µ—Å—Ç–æ MAE

–í –∫–æ–¥–µ –Ω–∏–∂–µ –º—ã —Å–æ–∑–¥–∞–µ–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç—å—é. –ö–æ–¥–∏—Ä—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é "–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ" –≤ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. –û–±—É—á–∞–µ–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤. –ò –∑–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤** ‚Äî –µ—Å–ª–∏ –æ–¥–∏–Ω –∫–ª–∞—Å—Å —Å–∏–ª—å–Ω–æ –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, $80\%$ —Ä–∞–±–æ—á–∏—Ö), –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–º–µ—â–µ–Ω–∞.
2. **–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ** ‚Äî –µ—Å–ª–∏ –æ–Ω–∞ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∞ ($>0.95$), —ç—Ç–æ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.
3. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏:** –°—Ä–∞–≤–Ω–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω–æ–µ –∏ –∏—Ç–æ–≥–æ–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤. –ï—Å–ª–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ —Å–∏–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–¥—Ö–æ–¥. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –±—ã–ª–æ $50\%$ —Ä–∞–±–æ—á–∏—Ö, –∞ —Å—Ç–∞–ª–æ $30\%$, —ç—Ç–æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ.
4. **–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö:**

   - –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å $>0.8$ ‚Äî —Ö–æ—Ä–æ—à–∏–π –∑–Ω–∞–∫
   - –°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å $<0.5$ ‚Äî –º–æ–¥–µ–ª—å "–≥–∞–¥–∞–µ—Ç", —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ–Ω–∞–¥–µ–∂–Ω—ã
   - –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —Å–ª–∞–±—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import pandas as pd
import numpy as np


from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import accuracy_score, classification_report

# –°–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º
np.random.seed(42)
n = 800

# –ë–∞–∑–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
age = np.random.normal(35, 10, n)
income = np.random.normal(60000, 20000, n)
education_level = np.random.choice(['—Å—Ä–µ–¥–Ω–µ–µ', '–≤—ã—Å—à–µ–µ', '–º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞'], n, p=[0.4, 0.4, 0.2])

# –î–æ–ª–∂–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞, –¥–æ—Ö–æ–¥–∞ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
work_type_probs = []
for i in range(n):
    if education_level[i] == '–º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞' and income[i] > 70000:
        probs = [0.1, 0.2, 0.7]  # –±–æ–ª—å—à–µ —à–∞–Ω—Å–æ–≤ –Ω–∞ "—É–ø—Ä–∞–≤–ª–µ–Ω–µ—Ü"
    elif education_level[i] == '–≤—ã—Å—à–µ–µ':
        probs = [0.2, 0.6, 0.2]  # –±–æ–ª—å—à–µ —à–∞–Ω—Å–æ–≤ –Ω–∞ "—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç"
    else:
        probs = [0.7, 0.2, 0.1]  # –±–æ–ª—å—à–µ —à–∞–Ω—Å–æ–≤ –Ω–∞ "—Ä–∞–±–æ—á–∏–π"
    
    work_type_probs.append(probs)

work_types = []
for probs in work_type_probs:
    work_types.append(np.random.choice(['—Ä–∞–±–æ—á–∏–π', '—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', '—É–ø—Ä–∞–≤–ª–µ–Ω–µ—Ü'], p=probs))

df_cat = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': age,
    '–¥–æ—Ö–æ–¥': income,
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': education_level,
    '–¥–æ–ª–∂–Ω–æ—Å—Ç—å': work_types
})

# –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
missing_indices = np.random.choice(n, size=int(0.15 * n), replace=False)
df_cat.loc[missing_indices, '–¥–æ–ª–∂–Ω–æ—Å—Ç—å'] = np.nan

print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π:")
print(df_cat['–¥–æ–ª–∂–Ω–æ—Å—Ç—å'].value_counts())
print(f"\n–ü—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏: {df_cat['–¥–æ–ª–∂–Ω–æ—Å—Ç—å'].isna().sum()}")

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
# –ö–æ–¥–∏—Ä—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
le_education = LabelEncoder()
df_cat['–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_encoded'] = le_education.fit_transform(df_cat['–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'])

# –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (–±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤)
train_data = df_cat.dropna()
X_train = train_data[['–≤–æ–∑—Ä–∞—Å—Ç', '–¥–æ—Ö–æ–¥', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_encoded']]
y_train = train_data['–¥–æ–ª–∂–Ω–æ—Å—Ç—å']

# –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
predict_data = df_cat[df_cat['–¥–æ–ª–∂–Ω–æ—Å—Ç—å'].isna()]
X_predict = predict_data[['–≤–æ–∑—Ä–∞—Å—Ç', '–¥–æ—Ö–æ–¥', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_encoded']]

print(f"\n–î–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è: {len(train_data)}")
print(f"–î–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: {len(predict_data)}")

# –û–±—É—á–∞–µ–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
clf = RandomForestClassifier(n_estimators=100, random_state=42)
clf.fit(X_train, y_train)

# –û—Ü–µ–Ω–∏–≤–∞–µ–º –∫–∞—á–µ—Å—Ç–≤–æ
train_pred = clf.predict(X_train)
accuracy = accuracy_score(y_train, train_pred)
print(f"\n–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ: {accuracy:.3f}")

# –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
predicted_work_types = clf.predict(X_predict)
predicted_probs = clf.predict_proba(X_predict)

print(f"\n–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏:")
unique, counts = np.unique(predicted_work_types, return_counts=True)
for work_type, count in zip(unique, counts):
    print(f"  {work_type}: {count}")

# –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏
df_cat.loc[df_cat['–¥–æ–ª–∂–Ω–æ—Å—Ç—å'].isna(), '–¥–æ–ª–∂–Ω–æ—Å—Ç—å'] = predicted_work_types

print(f"\n–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:")
print(df_cat['–¥–æ–ª–∂–Ω–æ—Å—Ç—å'].value_counts())

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö
print(f"\n–°—Ä–µ–¥–Ω—è—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö: {predicted_probs.max(axis=1).mean():.3f}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

##### –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏
---

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏ –ø–æ–º–æ–≥–∞–µ—Ç —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã –∏ –Ω–µ –∏—Å–∫–∞–∂–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ—Ü–µ–Ω–∫–∏.

–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ (Hold-out –≤–∞–ª–∏–¥–∞—Ü–∏—è)
---

**–ü—Ä–∏–Ω—Ü–∏–ø**: –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º —á–∞—Å—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –ø—Ä–∏–º–µ–Ω—è–µ–º –∏–º–ø—É—Ç–∞—Ü–∏—é, –∑–∞—Ç–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –∏—Å—Ç–∏–Ω–Ω—ã–º–∏.

1. –í—ã–±–æ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ ‚Äî –æ–±—ã—á–Ω–æ $10$-$20\%$ –æ—Ç –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–ø—É—Å–∫–æ–≤ ‚Äî —Å–ª—É—á–∞–π–Ω–æ –∏–ª–∏ –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ö–µ–º–µ
3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ ‚Äî —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã
4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∏—Å—Ç–∏–Ω–æ–π ‚Äî –≤—ã—á–∏—Å–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏ –æ—à–∏–±–æ–∫
5. –í—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ –º–µ—Ç–æ–¥–∞ ‚Äî —Ç–æ—Ç, —á—Ç–æ –ø–æ–∫–∞–∑–∞–ª –Ω–∞–∏–º–µ–Ω—å—à—É—é –æ—à–∏–±–∫—É

**–í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –ú–µ—Ö–∞–Ω–∏–∑–º —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω–æ–º—É ‚Äî –µ—Å–ª–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–µ —Å–ª—É—á–∞–π–Ω—ã, –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏—Ö —Å–ª—É—á–∞–π–Ω–æ
- –†–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –∫—Ä–∏—Ç–∏—á–µ–Ω ‚Äî —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∞—è –¥–∞—Å—Ç –Ω–µ–Ω–∞–¥–µ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∞—è –æ—Å—Ç–∞–≤–∏—Ç –º–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–º–ø—É—Ç–∞—Ü–∏–∏
- –°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω–∞ ‚Äî –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–ª–∞—Å—Å–æ–≤

---
**üìã –ü—Ä–∏–º–µ—Ä.** Hold-out –∏–º–ø—É—Ç–∞—Ü–∏—è.

–î–∞–≤–∞–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (—á—Ç–æ–±—ã ML-–º–µ—Ç–æ–¥—ã –∏–º–µ–ª–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ). –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–∫–∞–∂–µ—Ç —Å–∏–ª—É —Å–≤—è–∑–µ–π. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã—Å–æ–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –∑–∞—Ä–ø–ª–∞—Ç–æ–π –∏ –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏. 

–°–æ–∑–¥–∞–¥–∏–º $20\%$ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–ø—É—Å–∫–æ–≤: —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ–º $200$ –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ $1000$ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º $3$ –º–µ—Ç–æ–¥–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏: —Å—Ä–µ–¥–Ω–µ–µ, –º–µ–¥–∏–∞–Ω–∞, –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è.
–°—Ä–∞–≤–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ MAE ‚Äî —á–µ–º –º–µ–Ω—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–µ–º —Ç–æ—á–Ω–µ–µ –º–µ—Ç–æ–¥.

~~–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:~~

- MAE $= 5000$ –æ–∑–Ω–∞—á–∞–µ—Ç —Å—Ä–µ–¥–Ω—é—é –æ—à–∏–±–∫—É –≤ $5000$ —Ä—É–±–ª–µ–π
- –ï—Å–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ (MAE –≤ $2$+ —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ) ‚Äî –µ—Å—Ç—å —Å–º—ã—Å–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ML
- –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ –Ω–µ–±–æ–ª—å—à–∞—è ($<20\%$) ‚Äî –ª—É—á—à–µ –æ—Å—Ç–∞—Ç—å—Å—è —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
- –ï—Å–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Ö—É–∂–µ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, —Å–≤—è–∑–∏ —Å–ª–∞–±—ã–µ –∏–ª–∏ –µ—Å—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ

``` python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import pandas as pd
import numpy as np
from sklearn.metrics import mean_absolute_error
from sklearn.linear_model import LinearRegression

# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
np.random.seed(42)
n = 1000

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
age = np.random.normal(35, 10, n)
education = np.random.choice([12, 16, 18], n, p=[0.3, 0.5, 0.2])
salary = 20000 + 1000 * age + 2000 * education + np.random.normal(0, 5000, n)

df_test = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': age,
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': education,
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': salary
})

print("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤:")
print(df_test.corr().round(3))

# 1. –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ 20\% –∑–Ω–∞—á–µ–Ω–∏–π –∑–∞—Ä–ø–ª–∞—Ç—ã
np.random.seed(123)
test_indices = np.random.choice(len(df_test), size=int(0.2 * len(df_test)), replace=False)
true_values = df_test.loc[test_indices, '–∑–∞—Ä–ø–ª–∞—Ç–∞'].copy()
df_test.loc[test_indices, '–∑–∞—Ä–ø–ª–∞—Ç–∞'] = np.nan

print("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:")
print(df_test.corr().round(3))

# 2. –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–º–ø—É—Ç–∞—Ü–∏–∏
results = {}

# –ú–µ—Ç–æ–¥ 1: –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
df_mean = df_test.copy()
mean_val = df_mean['–∑–∞—Ä–ø–ª–∞—Ç–∞'].mean()
df_mean['–∑–∞—Ä–ø–ª–∞—Ç–∞'] = df_mean['–∑–∞—Ä–ø–ª–∞—Ç–∞'].fillna(mean_val)
mae_mean = mean_absolute_error(true_values, df_mean.loc[test_indices, '–∑–∞—Ä–ø–ª–∞—Ç–∞'])
results['–°—Ä–µ–¥–Ω–µ–µ'] = mae_mean

# –ú–µ—Ç–æ–¥ 2: –ú–µ–¥–∏–∞–Ω–∞
df_median = df_test.copy()
median_val = df_median['–∑–∞—Ä–ø–ª–∞—Ç–∞'].median()
df_median['–∑–∞—Ä–ø–ª–∞—Ç–∞'] = df_median['–∑–∞—Ä–ø–ª–∞—Ç–∞'].fillna(median_val)
mae_median = mean_absolute_error(true_values, df_median.loc[test_indices, '–∑–∞—Ä–ø–ª–∞—Ç–∞'])
results['–ú–µ–¥–∏–∞–Ω–∞'] = mae_median

# –ú–µ—Ç–æ–¥ 3: –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
df_lr = df_test.copy()
train_data = df_lr.dropna()
X_train = train_data[['–≤–æ–∑—Ä–∞—Å—Ç', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ']]
y_train = train_data['–∑–∞—Ä–ø–ª–∞—Ç–∞']

lr = LinearRegression()
lr.fit(X_train, y_train)

X_test = df_lr.loc[test_indices, ['–≤–æ–∑—Ä–∞—Å—Ç', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ']]
predicted_salary = lr.predict(X_test)
df_lr.loc[test_indices, '–∑–∞—Ä–ø–ª–∞—Ç–∞'] = predicted_salary
mae_lr = mean_absolute_error(true_values, predicted_salary)
results['–†–µ–≥—Ä–µ—Å—Å–∏—è'] = mae_lr

# –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
print("\n–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∏–º–ø—É—Ç–∞—Ü–∏–∏ (MAE):")
for method, mae in results.items():
    print(f"{method}: {mae:.0f}")

print(f"\n–õ—É—á—à–∏–π –º–µ—Ç–æ–¥: {min(results, key=results.get)}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

---

–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
---

**–ü—Ä–∏–Ω—Ü–∏–ø**: –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–æ –∏ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏.

–•–æ—Ä–æ—à–∞—è –∏–º–ø—É—Ç–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å "—Ö–∞—Ä–∞–∫—Ç–µ—Ä" –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ –¥–æ –∏–º–ø—É—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã–µ –∏–º–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —Å—Ä–µ–¥–Ω–µ–µ, –¥–∏—Å–ø–µ—Ä—Å–∏—é, —Ç–æ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ —ç—Ç–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è.

**–ß—Ç–æ –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º:**

1. –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: —Å—Ä–µ–¥–Ω–µ–µ, –º–µ–¥–∏–∞–Ω–∞, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
2. –§–æ—Ä–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è: —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç—å, –Ω–∞–ª–∏—á–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤
3. –ù–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é
4. –ö–≤–∞–Ω—Ç–∏–ª–∏: –∫–∞–∫ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö

**‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**

- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ $<5\%$
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞–Ω—ã $<10\%$
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è $<15\%$
- –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∏
- –¢–µ—Å—Ç—ã –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã

  - ~~–¢–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞:~~

    - $p > 0.05$ ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–ª–∏–∑–∫–æ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É
    - $p ‚â§ 0.05$ ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ
    
  - Q-Q –≥—Ä–∞—Ñ–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –±–ª–∏–∑–∫–∏ –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é

**‚ö†Ô∏è –¢—Ä–µ–≤–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã:**

1. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —É–º–µ–Ω—å—à–∏–ª–æ—Å—å $>20\%$ ‚Äî –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–ª–∏ "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–º–∏"
2. –ü–æ—è–≤–∏–ª—Å—è –æ—Å—Ç—Ä—ã–π –ø–∏–∫ –Ω–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ ‚Äî –≤—Å–µ –∏–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ
3. –ò–∑–º–µ–Ω–∏–ª—Å—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä "—Ö–≤–æ—Å—Ç–æ–≤" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ‚Äî –∏—Å—á–µ–∑–ª–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
4. –¢–µ—Å—Ç –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –±—ã–ª–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ, —Å—Ç–∞–ª–æ –Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç. 

**–ö–æ–≥–¥–∞ –º–µ—Ç–æ–¥ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–µ–Ω:**

- –ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ, –≥–¥–µ —Ñ–æ—Ä–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤)
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ü—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤
- –ü—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. –í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
2. –ï—Å–ª–∏ –∏–º–ø—É—Ç–∞—Ü–∏—è —Å–∏–ª—å–Ω–æ –∏—Å–∫–∞–∂–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ‚Äî –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥
3. –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—é ‚Äî –µ–≥–æ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–æ—á—Ç–∏ –Ω–µ–∏–∑–±–µ–∂–Ω–æ
4. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî –∫–æ–ª–ª–µ–≥–∏ –¥–æ–ª–∂–Ω—ã –∑–Ω–∞—Ç—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ —Å—Ä–µ–¥–Ω–∏–º.~~</summary>

–°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å —Å–ª—É—á–∞–π–Ω—ã–º–∏ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ ($20\%$). –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ –∏–∑–º–µ–Ω—è—Ç—Å—è –∫–ª—é—á–µ–≤—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å—Ä–µ–¥–Ω–∏–º.

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
np.random.seed(42)
original_data = np.random.normal(50, 15, 1000)
df_dist = pd.DataFrame({'–∑–Ω–∞—á–µ–Ω–∏–µ': original_data})

# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ (20\%)
missing_indices = np.random.choice(len(df_dist), size=200, replace=False)
true_missing = df_dist.loc[missing_indices, '–∑–Ω–∞—á–µ–Ω–∏–µ'].copy()
df_dist.loc[missing_indices, '–∑–Ω–∞—á–µ–Ω–∏–µ'] = np.nan

print("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:")
print(f"–°—Ä–µ–¥–Ω–µ–µ: {original_data.mean():.2f}")
print(f"–ú–µ–¥–∏–∞–Ω–∞: {np.median(original_data):.2f}")
print(f"–°—Ç–¥. –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {original_data.std():.2f}")

# –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–º–ø—É—Ç–∞—Ü–∏—é —Å—Ä–µ–¥–Ω–∏–º
df_imputed = df_dist.copy()
df_imputed['–∑–Ω–∞—á–µ–Ω–∏–µ'] = df_imputed['–∑–Ω–∞—á–µ–Ω–∏–µ'].fillna(df_imputed['–∑–Ω–∞—á–µ–Ω–∏–µ'].mean()) 

print("\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏:")
print(f"–°—Ä–µ–¥–Ω–µ–µ: {df_imputed['–∑–Ω–∞—á–µ–Ω–∏–µ'].mean():.2f}")
print(f"–ú–µ–¥–∏–∞–Ω–∞: {df_imputed['–∑–Ω–∞—á–µ–Ω–∏–µ'].median():.2f}")
print(f"–°—Ç–¥. –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {df_imputed['–∑–Ω–∞—á–µ–Ω–∏–µ'].std():.2f}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
_, p_value_orig = stats.shapiro(original_data[:1000] if len(original_data) > 1000 else original_data)
_, p_value_imp = stats.shapiro(df_imputed['–∑–Ω–∞—á–µ–Ω–∏–µ'].values[:1000])

print(f"\n–¢–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å:")
print(f"–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: p-value = {p_value_orig:.4f}")
print(f"–ü–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏: p-value = {p_value_imp:.4f}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
fig, axes = plt.subplots(1, 2, figsize=(12, 4))

axes[0].hist(original_data, bins=30, alpha=0.7, label='–ò—Å—Ö–æ–¥–Ω—ã–µ', density=True)
axes[0].hist(df_imputed['–∑–Ω–∞—á–µ–Ω–∏–µ'], bins=30, alpha=0.7, label='–ü–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏', density=True)
axes[0].set_title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π')
axes[0].legend()

# Q-Q plot
stats.probplot(original_data, dist="norm", plot=axes[1])
axes[1].set_title('Q-Q –≥—Ä–∞—Ñ–∏–∫ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö')

plt.tight_layout()
plt.show()
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

@img_sem03(imputation_ex.png, –ò–º–ø—É—Ç–∞—Ü–∏—è —Å—Ä–µ–¥–Ω–∏–º, 70)

</details>

<br>

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
-----

**–ü—Ä–∏–Ω—Ü–∏–ø**: –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏.

–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ ‚Äî —ç—Ç–æ "—Å–∫–µ–ª–µ—Ç" –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –≤ –º–∏—Ä–µ: –±–æ–ª–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ –ª—é–¥–∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –±–æ–ª—å—à–µ, —Å—Ç–∞—Ä—à–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏–º–µ—é—Ç –±–æ–ª—å—à–µ –æ–ø—ã—Ç–∞ –∏ —Ç.–¥. –ï—Å–ª–∏ –∏–º–ø—É—Ç–∞—Ü–∏—è –Ω–∞—Ä—É—à–∞–µ—Ç —ç—Ç–∏ —Å–≤—è–∑–∏, –≤—ã —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç–µ "—Ñ–∞–ª—å—à–∏–≤—ã–µ" –¥–∞–Ω–Ω—ã–µ.

**–ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫:**

1. –û—Å–ª–∞–±–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π ‚Äî –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –±—ã–ª–∞ $0.7$, —Å—Ç–∞–ª–∞ $0.4$
2. –£—Å–∏–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π ‚Äî –º–æ–¥–µ–ª—å "–ø–µ—Ä–µ–æ–±—É—á–∏–ª–∞—Å—å" –∏ —Å–æ–∑–¥–∞–ª–∞ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω—É—é —Å–≤—è–∑—å
3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞–∫–∞ ‚Äî –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å—Ç–∞–ª–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π
4. –ü–æ—è–≤–ª–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö —Å–≤—è–∑–µ–π ‚Äî –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Ç–∞–º, –≥–¥–µ –∏—Ö –Ω–µ –±—ã–ª–æ

**–ö–æ–≥–¥–∞ —ç—Ç–æ—Ç –∞–Ω–∞–ª–∏–∑ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–µ–Ω:**

- –ü—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- –ü–µ—Ä–µ–¥ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ–º —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –í —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö

---

**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏.

–°–æ–∑–¥–∞–¥–∏–º –¥–∞–Ω–Ω—ã–µ —Å —Ç—Ä–µ–º—è –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è–º–∏ –∏ $25\%$ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –ø—Ä–∏–∑–Ω–∞–∫–µ_2.

–ü—Ä–∏–º–µ–Ω–∏–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–º–ø—É—Ç–∞—Ü–∏–∏ –∏ —Å—Ä–∞–≤–Ω–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π:

- $<0.05$ ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- $0.05-0.15$‚Äî –ø—Ä–∏–µ–º–ª–µ–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
- $0.15-0.3$ ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏
- $>0.3$ ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∏–ª—å–Ω–æ –Ω–∞—Ä—É—à–µ–Ω–∞

~~–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:~~

- –°—Ä–µ–¥–Ω–µ–µ/–º–µ–¥–∏–∞–Ω–∞ –æ–±—ã—á–Ω–æ –æ—Å–ª–∞–±–ª—è—é—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è $0.7$ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å $0.5$)
- –†–µ–≥—Ä–µ—Å—Å–∏—è –º–æ–∂–µ—Ç —É—Å–∏–ª–∏—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ($0.7$ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å $0.8$) ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

‚ö†Ô∏è –¢—Ä–µ–≤–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã:

1. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –∏–∑–º–µ–Ω–∏–ª–∞ –∑–Ω–∞–∫
2. –°–ª–∞–±–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å—Ç–∞–ª–∞ —Å–∏–ª—å–Ω–æ–π ‚Äî $0.2$ —Å—Ç–∞–ª–∞ $0.7$ (–≤–µ—Ä–æ—è—Ç–Ω–æ, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç)
3. –°–∏–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –∏—Å—á–µ–∑–ª–∞ ‚Äî $0.8$ —Å—Ç–∞–ª–∞ $0.1$ (–ø–æ—Ç–µ—Ä—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
4. –ü–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ —Å–∏–ª—å–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ ‚Äî –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ —Å–≤—è–∑–∞–Ω—ã

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import seaborn
except ImportError:
    install_package("seaborn")

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è–º–∏ –∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏–µ–π
np.random.seed(42)
n = 500

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –∞—Å–∏–º–º–µ—Ç—Ä–∏–µ–π
x1 = np.random.normal(0, 1, n)
# –°–æ–∑–¥–∞–µ–º –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è x2
x2 = np.where(
    np.random.rand(n) > 0.7,
    np.random.normal(5, 1, n),  # –í—ã–±—Ä–æ—Å—ã –≤ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
    np.random.normal(0, 0.7, n)  # –û—Å–Ω–æ–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
)
# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Å x1
x2 = 0.7 * x1 + x2

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞—Å–∏–º–º–µ—Ç—Ä–∏—é –≤ x3
x3 = np.where(
    np.random.rand(n) > 0.8,
    np.random.normal(3, 0.8, n),
    np.random.normal(0, 0.8, n)
)
x3 = 0.3 * x1 + 0.4 * x2 + x3

df_corr = pd.DataFrame({
    '–ø—Ä–∏–∑–Ω–∞–∫_1': x1,
    '–ø—Ä–∏–∑–Ω–∞–∫_2': x2,
    '–ø—Ä–∏–∑–Ω–∞–∫_3': x3
})

# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –ø—Ä–∏–∑–Ω–∞–∫–µ_2
missing_idx = np.random.choice(n, size=int(0.25 * n), replace=False)
df_corr.loc[missing_idx, '–ø—Ä–∏–∑–Ω–∞–∫_2'] = np.nan

print("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:")
original_corr = df_corr.corr()
print(original_corr.round(3))

# –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–º–ø—É—Ç–∞—Ü–∏–∏
methods = {
    '–°—Ä–µ–¥–Ω–µ–µ': lambda df: df.fillna(df.mean()),
    '–ú–µ–¥–∏–∞–Ω–∞': lambda df: df.fillna(df.median()),
    '–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è': None
}

# –ò–º–ø—É—Ç–∞—Ü–∏—è —Å—Ä–µ–¥–Ω–∏–º –∏ –º–µ–¥–∏–∞–Ω–æ–π
results = {}
for method_name, method_func in methods.items():
    if method_func is not None:
        df_temp = df_corr.copy()
        df_temp = method_func(df_temp)
        new_corr = df_temp.corr()
        
        print(f"\n–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ ({method_name}):")
        print(new_corr.round(3))
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
        results[method_name] = df_temp.copy()
        
        # –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–Ω–æ—Å—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
        corr_diff = abs(original_corr - new_corr)
        print(f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏: {corr_diff.max().max():.3f}")

# –ò–º–ø—É—Ç–∞—Ü–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π
df_lr = df_corr.copy()
train_data = df_lr.dropna()
missing_data = df_lr[df_lr['–ø—Ä–∏–∑–Ω–∞–∫_2'].isna()]

if len(train_data) > 0 and len(missing_data) > 0:
    X_train = train_data[['–ø—Ä–∏–∑–Ω–∞–∫_1', '–ø—Ä–∏–∑–Ω–∞–∫_3']]
    y_train = train_data['–ø—Ä–∏–∑–Ω–∞–∫_2']
    
    lr = LinearRegression()
    lr.fit(X_train, y_train)
    
    X_missing = missing_data[['–ø—Ä–∏–∑–Ω–∞–∫_1', '–ø—Ä–∏–∑–Ω–∞–∫_3']]
    predicted_values = lr.predict(X_missing)
    
    df_lr.loc[df_lr['–ø—Ä–∏–∑–Ω–∞–∫_2'].isna(), '–ø—Ä–∏–∑–Ω–∞–∫_2'] = predicted_values
    results['–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è'] = df_lr.copy()
    
    lr_corr = df_lr.corr()
    print(f"\n–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ (–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è):")
    print(lr_corr.round(3))
    
    corr_diff_lr = abs(original_corr - lr_corr)
    print(f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏: {corr_diff_lr.max().max():.3f}")


# TODO: –¥–æ–±–∞–≤—å—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ seaborn
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

<details>
<summary>~~–í–æ–∑–º–æ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤~~</summary>

``` python
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
plt.figure(figsize=(15, 10))

# 1. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
plt.subplot(2, 2, 1)
sns.histplot(df_corr['–ø—Ä–∏–∑–Ω–∞–∫_2'], kde=True, color='blue', label='–ò—Å—Ö–æ–¥–Ω—ã–µ')
plt.axvline(df_corr['–ø—Ä–∏–∑–Ω–∞–∫_2'].mean(), color='red', linestyle='--', label='–°—Ä–µ–¥–Ω–µ–µ')
plt.axvline(df_corr['–ø—Ä–∏–∑–Ω–∞–∫_2'].median(), color='green', linestyle='--', label='–ú–µ–¥–∏–∞–Ω–∞')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞_2 (–∏—Å—Ö–æ–¥–Ω–æ–µ)')
plt.legend()

# 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏
plt.subplot(2, 2, 2)
for method, df in results.items():
    sns.kdeplot(df['–ø—Ä–∏–∑–Ω–∞–∫_2'], label=method)
plt.title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏')
plt.legend()

# 3. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∏—Å—Ö–æ–¥–Ω—ã–µ
plt.subplot(2, 2, 3)
sns.heatmap(original_corr, annot=True, cmap='coolwarm', center=0, vmin=-1, vmax=1)
plt.title('–ò—Å—Ö–æ–¥–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏')

# 4. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ—Å–ª–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
plt.subplot(2, 2, 4)
sns.heatmap(results['–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è'].corr(), annot=True, cmap='coolwarm', center=0, vmin=-1, vmax=1)
plt.title('–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ (—Ä–µ–≥—Ä–µ—Å—Å–∏—è)')

plt.tight_layout()
plt.show()
```

@img_sem03(imputation_ex2.png, –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏, 90)

</details>

<br>

---

<br>

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö:**

|–ï—Å–ª–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –æ—Å–ª–∞–±–µ–ª–∏|–ï—Å–ª–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —É—Å–∏–ª–∏–ª–∏—Å—å|–ï—Å–ª–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏|
|---|---|---|
|–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –º–µ—Ç–æ–¥–æ–≤ (—Å—Ä–µ–¥–Ω–µ–µ, –º–µ–¥–∏–∞–Ω–∞).|–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ. –°—Ä–∞–≤–Ω–∏—Ç–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø—Ä–æ—Å—Ç—ã—Ö –º–µ—Ç–æ–¥–æ–≤. –í–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é.|–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –∏–º–ø—É—Ç–∞—Ü–∏–∏. –í–æ–∑–º–æ–∂–Ω–æ, –µ—Å—Ç—å —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö.|

–ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–æ–ø—É—Å–∫–æ–≤
---

**–ü—Ä–∏–Ω—Ü–∏–ø**: –ò—Å—Å–ª–µ–¥—É–µ–º, –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –ª–∏ –∏–º–ø—É—Ç–∞—Ü–∏—è –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –¥–∞–Ω–Ω—ã—Ö.

–≠—Ç–æ —Å–∞–º—ã–π "—Ö–∏—Ç—Ä—ã–π" –∏ –≤–∞–∂–Ω—ã–π —Ç–µ—Å—Ç. –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–∞—Å—Ç–æ –Ω–µ—Å–ª—É—á–∞–π–Ω—ã. –ë–æ–≥–∞—Ç—ã–µ –ª—é–¥–∏ –Ω–µ –≥–æ–≤–æ—Ä—è—Ç –æ —Å–≤–æ–∏—Ö –¥–æ—Ö–æ–¥–∞—Ö, –±–æ–ª—å–Ω—ã–µ –ª—é–¥–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç –≤–æ–ø—Ä–æ—Å—ã –æ –∑–¥–æ—Ä–æ–≤—å–µ, –º–æ–ª–æ–¥—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —á–∞—â–µ –º–µ–Ω—è—é—Ç —Ä–∞–±–æ—Ç—É –∏ –Ω–µ –∑–∞–ø–æ–ª–Ω—è—é—Ç –∞–Ω–∫–µ—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é. –ï—Å–ª–∏ –º—ã –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º —ç—Ç–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –∏–º–ø—É—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç –¥–∞—Ç—å –æ—á–µ–Ω—å –æ–±–º–∞–Ω—á–∏–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

| –¢–∏–ø–∏—á–Ω–∞—è "–ª–æ–≤—É—à–∫–∞" –≤ –¥–∞–Ω–Ω—ã—Ö | –ü—Ä–∏–º–µ—Ä | –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏|
| :--- | :--- | :--- |
| **–°–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–æ—Ö–æ–¥–∞–º** | –õ—é–¥–∏ —Å –≤—ã—Å–æ–∫–∏–º–∏ –¥–æ—Ö–æ–¥–∞–º–∏ —á–∞—â–µ —Å–∫—Ä—ã–≤–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é | –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–Ω–∏–∂–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –±–æ–≥–∞—Ç—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º |
| **–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | –ú–æ–ª–æ–¥—ã–µ/–ø–æ–∂–∏–ª—ã–µ –æ—Ç–≤–µ—á–∞—é—Ç –ø–æ-—Ä–∞–∑–Ω–æ–º—É | –ò—Å–∫–∞–∂–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –µ—Å–ª–∏ –ª—é–¥–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ —á–∞—â–µ –Ω–µ –æ—Ç–≤–µ—á–∞—é—Ç. |
| **–ì–µ–Ω–¥–µ—Ä–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è** | –ú—É–∂—á–∏–Ω—ã —Ä–µ–∂–µ —Å–æ–æ–±—â–∞—é—Ç –æ –¥–µ–ø—Ä–µ—Å—Å–∏–∏ | –ò—Å–∫–∞–∂–µ–Ω–∏–µ –≥–µ–Ω–¥–µ—Ä–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π –≤ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö –∑–¥–æ—Ä–æ–≤—å—è. –ó–∞–Ω–∏–∂–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–µ–ø—Ä–µ—Å—Å–∏–∏ —É –º—É–∂—á–∏–Ω –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤. |
| **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å** | –õ–µ—Ç–æ–º —Ä–µ–∂–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –û–†–í–ò (–∏–∑-–∑–∞ –º–µ–Ω—å—à–µ–π –æ–±—Ä–∞—â–∞–µ–º–æ—Å—Ç–∏) | –õ–æ–∂–Ω—ã–µ —Å–µ–∑–æ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã –∑–∞–±–æ–ª–µ–≤–∞–µ–º–æ—Å—Ç–∏. –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ "—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ" –ø–∏–∫–æ–≤ –∏–ª–∏ –ø–æ—è–≤–ª–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö –∫–æ–ª–µ–±–∞–Ω–∏–π |
| **–°–æ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä** | –ë–µ–∑—Ä–∞–±–æ—Ç–Ω—ã–µ —Ä–µ–∂–µ –∑–∞–ø–æ–ª–Ω—è—é—Ç –∞–Ω–∫–µ—Ç—ã –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ | –ó–∞–Ω–∏–∂–µ–Ω–∏–µ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π —É –±–µ–∑—Ä–∞–±–æ—Ç–Ω—ã—Ö |

**–ú–µ—Ç–æ–¥—ã –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º:**

1. –ê–Ω–∞–ª–∏–∑ –ø–æ –ø–æ–¥–≥—Ä—É–ø–ø–∞–º ‚Äî —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–æ –∏ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø–∞—Ö
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ ‚Äî –µ—Å—Ç—å –ª–∏ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–¥–æ–ª—å –≤–∞–∂–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
3. –≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–¥—Ä–∞–≤–æ–º—É —Å–º—ã—Å–ª—É

---
**üìã –ü—Ä–∏–º–µ—Ä.** –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

–í –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è —Ö–æ–ª–µ—Å—Ç–∏—Ä–∏–Ω–∞. –û–∫–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ –ø–æ–∂–∏–ª—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã, –∏ –ø–∞—Ü–∏–µ–Ω—Ç—ã –º—É–∂—á–∏–Ω—ã —á–∞—â–µ –æ—Å—Ç–∞–≤–ª—è–ª–∏ –≤–æ–ø—Ä–æ—Å –≤ –∞–Ω–∫–µ—Ç–µ –±–µ–∑ –æ—Ç–≤–µ—Ç–∞.
–í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ, –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤—Å–µ—Ö –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º, –º—ã —Ä–∏—Å–∫—É–µ–º –Ω–µ–¥–æ–æ—Ü–µ–Ω–∏—Ç—å —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç—ã–µ —Ä–∏—Å–∫–∏ —É –º—É–∂—á–∏–Ω –∏ –ª—é–¥–µ–π –ø–æ–∂–∏–ª–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞. 

–ß—Ç–æ–±—ã —ç—Ç–æ–≥–æ –∏–∑–±–µ–∂–∞—Ç—å, –ø—Ä–∏–º–µ–Ω–∏–º —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–º–ø—É—Ç–∞—Ü–∏—é, –∑–∞–ø–æ–ª–Ω–∏–≤ –ø—Ä–æ–ø—É—Å–∫–∏ —Å—Ä–µ–¥–Ω–∏–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –∏ –≥–µ–Ω–¥–µ—Ä–Ω—ã–º –≥—Ä—É–ø–ø–∞–º.

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø—Ä–∏–º–µ—Ä —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–∞—Ü–∏–µ–Ω—Ç–∞—Ö, –≤–∫–ª—é—á–∞—é—â–∏—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–æ–∑—Ä–∞—Å—Ç–µ, –ø–æ–ª–µ, –∫—É—Ä–µ–Ω–∏–∏ –∏ —É—Ä–æ–≤–Ω–µ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞.

``` python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.metrics import mean_absolute_error

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Ç—Ä–µ–º—è —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
np.random.seed(42)
n = 2000

# –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
age = np.random.uniform(18, 85, n)
sex = np.random.choice(['–ú—É–∂—á–∏–Ω—ã', '–ñ–µ–Ω—â–∏–Ω—ã'], n, p=[0.45, 0.55])
smoking = np.random.choice(['–ö—É—Ä—è—Ç', '–ù–µ –∫—É—Ä—è—Ç'], n, p=[0.3, 0.7])

# –•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Å–µ—Ö —Ç—Ä–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
cholesterol = (160 + 0.8*age +
               np.where(sex=='–ú—É–∂—á–∏–Ω—ã', 15, 0) +
               np.where(smoking=='–ö—É—Ä—è—Ç', 20, 0) +
               np.random.normal(0, 20, n))

# –ü–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–ø—É—Å–∫–æ–≤: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ –ø–æ–ª–∞
prob_missing = 1 / (1 + np.exp(-(age - 60)/10 + (sex=='–ú—É–∂—á–∏–Ω—ã')*0.5))
missing_mask = np.random.binomial(1, prob_missing, n).astype(bool)

df = pd.DataFrame({
    '–í–æ–∑—Ä–∞—Å—Ç': age, '–ü–æ–ª': sex, '–ö—É—Ä–µ–Ω–∏–µ': smoking,
    '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω': cholesterol
})
true_values = df.loc[missing_mask, '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].copy()
df.loc[missing_mask, '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'] = np.nan

# 1. –ò–º–ø—É—Ç–∞—Ü–∏—è –æ–±—â–∏–º —Å—Ä–µ–¥–Ω–∏–º
df_bad = df.copy()
df_bad['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'] = df_bad['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].fillna(df['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].mean())

# 2. –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–º–ø—É—Ç–∞—Ü–∏—è –ø–æ –ø–æ–ª—É –∏ –≤–æ–∑—Ä–∞—Å—Ç—É
df_good = df.copy()
df_good['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'] = df_good.groupby(
    ['–ü–æ–ª', pd.cut(df['–í–æ–∑—Ä–∞—Å—Ç'], [18,40,60,85])], 
    observed=True 
    #–ë–µ–∑ observed=True pandas –ø–æ–ø—ã—Ç–∞–ª—Å—è –±—ã —Å–æ–∑–¥–∞—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ 
    #–∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–æ–ª–∞ –∏ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ (–¥–∞–∂–µ –µ—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, 
    #–Ω–∞–ø—Ä–∏–º–µ—Ä, –º—É–∂—á–∏–Ω 18-40 –ª–µ—Ç)
)['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].transform(lambda x: x.fillna(x.mean()))

# 3. –ü–æ–ª–Ω–∞—è —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –≤—Å–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º
# TODO: –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –≤—Å–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º: –ø–æ–ª, –∫—É—Ä–µ–Ω–∏–µ, –≤–æ–∑—Ä–∞—Å—Ç
# df_best = df.copy()
# df_best['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'] = ...

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
# TODO: –¥–æ–±–∞–≤—å—Ç–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–æ–ª–Ω–æ–π —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
results = pd.DataFrame({
    '–ú–µ—Ç–æ–¥': ['–ò—Å—Ç–∏–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è', '–ü—Ä–æ—Å—Ç–∞—è –∏–º–ø—É—Ç–∞—Ü–∏—è', '–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø–æ–ª+–≤–æ–∑—Ä–∞—Å—Ç)', 
              #'–ü–æ–ª–Ω–∞—è —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è'
              ],
    '–°—Ä–µ–¥–Ω–µ–µ': [
        true_values.mean(),
        df_bad.loc[missing_mask, '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].mean(),
        df_good.loc[missing_mask, '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].mean(),
        #df_best.loc[missing_mask, '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].mean()
    ],
    '–°—Ç–∞–Ω–¥. –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ': [
        true_values.std(),
        df_bad.loc[missing_mask, '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].std(),
        df_good.loc[missing_mask, '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].std(),
        #df_best.loc[missing_mask, '–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].std()
    ]
}).round(1)

print(results)
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

<details>
<summary>~~–ü–æ–ª–Ω–∞—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º~~</summary>

``` python
df_best = df.copy()
df_best['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'] = df_best.groupby(
    ['–ü–æ–ª', '–ö—É—Ä–µ–Ω–∏–µ', pd.cut(df['–í–æ–∑—Ä–∞—Å—Ç'], [18,40,60,85])],
    observed=True
)['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].transform(lambda x: x.fillna(x.mean()))
```
</details>

<br>

<details>
<summary>~~ –í–æ–∑–º–æ–∂–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞ –¥–æ –∏ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏~~</summary>

```python
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞ –¥–æ –∏ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏
plt.figure(figsize=(15, 10))

# –ò—Å—Ö–æ–¥–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
plt.subplot(2, 2, 1)
sns.histplot(data=df.assign(–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω=cholesterol), x='–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω', hue='–ü–æ–ª', element='step', kde=True)
plt.title('–ò—Å—Ç–∏–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤)')
plt.axvline(x=cholesterol.mean(), color='red', linestyle='--')

# –ü–æ—Å–ª–µ –ø—Ä–æ—Å—Ç–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏
plt.subplot(2, 2, 2)
sns.histplot(data=df_bad, x='–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω', hue='–ü–æ–ª', element='step', kde=True)
plt.title('–ü–æ—Å–ª–µ –ø—Ä–æ—Å—Ç–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏')
plt.axvline(x=df_bad['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].mean(), color='red', linestyle='--')

# –ü–æ—Å–ª–µ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏
plt.subplot(2, 2, 3)
sns.histplot(data=df_good, x='–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω', hue='–ü–æ–ª', element='step', kde=True)
plt.title('–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–æ–ª—É –∏ –≤–æ–∑—Ä–∞—Å—Ç—É')
plt.axvline(x=df_good['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].mean(), color='red', linestyle='--')

# –ü–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
plt.subplot(2, 2, 4)
sns.histplot(data=df_best, x='–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω', hue='–ü–æ–ª', element='step', kde=True)
plt.title('–ü–æ–ª–Ω–∞—è —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø–æ–ª+–≤–æ–∑—Ä–∞—Å—Ç+–∫—É—Ä–µ–Ω–∏–µ)')
plt.axvline(x=df_best['–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'].mean(), color='red', linestyle='--')

plt.tight_layout()
plt.suptitle('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∏–º–ø—É—Ç–∞—Ü–∏–∏: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞', y=1.02)
plt.show()
```

@img_sem03(imputation_ex3.png, –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∏–º–ø—É—Ç–∞—Ü–∏–∏, 100)

</details>

<br>

**–í—ã–≤–æ–¥—ã:** 
–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –¥–∞–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —á–µ–º –ø—Ä–æ—Å—Ç–∞—è –∏–º–ø—É—Ç–∞—Ü–∏—è —Å—Ä–µ–¥–Ω–∏–º, —Ç–∞–∫ –∫–∞–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–∏–Ω–Ω—ã–µ —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞–∑–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –≤ –ø–æ–¥–≥—Ä—É–ø–ø–∞—Ö (–ø–æ –ø–æ–ª—É –∏ –≤–æ–∑—Ä–∞—Å—Ç—É). –û–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –≥—Ä—É–ø–ø–æ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω —É –º—É–∂—á–∏–Ω, –∏ –Ω–µ –∏—Å–∫–∞–∂–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø—Ä–æ—Å—Ç–æ–π –∏–º–ø—É—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–Ω–∏–∂–∞–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≤ –≥—Ä—É–ø–ø–∞—Ö —Å –Ω–µ—Å–ª—É—á–∞–π–Ω—ã–º–∏ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É –ø–æ–∂–∏–ª—ã—Ö –º—É–∂—á–∏–Ω) –∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ —Å–≥–ª–∞–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–∏—è. –í–∏–∑—É–∞–ª—å–Ω–æ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ö–æ–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö, —Ç–æ–≥–¥–∞ –∫–∞–∫ –ø—Ä–æ—Å—Ç–∞—è –∏–º–ø—É—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç –Ω–µ–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∏–∫ –Ω–∞ —Å—Ä–µ–¥–Ω–µ–º –∑–Ω–∞—á–µ–Ω–∏–∏.

---


–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
---

**–ü—Ä–∏–Ω—Ü–∏–ø**: –û–±—ä–µ–¥–∏–Ω—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—â–µ–π –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏.

–ö–∞–∂–¥—ã–π –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –æ—Å–≤–µ—â–∞–µ—Ç –∏–º–ø—É—Ç–∞—Ü–∏—é —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –Ω–æ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å –º–Ω–æ–≥–æ–≥—Ä–∞–Ω–Ω–∞. –ò–º–ø—É—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç —Ö–æ—Ä–æ—à–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ä–µ–¥–Ω–µ–µ, –Ω–æ –Ω–∞—Ä—É—à–∞—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏. –ò–ª–∏ —Ç–æ—á–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã.

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏:**

1. **–ú–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏** ‚Äî MAE, RMSE, MAPE –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –±–ª–∏–∑–æ—Å—Ç–∏ –∫ –∏—Å—Ç–∏–Ω–µ
2. **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, –¥–∏—Å–ø–µ—Ä—Å–∏–∏, –∫–≤–∞–Ω—Ç–∏–ª–µ–π
3. **–°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** ‚Äî —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
4. **–†–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –∏ –¥—Ä—É–≥–∏—Ö —Å–≤—è–∑–µ–π

–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å —Å–∏—Å—Ç–µ–º—É –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏, –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –æ—Ç—á–µ—Ç–∞ –æ–± –∏–º–ø—É—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. 

**–ü—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º—ã –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏:**

|–û—Ç–ª–∏—á–Ω–æ<br>Grade A|–•–æ—Ä–æ—à–æ<br>Grade B|–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ<br>Grade C|–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ<br>Grade D|
|---|---|---|---|
|$MAPE < 10\%$|$10\% < MAPE < 20\%$|$20\% < MAPE < 35\%$|$MAPE > 35\%$|
|$\Delta{mean} < 2\%$|$\Delta{mean} < 2\%$|$\Delta{mean} < 2\%$|$\Delta{mean} < 2\%$|
|$\Delta{std} < 10\%$|$\Delta{std} < 20\%$|$\Delta{std} < 30\%$|$\Delta{std} > 30\%$|
|$p_{KS} > 0.1$|$p_{KS} > 0.05$|$p_{KS} > 0.01$|$p_{KS} \leq 0.01$|

–ó–¥–µ—Å—å $p_{KS}$ -- –∑–Ω–∞—á–µ–Ω–∏–µ p-value –¥–ª—è —Ç–µ—Å—Ç–∞ –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞ (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π).

---

**üìã –ü—Ä–∏–º–µ—Ä.** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å –≥–∞–º–º–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ —Å–∫–æ—à–µ–Ω–Ω–æ–µ, c—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ > –º–µ–¥–∏–∞–Ω—ã) –∏ $30\%$ –ø—Ä–æ–ø—É—Å–∫–æ–≤ (MCAR).

–†–µ–∞–ª–∏–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∫–æ–º–ª–µ–∫—Å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏. 
–§—É–Ω–∫—Ü–∏—è –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —á–µ—Ç—ã—Ä–µ –≥—Ä—É–ø–ø—ã –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π:

- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (—Å—Ä–µ–¥–Ω–µ–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
- –ú–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏

  - MAE (Mean Absolute Error): —Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞
  - RMSE (Root Mean Squared Error): –∫–æ—Ä–µ–Ω—å –∏–∑ —Å—Ä–µ–¥–Ω–µ–π –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–∏
  - MAPE (Mean Absolute Percentage Error): —Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è –æ—à–∏–±–∫–∞

- –¢–µ—Å—Ç—ã –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. –¢–µ—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞: –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (p-value $> 0.05$ ‚áí –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π. –¢–µ—Å—Ç –ö–æ–ª–º–æ–≥–æ—Ä–æ–≤–∞-–°–º–∏—Ä–Ω–æ–≤–∞: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π (p-value $> 0.05$ ‚áí —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è)

~~–î–æ–±–∞–≤—å—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:~~

1. –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –¥–æ/–ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏
2. Q-Q plots –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–≤–∞–Ω—Ç–∏–ª–µ–π
3. –¢–æ—á–µ—á–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –æ—à–∏–±–æ–∫

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import seaborn
except ImportError:
    install_package("seaborn")
try:
    import statsmodels
except ImportError:
    install_package("statsmodels")


import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.metrics import mean_absolute_error, mean_squared_error
from scipy import stats
from statsmodels.graphics.gofplots import qqplot

def evaluate_imputation_quality(original_data, imputed_data, missing_mask=None, true_missing_values=None):
    """
    –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏
    
    Parameters:
    -----------
    original_data : array-like
        –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ–ª–Ω—ã–µ)
    imputed_data : array-like  
        –î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∏–º–ø—É—Ç–∞—Ü–∏–∏
    missing_mask : array-like, optional
        –ú–∞—Å–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    true_missing_values : array-like, optional
        –ò—Å—Ç–∏–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
    """
    
    results = {}
    
    # 1. –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    results['mean_original'] = np.mean(original_data)
    results['mean_imputed'] = np.mean(imputed_data)
    results['mean_diff'] = abs(results['mean_imputed'] - results['mean_original'])
    
    results['median_original'] = np.median(original_data)
    results['median_imputed'] = np.median(imputed_data)
    results['median_diff'] = abs(results['median_imputed'] - results['median_original'])
    
    results['std_original'] = np.std(original_data)
    results['std_imputed'] = np.std(imputed_data)
    results['std_diff'] = abs(results['std_imputed'] - results['std_original'])
    
    # 2. –ú–µ—Ç—Ä–∏–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
    if true_missing_values is not None and missing_mask is not None:
        imputed_missing = imputed_data[missing_mask]
        results['mae'] = mean_absolute_error(true_missing_values, imputed_missing)
        results['rmse'] = np.sqrt(mean_squared_error(true_missing_values, imputed_missing))
        results['mape'] = np.mean(np.abs((true_missing_values - imputed_missing) / true_missing_values) * 100)
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
        results['max_error'] = np.max(np.abs(true_missing_values - imputed_missing))
        results['error_std'] = np.std(true_missing_values - imputed_missing)
    
    # 3. –¢–µ—Å—Ç—ã –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
    if len(original_data) <= 5000:
        _, results['shapiro_original'] = stats.shapiro(original_data)
        _, results['shapiro_imputed'] = stats.shapiro(imputed_data)
    
    # 4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π
    results['ks_stat'], results['ks_p'] = stats.ks_2samp(original_data, imputed_data)
    
    # 5. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ (–ø—Ä–∏–º–µ—Ä)
    if isinstance(original_data, pd.DataFrame):
        corr_orig = original_data.corr().values
        corr_imp = imputed_data.corr().values
        results['corr_diff'] = np.mean(np.abs(corr_orig - corr_imp))
    
    return results

#TODO: –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
def plot_imputation_results(original, imputed, missing_mask, method_name):
    """–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–º–ø—É—Ç–∞—Ü–∏–∏"""
    plt.figure(figsize=(18, 12))
    
    # –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã

    # Q-Q plot –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    
    # Q-Q plot –∏–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    
    # –û—à–∏–±–∫–∏ –∏–º–ø—É—Ç–∞—Ü–∏–∏
    
    plt.tight_layout()
    plt.show()

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è–º–∏
np.random.seed(42)
n = 1000

# –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π
age = np.random.uniform(18, 80, n)
bmi = np.random.normal(25, 4, n)
data = pd.DataFrame({
    'age': age,
    'bmi': bmi,
    'health_index': 50 + 0.5*age - 0.8*bmi + np.random.normal(0, 10, n)
})

# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ health_index (MAR - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞)
missing_prob = 1 / (1 + np.exp(-(age - 50)/10))
missing_mask = np.random.binomial(1, missing_prob, n).astype(bool)

original = data.copy()
true_missing = original.loc[missing_mask, 'health_index'].copy()
data.loc[missing_mask, 'health_index'] = np.nan

# –ú–µ—Ç–æ–¥—ã –∏–º–ø—É—Ç–∞—Ü–∏–∏
methods = {
    '–°—Ä–µ–¥–Ω–µ–µ': data['health_index'].fillna(data['health_index'].mean()),
    '–ú–µ–¥–∏–∞–Ω–∞': data['health_index'].fillna(data['health_index'].median()),
    '–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è': data.copy()
}

# –ò–º–ø—É—Ç–∞—Ü–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π
from sklearn.linear_model import LinearRegression
lr = LinearRegression()
train_idx = ~missing_mask
lr.fit(data.loc[train_idx, ['age', 'bmi']], data.loc[train_idx, 'health_index'])
methods['–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è'].loc[missing_mask, 'health_index'] = lr.predict(data.loc[missing_mask, ['age', 'bmi']])

# –û—Ü–µ–Ω–∫–∞ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
print("–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–º–ø—É—Ç–∞—Ü–∏–∏")
print("="*50)

for method_name, imputed_data in methods.items():
    if isinstance(imputed_data, pd.DataFrame):
        imputed_values = imputed_data['health_index'].values
    else:
        imputed_values = imputed_data.values
    
    quality = evaluate_imputation_quality(
        original_data=original['health_index'].values,
        imputed_data=imputed_values,
        missing_mask=missing_mask,
        true_missing_values=true_missing.values
    )
    
    print(f"\n{method_name}:")
    print(f"  –¢–æ—á–Ω–æ—Å—Ç—å:")
    print(f"    MAE: {quality['mae']:.3f}  RMSE: {quality['rmse']:.3f}  MAPE: {quality['mape']:.1f}\%")
    print(f"    –ú–∞–∫—Å. –æ—à–∏–±–∫–∞: {quality['max_error']:.3f}  STD –æ—à–∏–±–æ–∫: {quality['error_std']:.3f}")
    
    print(f"  –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:")
    print(f"    –°—Ä–µ–¥–Ω–µ–µ: {quality['mean_original']:.3f} ‚Üí {quality['mean_imputed']:.3f} (Œî={quality['mean_diff']:.3f})")
    print(f"    –ú–µ–¥–∏–∞–Ω–∞: {quality['median_original']:.3f} ‚Üí {quality['median_imputed']:.3f} (Œî={quality['median_diff']:.3f})")
    print(f"    STD: {quality['std_original']:.3f} ‚Üí {quality['std_imputed']:.3f} (Œî={quality['std_diff']:.3f})")
    
    print(f"  –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:")
    print(f"    KS-test p-value: {quality['ks_p']:.4f}", 
          "‚úÖ" if quality['ks_p'] > 0.05 else "‚ùå")
    if 'shapiro_original' in quality:
        print(f"    Shapiro original: {quality['shapiro_original']:.4f}",
              "(normal)" if quality['shapiro_original'] > 0.05 else "(non-normal)")
        print(f"    Shapiro imputed: {quality['shapiro_imputed']:.4f}",
              "(normal)" if quality['shapiro_imputed'] > 0.05 else "(non-normal)")
    
    # TODO: –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    #plot_imputation_results(original['health_index'].values, imputed_values, missing_mask, method_name)
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

<details>
<summary>~~–í–æ–∑–º–æ–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏~~</summary>

```python
def plot_imputation_results(original, imputed, missing_mask, method_name):
    """–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–º–ø—É—Ç–∞—Ü–∏–∏"""
    plt.figure(figsize=(18, 12))
    
    # –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã
    plt.subplot(2, 3, 1)
    sns.histplot(original, kde=True, color='blue', label='Original')
    sns.histplot(imputed, kde=True, color='red', alpha=0.5, label='Imputed')
    plt.title(f'–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ({method_name})')
    plt.legend()
    
    # Q-Q plot –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    plt.subplot(2, 3, 2)
    qqplot(original, line='s', ax=plt.gca())
    plt.title('Q-Q plot –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö')
    
    # Q-Q plot –∏–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    plt.subplot(2, 3, 3)
    qqplot(imputed, line='s', ax=plt.gca())
    plt.title('Q-Q plot –∏–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö')
    
    # –û—à–∏–±–∫–∏ –∏–º–ø—É—Ç–∞—Ü–∏–∏
    if missing_mask is not None:
        errors = original[missing_mask] - imputed[missing_mask]
        plt.subplot(2, 3, 4)
        sns.histplot(errors, kde=True)
        plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏–º–ø—É—Ç–∞—Ü–∏–∏')
        
        plt.subplot(2, 3, 5)
        plt.scatter(original[missing_mask], imputed[missing_mask], alpha=0.5)
        plt.plot([min(original), max(original)], [min(original), max(original)], 'r--')
        plt.xlabel('–ò—Å—Ç–∏–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è')
        plt.ylabel('–ò–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è')
        plt.title('–ò—Å—Ç–∏–Ω–Ω—ã–µ vs –ò–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è')
    
    plt.tight_layout()
    plt.show()
```

–î–æ–±–∞–≤–∏–≤ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–º–ø—É—Ç–∞—Ü–∏–∏ (—Å—Ä–µ–¥–Ω–µ–µ, –º–µ–¥–∏–∞–Ω–∞, –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è).

@img_sem03(imp_mean.png, –ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∏–º–ø—É—Ç–∞—Ü–∏–∏ —Å—Ä–µ–¥–Ω–∏–º, 100)

@img_sem03(imp_mediana.png, –ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∏–º–ø—É—Ç–∞—Ü–∏–∏ –º–µ–¥–∏–∞–Ω–æ–π, 100)

@img_sem03(imp_linreg.png, –ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∏–º–ø—É—Ç–∞—Ü–∏–∏ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π, 100)

</details>

<br>

<details>
<summary>~~–í—ã–≤–æ–¥—ã –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –º–µ—Ç–æ–¥–æ–≤ –∏–º–ø—É—Ç–∞—Ü–∏–∏~~</summary>

---

**1. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —Ç–æ—á–Ω–æ—Å—Ç–∏**

| –ú–µ—Ç–æ–¥               | MAE   | RMSE  | MAPE  | –ú–∞–∫—Å. –æ—à–∏–±–∫–∞ | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (KS-test p-value) |
|---------------------|-------|-------|-------|--------------|--------------------------------------------|
| **–°—Ä–µ–¥–Ω–µ–µ**         | $8.92$  | $10.87$ | $18.3\%$ | $38.21$        | $0.000$                                 |
| **–ú–µ–¥–∏–∞–Ω–∞**         | $7.85$  | $9.62$  | $16.1\%$ | $34.57$        | $0.000$                                  |
| **–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è** | $5.23$  | $6.78$  | $10.7\%$ | $25.43$        | $0.142$                                 |

–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø–æ–∫–∞–∑–∞–ª–∞ –Ω–∞–∏–ª—É—á—à—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ –≤—Å–µ–º –º–µ—Ç—Ä–∏–∫–∞–º (MAE –Ω–∞ $40\%$ –ª—É—á—à–µ, —á–µ–º —É —Å—Ä–µ–¥–Ω–µ–≥–æ).

–ú–µ–¥–∏–∞–Ω–∞ –Ω–µ–º–Ω–æ–≥–æ –ª—É—á—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, –Ω–æ –æ–±–∞ –º–µ—Ç–æ–¥–∞ —Å–∏–ª—å–Ω–æ –∏—Å–∫–∞–∂–∞—é—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (p-value $‚âà 0$).

–í—Å–µ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç $MAPE < 20\%$, —á—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∏–µ–º–ª–µ–º—ã–º, –Ω–æ —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Ç–æ—á–Ω–µ–µ.


**2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫**

| –ú–µ—Ç–æ–¥               | Œî —Å—Ä–µ–¥–Ω–µ–≥–æ | Œî –º–µ–¥–∏–∞–Ω—ã | Œî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è |
|---------------------|------------|-----------|---------------------------|
| **–°—Ä–µ–¥–Ω–µ–µ**         | 0.54       | 1.87      | -2.31          |
| **–ú–µ–¥–∏–∞–Ω–∞**         | 1.02       | 0.12      | -1.98          |
| **–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è** | 0.08       | 0.05      | +0.14  |

–†–µ–≥—Ä–µ—Å—Å–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –º–µ–Ω—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω—É.

–ü—Ä–æ—Å—Ç–∞—è –∏–º–ø—É—Ç–∞—Ü–∏—è —Å–Ω–∏–∂–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ "—Å–∂–∏–º–∞–µ—Ç" –¥–∞–Ω–Ω—ã–µ).


**3. –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π (–≥—Ä–∞—Ñ–∏–∫–∏)**

- **–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã**:

   - –°—Ä–µ–¥–Ω–µ–µ/–º–µ–¥–∏–∞–Ω–∞: –°–æ–∑–¥–∞—é—Ç –Ω–µ–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∏–∫ –≤ —Ä–∞–π–æ–Ω–µ –∏–º–ø—É—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∏—Å–∫–∞–∂–∞—è —Ñ–æ—Ä–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
   - –†–µ–≥—Ä–µ—Å—Å–∏—è: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ö–æ–¥–Ω—É—é —Ñ–æ—Ä–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—é.

- **Q-Q plots**:

   - –î–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ/–º–µ–¥–∏–∞–Ω—ã: –¢–æ—á–∫–∏ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è –æ—Ç –ª–∏–Ω–∏–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ —Ö–≤–æ—Å—Ç–∞—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è).
   - –î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏: –¢–æ—á–∫–∏ –±–ª–∏–∑–∫–∏ –∫ –ª–∏–Ω–∏–∏, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

- **–û—à–∏–±–∫–∏ –∏–º–ø—É—Ç–∞—Ü–∏–∏**:

   - –°—Ä–µ–¥–Ω–µ–µ/–º–µ–¥–∏–∞–Ω–∞: –û—à–∏–±–∫–∏ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ (–∑–∞–Ω–∏–∂–µ–Ω–∏–µ –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π).
   - –†–µ–≥—Ä–µ—Å—Å–∏—è: –û—à–∏–±–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ª—É—á–∞–π–Ω–æ, –±–µ–∑ —è–≤–Ω—ã—Ö —Å–º–µ—â–µ–Ω–∏–π.

**4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π**

–¢–æ–ª—å–∫–æ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è `health_index ~ age` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –Ω–∞ $98\%$ (–ø—Ä–æ—Ç–∏–≤ $85\%$ —É –ø—Ä–æ—Å—Ç—ã—Ö –º–µ—Ç–æ–¥–æ–≤).
- –ù–µ —Å–æ–∑–¥–∞–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≤ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

**–í—ã–≤–æ–¥ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:**

- –õ—É—á—à–∏–π –º–µ—Ç–æ–¥: –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π).
- –•—É–¥—à–∏–π –º–µ—Ç–æ–¥: –ò–º–ø—É—Ç–∞—Ü–∏—è —Å—Ä–µ–¥–Ω–∏–º (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∏—Å–∫–∞–∂–µ–Ω–∏—è).

---
</details>

<br>

---

#### –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤

1. **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤**:

   - –°–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤? ($<5\%$ ‚Üí —É–¥–∞–ª–µ–Ω–∏–µ; $5$-$30\%$ ‚Üí –∏–º–ø—É—Ç–∞—Ü–∏—è; $>30\%$ ‚Üí –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
   - –ö–∞–∫–æ–π —Ç–∏–ø –ø—Ä–æ–ø—É—Å–∫–æ–≤? (MCAR ‚Üí –ª—é–±–æ–π –º–µ—Ç–æ–¥; MAR ‚Üí ML; MNAR ‚Üí –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å ML)
   - –ï—Å—Ç—å –ª–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏? (—Å–ª–∞–±—ã–µ $<0.3$ ‚Üí –ø—Ä–æ—Å—Ç—ã–µ –º–µ—Ç–æ–¥—ã; —Å–∏–ª—å–Ω—ã–µ $>0.5$ ‚Üí ML)

2. **–í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞:**
   
   - –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ $< 100$ ‚Üí –ø—Ä–æ—Å—Ç—ã–µ –º–µ—Ç–æ–¥—ã (—Å—Ä–µ–¥–Ω–µ–µ/–º–µ–¥–∏–∞–Ω–∞/–º–æ–¥–∞)
   - –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ $> 500$ –ò –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ $> 0.5$ ‚Üí –ø—Ä–æ–±—É–µ–º ML
   - –ï—Å–ª–∏ –≤–∞–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å ‚Üí –ø—Ä–æ—Å—Ç—ã–µ –º–µ—Ç–æ–¥—ã
   - –ï—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å ‚Üí ML —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**

   - –õ–æ–≥–∏—á–Ω—ã –ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è?
   - –°–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è?
   - –ù–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏?
   - –ö–∞–∫–æ–≤–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏?

**–ü–æ–º–Ω–∏—Ç–µ**: 

- ~~–ö–æ–Ω—Ç–µ–∫—Å—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã~~. –õ—é–±–æ–π –º–µ—Ç–æ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å –≤ –¥–∞–Ω–Ω—ã–µ. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –≤—ã–±—Ä–∞—Ç—å –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∏—Å–∫–∞–∂–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞—à–µ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏! –ù–∞–ø—Ä–∏–º–µ—Ä:

  - –î–ª—è –±—é–¥–∂–µ—Ç–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ä–µ–¥–Ω–µ–µ
  - –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–∏—Å–∫–æ–≤ –≤–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å "—Ö–≤–æ—Å—Ç—ã" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  - –î–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑–∏

- ~~–ü—Ä–æ—Å—Ç–æ—Ç–∞ —á–∞—Å—Ç–æ –ª—É—á—à–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏~~. –ï—Å–ª–∏ –º–µ–¥–∏–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ $90\%$ —Ç–∞–∫ –∂–µ —Ö–æ—Ä–æ—à–æ, –∫–∞–∫ —Å–ª–æ–∂–Ω–∞—è ML-–º–æ–¥–µ–ª—å, –≤—ã–±–∏—Ä–∞–π—Ç–µ –º–µ–¥–∏–∞–Ω—É.

- ~~–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö~~. –ë—É–¥—É—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω—ã –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ –∏ –∫ —á–µ–º—É —ç—Ç–æ –ø—Ä–∏–≤–µ–ª–æ.

**–ö–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –∏–º–ø—É—Ç–∞—Ü–∏–∏:**

- –ë–æ–ª–µ–µ $50\%$ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–ø—É—â–µ–Ω–æ –≤ –∫–ª—é—á–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- –í—Å–µ –º–µ—Ç–æ–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å–ª–∏—à–∫–æ–º —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ (—è–≤–Ω—ã–π MNAR)
- –ü—Ä–µ–¥–º–µ—Ç–Ω—ã–µ —ç–∫—Å–ø–µ—Ä—Ç—ã —Å—á–∏—Ç–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ/—Ä–µ—Å—É—Ä—Å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É

---
### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –æ—à–∏–±–æ–∫ (TODO)
---

> **üéØ –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å—Ç—Ä–µ–ª—å–±—É –ø–æ –º–∏—à–µ–Ω–∏.** –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≤—ã—Å—Ç—Ä–µ–ª–æ–≤ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Ü–µ–Ω—Ç—Ä –∏–ª–∏ —Ä—è–¥–æ–º —Å –Ω–∏–º. –ù–æ –∏–Ω–æ–≥–¥–∞ –ø—É–ª—è —É–ª–µ—Ç–∞–µ—Ç –¥–∞–ª–µ–∫–æ –≤ —Å—Ç–æ—Ä–æ–Ω—É ‚Äî —ç—Ç–æ –≤—ã–±—Ä–æ—Å. –í–æ–∑–º–æ–∂–Ω–æ, –¥—Ä–æ–≥–Ω—É–ª–∞ —Ä—É–∫–∞, –∏–ª–∏ –ø–æ–¥—É–ª –≤–µ—Ç–µ—Ä, –∏–ª–∏ —ç—Ç–æ –≤–æ–æ–±—â–µ –≤—ã—Å—Ç—Ä–µ–ª –¥—Ä—É–≥–æ–≥–æ —Å—Ç—Ä–µ–ª–∫–∞. –ù—É–∂–Ω–æ –ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –≤—ã—Å—Ç—Ä–µ–ª—ã –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –º–µ—Ç–∫–æ—Å—Ç–∏?

**–í—ã–±—Ä–æ—Å—ã (outliers)** ‚Äî —ç—Ç–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –º–∞—Å—Å—ã –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∫–∞–∫ –æ—à–∏–±–∫–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è, —Ç–∞–∫ –∏ —Ä–µ–¥–∫–∏–º–∏, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏.

**–¢–∏–ø—ã –∞–Ω–æ–º–∞–ª–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö:**

1. **–¢–æ—á–µ—á–Ω—ã–µ –≤—ã–±—Ä–æ—Å—ã** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏** ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ +30¬∞C –∑–∏–º–æ–π)
3. **–ö–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–Ω–æ–º–∞–ª–∏–∏** ‚Äî –≥—Ä—É–ø–ø–∞ –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ —Ñ–æ–Ω–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
4. **–û—à–∏–±–∫–∏ –≤–≤–æ–¥–∞** ‚Äî –æ–ø–µ—á–∞—Ç–∫–∏, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏

@NB(`–ù–µ –≤—Å–µ –≤—ã–±—Ä–æ—Å—ã ‚Äî —ç—Ç–æ –æ—à–∏–±–∫–∏! –ú–∏–ª–ª–∏–æ–Ω–µ—Ä —Å—Ä–µ–¥–∏ –æ–±—ã—á–Ω—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ ‚Äî —ç—Ç–æ –≤—ã–±—Ä–æ—Å, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–π. –£–¥–∞–ª—è—è –≤—Å–µ –≤—ã–±—Ä–æ—Å—ã –ø–æ–¥—Ä—è–¥, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—Ç–µ—Ä—è—Ç—å –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–¥–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö.`)

#### –ú–µ—Ç–æ–¥—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤ (TODO)

–ú–µ—Ç–æ–¥ –º–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–∞—Ö–∞ (IQR)
---

–°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –∏ –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ç–æ–¥. –í—ã–±—Ä–æ—Å–∞–º–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è, –≤—ã—Ö–æ–¥—è—â–∏–µ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã:

- –ù–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞: $Q_1 - 1.5 \times IQR$
- –í–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞: $Q_3 + 1.5 \times IQR$

–≥–¥–µ $IQR = Q_3 - Q_1$ (–º–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–∞—Ö)

---
**üìã –ü—Ä–∏–º–µ—Ä.** –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ—Ç–æ–¥–æ–º IQR —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import seaborn
except ImportError:
    install_package("seaborn")

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏
np.random.seed(42)
normal_salaries = np.random.normal(60000, 15000, 200)
outlier_salaries = [250000, 300000, 15000, 10000, 350000]  # –í—ã–±—Ä–æ—Å—ã
all_salaries = np.concatenate([normal_salaries, outlier_salaries])

df = pd.DataFrame({'–∑–∞—Ä–ø–ª–∞—Ç–∞': all_salaries})

def detect_outliers_iqr(data, column, k=1.5):
    """
    –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ—Ç–æ–¥–æ–º IQR
    
    Parameters:
    -----------
    data : DataFrame
    column : str - –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞
    k : float - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è –≥—Ä–∞–Ω–∏—Ü (–æ–±—ã—á–Ω–æ 1.5 –∏–ª–∏ 3)
    
    Returns:
    --------
    outliers : DataFrame —Å –≤—ã–±—Ä–æ—Å–∞–º–∏
    bounds : tuple (–Ω–∏–∂–Ω—è—è_–≥—Ä–∞–Ω–∏—Ü–∞, –≤–µ—Ä—Ö–Ω—è—è_–≥—Ä–∞–Ω–∏—Ü–∞)
    """
    Q1 = data[column].quantile(0.25)
    Q3 = data[column].quantile(0.75)
    IQR = Q3 - Q1
    
    lower_bound = Q1 - k * IQR
    upper_bound = Q3 + k * IQR
    
    outliers = data[(data[column] < lower_bound) | (data[column] > upper_bound)]
    
    print(f"–ú–µ—Ç–æ–¥ IQR –¥–ª—è '{column}':")
    print(f"Q1 = {Q1:,.0f}")
    print(f"Q3 = {Q3:,.0f}")
    print(f"IQR = {IQR:,.0f}")
    print(f"–ì—Ä–∞–Ω–∏—Ü—ã: [{lower_bound:,.0f}, {upper_bound:,.0f}]")
    print(f"–ù–∞–π–¥–µ–Ω–æ –≤—ã–±—Ä–æ—Å–æ–≤: {len(outliers)} ({len(outliers)/len(data)*100:.1f}%)")
    
    return outliers, (lower_bound, upper_bound)

# –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ–º –≤—ã–±—Ä–æ—Å—ã
outliers, bounds = detect_outliers_iqr(df, '–∑–∞—Ä–ø–ª–∞—Ç–∞')

print("\n–í—ã–±—Ä–æ—Å—ã:")
print(outliers.sort_values('–∑–∞—Ä–ø–ª–∞—Ç–∞'))

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
fig, axes = plt.subplots(1, 3, figsize=(15, 5))

# Boxplot
axes[0].boxplot(df['–∑–∞—Ä–ø–ª–∞—Ç–∞'])
axes[0].set_title('Boxplot (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã–±—Ä–æ—Å—ã)')
axes[0].set_ylabel('–ó–∞—Ä–ø–ª–∞—Ç–∞')

# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
axes[1].hist(df['–∑–∞—Ä–ø–ª–∞—Ç–∞'], bins=30, edgecolor='black', alpha=0.7)
axes[1].axvline(bounds[0], color='red', linestyle='--', label=f'–ù–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞')
axes[1].axvline(bounds[1], color='red', linestyle='--', label=f'–í–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞')
axes[1].set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ IQR')
axes[1].set_xlabel('–ó–∞—Ä–ø–ª–∞—Ç–∞')
axes[1].legend()
axes[1].tick_params(axis='x', rotation=45)

# Scatter plot —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –≤—ã–±—Ä–æ—Å–æ–≤
axes[2].scatter(range(len(df)), df['–∑–∞—Ä–ø–ª–∞—Ç–∞'], alpha=0.5, label='–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ')
outlier_indices = outliers.index
axes[2].scatter(outlier_indices, df.loc[outlier_indices, '–∑–∞—Ä–ø–ª–∞—Ç–∞'], 
                color='red', s=50, label='–í—ã–±—Ä–æ—Å—ã')
axes[2].set_title('–í—ã–±—Ä–æ—Å—ã –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ')
axes[2].set_xlabel('–ò–Ω–¥–µ–∫—Å')
axes[2].set_ylabel('–ó–∞—Ä–ø–ª–∞—Ç–∞')
axes[2].legend()

plt.tight_layout()
plt.show()
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

@img_sem03(IQR.png, IQR, 100)

–ú–µ—Ç–æ–¥ Z-score (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π)
---

–í—ã–±—Ä–æ—Å–∞–º–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö:
$$|Z| = \left|\frac{x - \mu}{\sigma}\right| > 3$$

–≥–¥–µ $\mu$ ‚Äî —Å—Ä–µ–¥–Ω–µ–µ, $\sigma$ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ

---
**üìã –ü—Ä–∏–º–µ—Ä.** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ IQR –∏ Z-score.

```python
import pandas as pd
import numpy as np

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏
np.random.seed(42)
normal_salaries = np.random.normal(60000, 15000, 200)
outlier_salaries = [250000, 300000, 15000, 10000, 350000]  # –í—ã–±—Ä–æ—Å—ã
all_salaries = np.concatenate([normal_salaries, outlier_salaries])

df = pd.DataFrame({'–∑–∞—Ä–ø–ª–∞—Ç–∞': all_salaries})

def detect_outliers_iqr(data, column, k=1.5):
    """
    –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ—Ç–æ–¥–æ–º IQR
    """
    Q1 = data[column].quantile(0.25)
    Q3 = data[column].quantile(0.75)
    IQR = Q3 - Q1
    
    lower_bound = Q1 - k * IQR
    upper_bound = Q3 + k * IQR
    
    outliers = data[(data[column] < lower_bound) | (data[column] > upper_bound)]
    
    print(f"–ú–µ—Ç–æ–¥ IQR –¥–ª—è '{column}':")
    print(f"Q1 = {Q1:,.0f}")
    print(f"Q3 = {Q3:,.0f}")
    print(f"IQR = {IQR:,.0f}")
    print(f"–ì—Ä–∞–Ω–∏—Ü—ã: [{lower_bound:,.0f}, {upper_bound:,.0f}]")
    print(f"–ù–∞–π–¥–µ–Ω–æ –≤—ã–±—Ä–æ—Å–æ–≤: {len(outliers)} ({len(outliers)/len(data)*100:.1f}%)")
    
    return outliers, (lower_bound, upper_bound)
    
def detect_outliers_zscore(data, column, threshold=3):
    """
    –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ—Ç–æ–¥–æ–º Z-score
    """
    mean = data[column].mean()
    std = data[column].std()
    z_scores = np.abs((data[column] - mean) / std)
    
    outliers = data[z_scores > threshold]
    
    print(f"–ú–µ—Ç–æ–¥ Z-score –¥–ª—è '{column}':")
    print(f"–°—Ä–µ–¥–Ω–µ–µ = {mean:,.0f}")
    print(f"Std = {std:,.0f}")
    print(f"–ü–æ—Ä–æ–≥ Z-score = {threshold}")
    print(f"–ù–∞–π–¥–µ–Ω–æ –≤—ã–±—Ä–æ—Å–æ–≤: {len(outliers)} ({len(outliers)/len(data)*100:.1f}%)")
    
    return outliers, z_scores

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –º–µ—Ç–æ–¥—ã
print("="*50)
print("–°–†–ê–í–ù–ï–ù–ò–ï –ú–ï–¢–û–î–û–í –û–ë–ù–ê–†–£–ñ–ï–ù–ò–Ø –í–´–ë–†–û–°–û–í")
print("="*50)

# IQR –º–µ—Ç–æ–¥
outliers_iqr, bounds_iqr = detect_outliers_iqr(df, '–∑–∞—Ä–ø–ª–∞—Ç–∞', k=1.5)

print("\n" + "-"*50)

# Z-score –º–µ—Ç–æ–¥
outliers_zscore, z_scores = detect_outliers_zscore(df, '–∑–∞—Ä–ø–ª–∞—Ç–∞', threshold=3)

# –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –∏ —Ä–∞–∑–ª–∏—á–∏—è
common_outliers = set(outliers_iqr.index) & set(outliers_zscore.index)
only_iqr = set(outliers_iqr.index) - set(outliers_zscore.index)
only_zscore = set(outliers_zscore.index) - set(outliers_iqr.index)

print("\n" + "="*50)
print("–ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")
print(f"–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ–±–æ–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏: {len(common_outliers)} –≤—ã–±—Ä–æ—Å–æ–≤")
print(f"–¢–æ–ª—å–∫–æ IQR: {len(only_iqr)} –≤—ã–±—Ä–æ—Å–æ–≤")
print(f"–¢–æ–ª—å–∫–æ Z-score: {len(only_zscore)} –≤—ã–±—Ä–æ—Å–æ–≤")

if len(only_iqr) > 0:
    print(f"\n–ó–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ IQR —Å—á–∏—Ç–∞–µ—Ç –≤—ã–±—Ä–æ—Å–∞–º–∏, –∞ Z-score –Ω–µ—Ç:")
    print(df.loc[list(only_iqr), '–∑–∞—Ä–ø–ª–∞—Ç–∞'].values)
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

–ú–µ—Ç–æ–¥ –∏–∑–æ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –ª–µ—Å–∞ (Isolation Forest)
---

–ê–ª–≥–æ—Ä–∏—Ç–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π. –û—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---
**üìã –ü—Ä–∏–º–µ—Ä.** –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤ —Å Isolation Forest.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

from sklearn.ensemble import IsolationForest
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# –°–æ–∑–¥–∞–µ–º –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏
np.random.seed(42)
n_samples = 200

# –û—Å–Ω–æ–≤–Ω–∞—è –≥—Ä—É–ø–ø–∞ –¥–∞–Ω–Ω—ã—Ö
X_normal = np.random.randn(n_samples, 2)
X_normal[:, 0] = X_normal[:, 0] * 15 + 50  # –≤–æ–∑—Ä–∞—Å—Ç
X_normal[:, 1] = X_normal[:, 1] * 20000 + 60000  # –∑–∞—Ä–ø–ª–∞—Ç–∞

# –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±—Ä–æ—Å—ã
X_outliers = np.array([
    [25, 150000],  # –ú–æ–ª–æ–¥–æ–π —Å –æ–≥—Ä–æ–º–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π
    [70, 30000],   # –ü–æ–∂–∏–ª–æ–π —Å –º–∞–ª–µ–Ω—å–∫–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π
    [45, 200000],  # –ê–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞
    [18, 80000],   # –°–ª–∏—à–∫–æ–º –º–æ–ª–æ–¥–æ–π
    [85, 100000],  # –°–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä—ã–π
])

X = np.vstack([X_normal, X_outliers])
df_multi = pd.DataFrame(X, columns=['–≤–æ–∑—Ä–∞—Å—Ç', '–∑–∞—Ä–ø–ª–∞—Ç–∞'])

print("–î–∞–Ω–Ω—ã–µ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏ (–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫):\n", df_multi.head())

# –û–±—É—á–∞–µ–º Isolation Forest
iso_forest = IsolationForest(
    contamination=0.05,  # –û–∂–∏–¥–∞–µ–º–∞—è –¥–æ–ª—è –≤—ã–±—Ä–æ—Å–æ–≤
    random_state=42
)
predictions = iso_forest.fit_predict(df_multi)
df_multi['is_outlier'] = predictions == -1

print(f"\nIsolation Forest: –Ω–∞–π–¥–µ–Ω–æ {df_multi['is_outlier'].sum()} –≤—ã–±—Ä–æ—Å–æ–≤ \n{df_multi[df_multi['is_outlier']]}")

# –°—Ä–∞–≤–Ω–∏–º —Å –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏

def detect_outliers_iqr(data, column, k=1.5):
    """
    –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ—Ç–æ–¥–æ–º IQR
    """
    Q1 = data[column].quantile(0.25)
    Q3 = data[column].quantile(0.75)
    IQR = Q3 - Q1
    
    lower_bound = Q1 - k * IQR
    upper_bound = Q3 + k * IQR
    
    outliers = data[(data[column] < lower_bound) | (data[column] > upper_bound)]
    return outliers, (lower_bound, upper_bound)

outliers_age_iqr, _ = detect_outliers_iqr(df_multi, '–≤–æ–∑—Ä–∞—Å—Ç')
outliers_salary_iqr, _ = detect_outliers_iqr(df_multi, '–∑–∞—Ä–ø–ª–∞—Ç–∞')

print(f"\nIQR –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É: –Ω–∞–π–¥–µ–Ω–æ {len(outliers_age_iqr)} –≤—ã–±—Ä–æ—Å–æ–≤\n {outliers_age_iqr}")
print(f"\nIQR –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–µ: –Ω–∞–π–¥–µ–Ω–æ {len(outliers_salary_iqr)} –≤—ã–±—Ä–æ—Å–æ–≤\n {outliers_salary_iqr}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

#### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±—Ä–æ—Å–æ–≤ (TODO)
----

–ü–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ —Å –Ω–∏–º–∏ –¥–µ–ª–∞—Ç—å. –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–∏—Ä–æ–¥—ã –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –∑–∞–¥–∞—á–∏.

–£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤
---

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ –æ–ø–∞—Å–Ω—ã–π –º–µ—Ç–æ–¥. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —ç—Ç–æ –æ—à–∏–±–∫–∏.

```python
# –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤
df_no_outliers = df[~df.index.isin(outliers_iqr.index)]
print(f"–ë—ã–ª–æ: {len(df)} —Å—Ç—Ä–æ–∫")
print(f"–°—Ç–∞–ª–æ: {len(df_no_outliers)} —Å—Ç—Ä–æ–∫")
print(f"–£–¥–∞–ª–µ–Ω–æ: {len(df) - len(df_no_outliers)} —Å—Ç—Ä–æ–∫")
```

–ó–∞–º–µ–Ω–∞ –Ω–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (Winsorization)
---

–í—ã–±—Ä–æ—Å—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

---
**üìã –ü—Ä–∏–º–µ—Ä.** –†–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±—Ä–æ—Å–æ–≤.

```python
def handle_outliers(data, column, method='remove', bounds=None):
    """
    –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
    
    Parameters:
    -----------
    method : str
        'remove' - —É–¥–∞–ª–µ–Ω–∏–µ
        'cap' - –∑–∞–º–µ–Ω–∞ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü—ã
        'transform' - –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ
        'separate' - –æ—Ç–¥–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
    """
    df = data.copy()
    
    if bounds is None:
        Q1 = df[column].quantile(0.25)
        Q3 = df[column].quantile(0.75)
        IQR = Q3 - Q1
        lower_bound = Q1 - 1.5 * IQR
        upper_bound = Q3 + 1.5 * IQR
    else:
        lower_bound, upper_bound = bounds
    
    outliers_mask = (df[column] < lower_bound) | (df[column] > upper_bound)
    n_outliers = outliers_mask.sum()
    
    if method == 'remove':
        # –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤
        df_clean = df[~outliers_mask]
        print(f"–ú–µ—Ç–æ–¥: –£–î–ê–õ–ï–ù–ò–ï")
        print(f"–£–¥–∞–ª–µ–Ω–æ {n_outliers} –≤—ã–±—Ä–æ—Å–æ–≤")
        
    elif method == 'cap':
        # –ó–∞–º–µ–Ω–∞ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü—ã
        df_clean = df.copy()
        df_clean.loc[df[column] < lower_bound, column] = lower_bound
        df_clean.loc[df[column] > upper_bound, column] = upper_bound
        print(f"–ú–µ—Ç–æ–¥: –û–ì–†–ê–ù–ò–ß–ï–ù–ò–ï (Winsorization)")
        print(f"–ó–∞–º–µ–Ω–µ–Ω–æ {n_outliers} –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü—ã")
        
    elif method == 'transform':
        # –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
        df_clean = df.copy()
        # –î–æ–±–∞–≤–ª—è–µ–º 1 —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å log(0)
        df_clean[f'{column}_log'] = np.log1p(df_clean[column])
        print(f"–ú–µ—Ç–æ–¥: –¢–†–ê–ù–°–§–û–†–ú–ê–¶–ò–Ø (–ª–æ–≥–∞—Ä–∏—Ñ–º)")
        print(f"–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫ '{column}_log'")
        
    elif method == 'separate':
        # –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–±—Ä–æ—Å–∞
        df_clean = df.copy()
        df_clean[f'{column}_is_outlier'] = outliers_mask.astype(int)
        print(f"–ú–µ—Ç–æ–¥: –ò–ù–î–ò–ö–ê–¢–û–†")
        print(f"–°–æ–∑–¥–∞–Ω –ø—Ä–∏–∑–Ω–∞–∫ '{column}_is_outlier' –¥–ª—è {n_outliers} –≤—ã–±—Ä–æ—Å–æ–≤")
    
    else:
        raise ValueError(f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –º–µ—Ç–æ–¥: {method}")
    
    return df_clean

# –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã
print("="*60)
print("–°–†–ê–í–ù–ï–ù–ò–ï –ú–ï–¢–û–î–û–í –û–ë–†–ê–ë–û–¢–ö–ò –í–´–ë–†–û–°–û–í")
print("="*60)

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
print(f"\n–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(f"–†–∞–∑–º–µ—Ä: {len(df)}")
print(f"–°—Ä–µ–¥–Ω–µ–µ: {df['–∑–∞—Ä–ø–ª–∞—Ç–∞'].mean():,.0f}")
print(f"–ú–µ–¥–∏–∞–Ω–∞: {df['–∑–∞—Ä–ø–ª–∞—Ç–∞'].median():,.0f}")
print(f"Std: {df['–∑–∞—Ä–ø–ª–∞—Ç–∞'].std():,.0f}")

# –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã
methods = ['remove', 'cap', 'transform', 'separate']
results = {}

for method in methods:
    print(f"\n" + "-"*40)
    df_processed = handle_outliers(df, '–∑–∞—Ä–ø–ª–∞—Ç–∞', method=method)
    results[method] = df_processed
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    if method != 'transform':
        print(f"–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏:")
        print(f"–†–∞–∑–º–µ—Ä: {len(df_processed)}")
        print(f"–°—Ä–µ–¥–Ω–µ–µ: {df_processed['–∑–∞—Ä–ø–ª–∞—Ç–∞'].mean():,.0f}")
        print(f"Std: {df_processed['–∑–∞—Ä–ø–ª–∞—Ç–∞'].std():,.0f}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
fig, axes = plt.subplots(2, 2, figsize=(12, 8))
methods_plot = ['remove', 'cap', 'transform', 'separate']

for idx, method in enumerate(methods_plot):
    ax = axes[idx // 2, idx % 2]
    
    if method == 'transform':
        results[method]['–∑–∞—Ä–ø–ª–∞—Ç–∞_log'].hist(bins=30, ax=ax, edgecolor='black')
        ax.set_xlabel('log(–∑–∞—Ä–ø–ª–∞—Ç–∞)')
    elif method == 'separate':
        normal = results[method][results[method]['–∑–∞—Ä–ø–ª–∞—Ç–∞_is_outlier'] == 0]
        outliers = results[method][results[method]['–∑–∞—Ä–ø–ª–∞—Ç–∞_is_outlier'] == 1]
        ax.hist([normal['–∑–∞—Ä–ø–ª–∞—Ç–∞'], outliers['–∑–∞—Ä–ø–ª–∞—Ç–∞']], 
                bins=30, label=['–ù–æ—Ä–º–∞–ª—å–Ω—ã–µ', '–í—ã–±—Ä–æ—Å—ã'], 
                edgecolor='black', alpha=0.7)
        ax.legend()
        ax.set_xlabel('–ó–∞—Ä–ø–ª–∞—Ç–∞')
    else:
        results[method]['–∑–∞—Ä–ø–ª–∞—Ç–∞'].hist(bins=30, ax=ax, edgecolor='black')
        ax.set_xlabel('–ó–∞—Ä–ø–ª–∞—Ç–∞')
    
    ax.set_title(f'–ú–µ—Ç–æ–¥: {method}')
    ax.set_ylabel('–ß–∞—Å—Ç–æ—Ç–∞')

plt.tight_layout()
plt.show()
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö (TODO)
----

–ü–æ–º–∏–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–±—Ä–æ—Å–æ–≤, –≤ –¥–∞–Ω–Ω—ã—Ö –º–æ–≥—É—Ç –±—ã—Ç—å —è–≤–Ω—ã–µ –æ—à–∏–±–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

---
**üìã –ü—Ä–∏–º–µ—Ä.** –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö.

```python
def detect_and_fix_errors(df):
    """
    –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö
    """
    df_fixed = df.copy()
    errors_found = []
    
    print("="*60)
    print("–ü–û–ò–°–ö –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö")
    print("="*60)
    
    # 1. –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≥–¥–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å
    for col in df_fixed.select_dtypes(include=[np.number]).columns:
        if col in ['–≤–æ–∑—Ä–∞—Å—Ç', '–∑–∞—Ä–ø–ª–∞—Ç–∞', '–ø–ª–æ—â–∞–¥—å', '—Ü–µ–Ω–∞', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ']:
            negative_mask = df_fixed[col] < 0
            if negative_mask.any():
                errors_found.append(f"{col}: {negative_mask.sum()} –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π")
                # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º: –±–µ—Ä–µ–º –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                df_fixed.loc[negative_mask, col] = df_fixed.loc[negative_mask, col].abs()
    
    # 2. –ù–µ–≤–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    if '–≤–æ–∑—Ä–∞—Å—Ç' in df_fixed.columns:
        impossible_age = (df_fixed['–≤–æ–∑—Ä–∞—Å—Ç'] < 0) | (df_fixed['–≤–æ–∑—Ä–∞—Å—Ç'] > 120)
        if impossible_age.any():
            errors_found.append(f"–≤–æ–∑—Ä–∞—Å—Ç: {impossible_age.sum()} –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π")
            # –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ –º–µ–¥–∏–∞–Ω—É
            df_fixed.loc[impossible_age, '–≤–æ–∑—Ä–∞—Å—Ç'] = df_fixed['–≤–æ–∑—Ä–∞—Å—Ç'].median()
    
    # 3. –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    for col in df_fixed.select_dtypes(include=['object']).columns:
        if df_fixed[col].notna().any():
            # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
            df_fixed[col] = df_fixed[col].str.strip()
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ —á–∏—Å–ª–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—è—Ö
            if col in ['–∏–º—è', '–≥–æ—Ä–æ–¥', '—Ä–∞–π–æ–Ω']:
                has_numbers = df_fixed[col].str.contains(r'\d', na=False)
                if has_numbers.any():
                    errors_found.append(f"{col}: {has_numbers.sum()} –∑–Ω–∞—á–µ–Ω–∏–π —Å —Ü–∏—Ñ—Ä–∞–º–∏")
    
    # 4. –°–º–µ—à–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
    for col in df_fixed.columns:
        if df_fixed[col].dtype == 'object':
            # –ü—ã—Ç–∞–µ–º—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —á–∏—Å–ª–∞, –µ—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ
            try:
                numeric_values = pd.to_numeric(df_fixed[col], errors='coerce')
                if numeric_values.notna().sum() > len(df_fixed) * 0.5:
                    errors_found.append(f"{col}: —Å–º–µ—à–∞–Ω–Ω—ã–π —Ç–∏–ø (—Ç–µ–∫—Å—Ç/—á–∏—Å–ª–∞)")
                    df_fixed[col] = numeric_values
            except:
                pass
    
    # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    if errors_found:
        print("\nüîß –ù–∞–π–¥–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏:")
        for error in errors_found:
            print(f"  ‚Ä¢ {error}")
    else:
        print("\n‚úÖ –Ø–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ")
    
    return df_fixed

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –æ—à–∏–±–∫–∞–º–∏
df_with_errors = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': [25, -5, 150, 35, 40],  # –ï—Å—Ç—å –æ—à–∏–±–∫–∏
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': [50000, -60000, 70000, 80000, 90000],  # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞
    '–≥–æ—Ä–æ–¥': ['–ú–æ—Å–∫–≤–∞', '–°–ü–±123', '  –ö–∞–∑–∞–Ω—å  ', '–ú–æ—Å–∫–≤–∞', '–°–ü–±'],  # –¶–∏—Ñ—Ä—ã –∏ –ø—Ä–æ–±–µ–ª—ã
    '–æ–ø—ã—Ç': ['5', '3', '–¥–≤–∞', '10', '7']  # –°–º–µ—à–∞–Ω–Ω—ã–π —Ç–∏–ø
})

print("–î–∞–Ω–Ω—ã–µ —Å –æ—à–∏–±–∫–∞–º–∏:")
print(df_with_errors)

# –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—à–∏–±–∫–∏
df_fixed = detect_and_fix_errors(df_with_errors)

print("\n–î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:")
print(df_fixed)
print("\n–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:")
print(df_fixed.dtypes)
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏ –∏ –æ—à–∏–±–∫–∞–º–∏ (TODO)
----

| –°–∏—Ç—É–∞—Ü–∏—è | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|----------|---------------------|-------------|
| **–Ø–≤–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤–≤–æ–¥–∞** | –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ—Ä—Ç—è—Ç –º–æ–¥–µ–ª—å |
| **–†–µ–¥–∫–∏–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** | –û—Å—Ç–∞–≤–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä | –í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö |
| **–í—ã–±—Ä–æ—Å—ã –≤ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π** | –û—Å—Ç–æ—Ä–æ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–ª–∏ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω–æ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ |
| **–ú–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –≤—ã–±—Ä–æ—Å—ã** | Isolation Forest –∏–ª–∏ LOF | –û–¥–Ω–æ–º–µ—Ä–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å |
| **–ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±—Ä–æ—Å–æ–≤ (>10%)** | –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω, –≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å | –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω |

**–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±—Ä–æ—Å–æ–≤:**

1. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å –≥—Ä–∞—Ñ–∏–∫–æ–≤ (boxplot, scatter, –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã)
2. **–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—Ä–æ–¥—ã** ‚Äî –ø–æ–Ω—è—Ç—å, –æ—Ç–∫—É–¥–∞ –≤–∑—è–ª–∏—Å—å –≤—ã–±—Ä–æ—Å—ã
3. **–í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è** ‚Äî IQR –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤, ML –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å —ç–∫—Å–ø–µ—Ä—Ç–æ–º** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å –¥–æ–º–µ–Ω–Ω—ã–º —ç–∫—Å–ø–µ—Ä—Ç–æ–º
5. **–í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ/–∑–∞–º–µ–Ω–∞/—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è/–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
6. **–û—Ü–µ–Ω–∫–∞ –≤–ª–∏—è–Ω–∏—è** ‚Äî —Å—Ä–∞–≤–Ω–∏—Ç—å –º–æ–¥–µ–ª–∏ –¥–æ –∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
7. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∑–∞–ø–∏—Å–∞—Ç—å, —á—Ç–æ –∏ –ø–æ—á–µ–º—É –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

@NB(`–õ—É—á—à–µ –æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –≤—ã–±—Ä–æ—Å, —á–µ–º —É–¥–∞–ª–∏—Ç—å –≤–∞–∂–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ. –í —Å–ª—É—á–∞–µ —Å–æ–º–Ω–µ–Ω–∏–π ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –¥–≤–µ –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏ –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.`)

---
### –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
---

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –ø–æ—ç—Ç–æ–º—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç.

> **üè™ –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω.** –£ –≤–∞—Å –µ—Å—Ç—å —Ç–æ–≤–∞—Ä—ã —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", "–û–¥–µ–∂–¥–∞", "–ö–Ω–∏–≥–∏". –ö–æ–º–ø—å—é—Ç–µ—Ä –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —Å–ª–æ–≤–∞ ‚Äî –µ–º—É –Ω—É–∂–Ω—ã —á–∏—Å–ª–∞. –ù–æ –µ—Å–ª–∏ –º—ã –ø—Ä–æ—Å—Ç–æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —á–∏—Å–ª–æ: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞"$=1$, "–û–¥–µ–∂–¥–∞"$=2$, "–ö–Ω–∏–≥–∏"$=3$, —Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–µ—Ç –æ—à–∏–±–æ—á–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –∫–Ω–∏–≥–∏ "–≤–∞–∂–Ω–µ–µ" —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏ –≤ 3 —Ä–∞–∑–∞! –ü–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è.

**–¢–∏–ø—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

- **–ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ** ‚Äî –±–µ–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞. –ù–∞–ø—Ä–∏–º–µ—Ä: —Ü–≤–µ—Ç, –≥–æ—Ä–æ–¥, –ø—Ä–æ—Ñ–µ—Å—Å–∏—è.
- **–ü–æ—Ä—è–¥–∫–æ–≤—ã–µ** ‚Äî —Å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–æ—Ä—è–¥–∫–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä: —Ä–∞–∑–º–µ—Ä (XS, S, M, L, XL), –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (—à–∫–æ–ª—å–Ω–æ–µ, —Å—Ä–µ–¥–Ω–µ–µ, –≤—ã—Å—à–µ–µ), —Ä–µ–π—Ç–∏–Ω–≥ (‚òÖ, ‚òÖ‚òÖ, ‚òÖ‚òÖ‚òÖ).

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:**

- Label Encoding
- One-Hot Encoding
- Targer Encoding
- Binary Encoding

#### Label Encoding

**Label Encoding** ‚Äî —ç—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ —á–∏—Å–ª–∞. –ö–∞–∂–¥–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –æ—Ç $0$ –¥–æ $N-1$, –≥–¥–µ $N$ ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π. –≠—Ç–æ –∫–∞–∫ –µ—Å–ª–∏ –±—ã –º—ã –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–ª–∏ –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É.

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**

–°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞. –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏—Ö (–æ–±—ã—á–Ω–æ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –∏–ª–∏ –∑–∞–¥–∞–Ω–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É). –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –∫–∞–∂–¥–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é —á–∏—Å–ª–æ: –ø–µ—Ä–≤–æ–º—É ‚Äî $0$, –≤—Ç–æ—Ä–æ–º—É ‚Äî $1$, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Äî –∫–æ–≥–¥–∞ –µ—Å—Ç—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è (—Ä–∞–∑–º–µ—Ä—ã –æ–¥–µ–∂–¥—ã, —É—Ä–æ–≤–Ω–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, —Ä–µ–π—Ç–∏–Ω–≥–∏).
- –î–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ä–µ–≤—å–µ–≤ ‚Äî –æ–Ω–∏ –º–æ–≥—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ.
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ ‚Äî —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞.

**‚ö†Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

- –î–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç –ª–æ–∂–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å, —á—Ç–æ "–ú–æ—Å–∫–≤–∞" ($0$) < "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥" ($1$) < "–ö–∞–∑–∞–Ω—å" ($2$).
- –í–≤–æ–¥–∏—Ç –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ –ª–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏ ‚Äî –æ–Ω–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É—é—Ç —á–∏—Å–ª–∞ –∫–∞–∫ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —à–∫–∞–ª—É.

**üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç:**
–í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —è–≤–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É!

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –î–≤–∞ —Å–ø–æ—Å–æ–±–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è Label Encoding.~~</summary>

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

from sklearn.preprocessing import LabelEncoder
import pandas as pd

# –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ - –ø–æ—Ä—è–¥–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
education_data = pd.DataFrame({
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': ['–°—Ä–µ–¥–Ω–µ–µ', '–í—ã—Å—à–µ–µ', '–®–∫–æ–ª—å–Ω–æ–µ', '–í—ã—Å—à–µ–µ', '–°—Ä–µ–¥–Ω–µ–µ', '–ö–∞–Ω–¥–∏–¥–∞—Ç –Ω–∞—É–∫']
})

# –°–æ–∑–¥–∞—ë–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
education_order = ['–®–∫–æ–ª—å–Ω–æ–µ', '–°—Ä–µ–¥–Ω–µ–µ', '–í—ã—Å—à–µ–µ', '–ö–∞–Ω–¥–∏–¥–∞—Ç –Ω–∞—É–∫']

# –°–ø–æ—Å–æ–± 1: –†—É—á–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–æ—Ä—è–¥–∫–æ–º
education_mapping = {edu: i for i, edu in enumerate(education_order)}
education_data['–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_–∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ'] = education_data['–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'].map(education_mapping)

print("–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:")
print(education_data)
print(f"\n–ü–æ—Ä—è–¥–æ–∫: {education_order}")

# –°–ø–æ—Å–æ–± 2: LabelEncoder (–Ω–æ –æ–Ω –¥–∞—ë—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫!)
label_encoder = LabelEncoder()
education_data['–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_label_encoder'] = label_encoder.fit_transform(education_data['–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'])

print("\nLabelEncoder (–ø–æ—Ä—è–¥–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º!):")
print(education_data)
print(f"–ö–ª–∞—Å—Å—ã LabelEncoder: {label_encoder.classes_}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

<details>
<summary>~~**‚ö†Ô∏è –ß–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Label Encoding –¥–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.~~</summary>

```python
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û –¥–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö!

#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

from sklearn.preprocessing import LabelEncoder
import pandas as pd


cities = pd.DataFrame({'–≥–æ—Ä–æ–¥': ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ö–∞–∑–∞–Ω—å']})
label_encoder = LabelEncoder()
cities['–≥–æ—Ä–æ–¥_–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ'] = label_encoder.fit_transform(cities['–≥–æ—Ä–æ–¥'])

print("–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Label Encoding:")
print(cities)
print("–ü—Ä–æ–±–ª–µ–º–∞: –∞–ª–≥–æ—Ä–∏—Ç–º –º–æ–∂–µ—Ç –ø–æ–¥—É–º–∞—Ç—å, —á—Ç–æ –°–ü–± > –ú–æ—Å–∫–≤—ã –≤ 2 —Ä–∞–∑–∞!")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

#### One-Hot Encoding

**One-Hot Encoding** —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–∏–Ω–∞—Ä–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü –¥–ª—è –∫–∞–∂–¥–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –í –∫–∞–∂–¥–æ–º —Å—Ç–æ–ª–±—Ü–µ —Å—Ç–∞–≤–∏—Ç—Å—è $1$, –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∏ $0$ ‚Äî –µ—Å–ª–∏ –Ω–µ—Ç. –ù–∞–∑–≤–∞–Ω–∏–µ "one-hot" –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –±–∏—Ç "–≥–æ—Ä—è—á–∏–π" (—Ä–∞–≤–µ–Ω $1$) –≤ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**

–î–ª—è –∫–∞–∂–¥–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü.
–ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Äî —Å—Ç–∞–≤–∏–º $1$, –∏–Ω–∞—á–µ $0$.
–í –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü —Å–æ–¥–µ—Ä–∂–∏—Ç $1$, –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî $0$.

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞.
- –ö–æ–≥–¥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ–º–Ω–æ–≥–æ ($< 10$-$15$) ‚Äî –∏–Ω–∞—á–µ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–æ–≤.
- –î–ª—è –ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π ‚Äî –æ–Ω–∏ –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ç–∞–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å ‚Äî –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –≤–ª–∏—è–Ω–∏–µ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

**‚ö†Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

- –ü—Ä–æ–∫–ª—è—Ç–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ ‚Äî $100$ –∫–∞—Ç–µ–≥–æ—Ä–∏–π $= 100$ –Ω–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤!
- –†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö ‚Äî –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π –±—É–¥—É—Ç –Ω—É–ª—è–º–∏.
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –Ω–æ–≤—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ ‚Äî —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ –±—ã–ª–æ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏?
- –ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å ‚Äî —Å—Ç–æ–ª–±—Ü—ã –ª–∏–Ω–µ–π–Ω–æ –∑–∞–≤–∏—Å–∏–º—ã (–º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —É–¥–∞–ª–∏–≤ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü)

**üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç:**

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `drop='first'` –≤ sklearn, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ —É–¥–∞–ª–∏—Ç –æ–¥–∏–Ω –∏–∑ —Å—Ç–æ–ª–±—Ü–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ OneHotEncoder —Å –ø–æ–º–æ—â—å—é pandas –∏ sklearn.~~</summary>

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")


import pandas as pd
from sklearn.preprocessing import OneHotEncoder

cities_data = pd.DataFrame({
    '–∫–ª–∏–µ–Ω—Ç': ['–ê–Ω–Ω–∞', '–ë–æ—Ä–∏—Å', '–í–µ—Ä–∞', '–ì–ª–µ–±'],
    '–≥–æ—Ä–æ–¥': ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ú–æ—Å–∫–≤–∞', '–ö–∞–∑–∞–Ω—å'],
    '–ø—Ä–æ–¥–∞–∂–∏': [100, 150, 80, 120]
})

print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(cities_data)

# –°–ø–æ—Å–æ–± 1: pandas get_dummies (–ø—Ä–æ—â–µ)
cities_encoded = pd.get_dummies(cities_data, columns=['–≥–æ—Ä–æ–¥'], prefix='–≥–æ—Ä–æ–¥')
print("\n–° –ø–æ–º–æ—â—å—é pandas get_dummies:")
print(cities_encoded)

# –°–ø–æ—Å–æ–± 2: sklearn OneHotEncoder (–±–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è)
encoder = OneHotEncoder(sparse_output=False, prefix_sep='_')
city_encoded = encoder.fit_transform(cities_data[['–≥–æ—Ä–æ–¥']])
city_columns = [f"–≥–æ—Ä–æ–¥_{cat}" for cat in encoder.categories_[0]]

city_df = pd.DataFrame(city_encoded, columns=city_columns)
result = pd.concat([cities_data[['–∫–ª–∏–µ–Ω—Ç', '–ø—Ä–æ–¥–∞–∂–∏']], city_df], axis=1)

print("\n–° –ø–æ–º–æ—â—å—é sklearn OneHotEncoder:")
print(result)
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–æ–∫–ª—è—Ç–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ OneHotEncoder.~~</summary>

```python
# –ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Ä–∞—Å—Ç—ë—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
import pandas as pd
import numpy as np

# –î–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π
small_categories = pd.DataFrame({
    '—Ä–∞–∑–º–µ—Ä': ['S', 'M', 'L'] * 100  # 3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
})

large_categories = pd.DataFrame({
    '–≥–æ—Ä–æ–¥': [f'–ì–æ—Ä–æ–¥_{i}' for i in range(50)] * 6  # 50 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
})

print("–ò—Å—Ö–æ–¥–Ω—ã–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏:")
print(f"–ú–∞–ª–µ–Ω—å–∫–∏–π –Ω–∞–±–æ—Ä: {small_categories.shape}")
print(f"–ë–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä: {large_categories.shape}")

# –ü—Ä–∏–º–µ–Ω—è–µ–º One-Hot
small_encoded = pd.get_dummies(small_categories)
large_encoded = pd.get_dummies(large_categories)

print("\n–ü–æ—Å–ª–µ One-Hot Encoding:")
print(f"–ú–∞–ª–µ–Ω—å–∫–∏–π –Ω–∞–±–æ—Ä: {small_encoded.shape}")
print(f"–ë–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä: {large_encoded.shape}")
print(f"–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏: {large_encoded.shape[1] / large_categories.shape[1]:.1f}x")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)
</details>

<br>

#### Target Encoding

**Target Encoding** (—Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–∫ Mean Encoding) –∑–∞–º–µ–Ω—è–µ—Ç –∫–∞–∂–¥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π –∏ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø—Ä—è–º–æ –≤ –ø—Ä–∏–∑–Ω–∞–∫–µ.

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:** 

–ì—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
–î–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –≤—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.
–ó–∞–º–µ–Ω—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –Ω–∞ —ç—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
–ü—Ä–∏–º–µ–Ω—è–µ–º —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –∫–æ–≥–¥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—á–µ–Ω—å –º–Ω–æ–≥–æ (–≥–æ—Ä–æ–¥–∞, –ø–æ—á—Ç–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã).
- –ö–æ–≥–¥–∞ –µ—Å—Ç—å —Å–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å —Å —Ç–∞—Ä–≥–µ—Ç–æ–º ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ö–æ—Ä–æ—à–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é.
- –î–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ –±—É—Å—Ç–∏–Ω–≥–∞ ‚Äî —ç—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ç–∞–∫–∏–º –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

**‚ö†Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

- –†–∏—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π.
- –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ø—Ä–∏–∑–Ω–∞–∫–∏.
- –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Ä–µ–¥–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π ‚Äî –æ–¥–Ω–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ä–µ–¥–Ω–µ–µ.
- –¢—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ‚Äî –Ω—É–∂–Ω–∞ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–ª–∏ out-of-fold –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ.

**üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç:**
–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—Ä–∏ Target Encoding! –ö–æ–¥–∏—Ä—É–π—Ç–µ –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ, –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π. –î–ª—è —Ä–µ–¥–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ (smoothing) –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É —Å—Ä–µ–¥–Ω–µ–º—É.

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** Target Encoding —Å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ–º).~~</summary>

```python
def target_encode_with_smoothing(df, col, target, alpha=5):
    """
    alpha - –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è (—á–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º –±–ª–∏–∂–µ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É —Å—Ä–µ–¥–Ω–µ–º—É)
    """
    global_mean = df[target].mean()
    agg = df.groupby(col)[target].agg(['count', 'mean'])
    
    # –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ: weighted average –º–µ–∂–¥—É —Å—Ä–µ–¥–Ω–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Å—Ä–µ–¥–Ω–∏–º
    smooth = (agg['count'] * agg['mean'] + alpha * global_mean) / (agg['count'] + alpha)
    
    return df[col].map(smooth)
```
</details>

<br>

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã –ø–æ —Ä–µ–≥–∏–æ–Ω—É: Target vs One-Hot.~~</summary>

```python
# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã –ø–æ —Ä–µ–≥–∏–æ–Ω—É
import pandas as pd
import numpy as np

np.random.seed(42)
regions = ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', '–ö–∞–∑–∞–Ω—å', 
           '–†–æ—Å—Ç–æ–≤', '–£—Ñ–∞', '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫', '–í–æ—Ä–æ–Ω–µ–∂', '–ü–µ—Ä–º—å']

# –°–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ: –≤ –ú–æ—Å–∫–≤–µ –∏ –°–ü–± –∑–∞—Ä–ø–ª–∞—Ç—ã –≤—ã—à–µ
data = []
for _ in range(1000):
    region = np.random.choice(regions)
    if region in ['–ú–æ—Å–∫–≤–∞', '–°–ü–±']:
        base_salary = 100000
    elif region in ['–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', '–ö–∞–∑–∞–Ω—å']:
        base_salary = 60000
    else:
        base_salary = 45000
    
    salary = base_salary + np.random.normal(0, 15000)
    data.append({'—Ä–µ–≥–∏–æ–Ω': region, '–∑–∞—Ä–ø–ª–∞—Ç–∞': max(salary, 20000)})

df = pd.DataFrame(data)

print("–°—Ä–µ–¥–Ω–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º:")
region_means = df.groupby('—Ä–µ–≥–∏–æ–Ω')['–∑–∞—Ä–ø–ª–∞—Ç–∞'].mean().sort_values(ascending=False)
print(region_means.round())

# Target Encoding
target_encoded = df['—Ä–µ–≥–∏–æ–Ω'].map(region_means)
df['—Ä–µ–≥–∏–æ–Ω_target_encoded'] = target_encoded

print("\n–ü—Ä–∏–º–µ—Ä Target Encoding:")
sample = df.sample(10)
print(sample[['—Ä–µ–≥–∏–æ–Ω', '–∑–∞—Ä–ø–ª–∞—Ç–∞', '—Ä–µ–≥–∏–æ–Ω_target_encoded']])

# –°—Ä–∞–≤–Ω–∏–º —Å One-Hot
one_hot_size = len(df['—Ä–µ–≥–∏–æ–Ω'].unique())
print(f"\n–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏:")
print(f"Target Encoding: 1 —Å—Ç–æ–ª–±–µ—Ü")
print(f"One-Hot: {one_hot_size} —Å—Ç–æ–ª–±—Ü–æ–≤")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)
</details>

<br>

#### Binary Encoding

**Binary Encoding** ‚Äî —ç—Ç–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É Label Encoding –∏ One-Hot Encoding. –°–Ω–∞—á–∞–ª–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω—É–º–µ—Ä—É—é—Ç—Å—è (–∫–∞–∫ –≤ Label Encoding), –∑–∞—Ç–µ–º —ç—Ç–∏ —á–∏—Å–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ –¥–≤–æ–∏—á–Ω–æ–º –≤–∏–¥–µ, –∏ –∫–∞–∂–¥—ã–π –±–∏—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å—Ç–æ–ª–±—Ü–æ–º. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å $N$ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ª—å–∫–æ $log‚ÇÇ(N)$ —Å—Ç–æ–ª–±—Ü–æ–≤.

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:** 

–ü—Ä–∏–º–µ–Ω—è–µ–º Label Encoding (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí —á–∏—Å–ª–∞). –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —á–∏—Å–ª–∞ –≤ –¥–≤–æ–∏—á–Ω—É—é —Å–∏—Å—Ç–µ–º—É. –ö–∞–∂–¥—ã–π —Ä–∞–∑—Ä—è–¥ –¥–≤–æ–∏—á–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å—Ç–æ–ª–±—Ü–æ–º. –ü–æ–ª—É—á–∞–µ–º $log‚ÇÇ(N)$ –Ω–æ–≤—ã—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ü—Ä–∏ —Å—Ä–µ–¥–Ω–µ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ ‚Äî $15$-$100$ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ö–æ–≥–¥–∞ One-Hot —Å–ª–∏—à–∫–æ–º —Ä–∞—Å—Ç–æ—á–∏—Ç–µ–ª–µ–Ω ‚Äî —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ –≤–∞–∂–Ω–∞
- –î–ª—è –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ ‚Äî –æ–Ω–∏ –º–æ–≥—É—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í –∑–∞–¥–∞—á–∞—Ö —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ ‚Äî –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

**‚ö†Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

- –ü–æ—Ç–µ—Ä—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ ‚Äî —Å–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∫–∞–∂–¥—ã–π –±–∏—Ç
- –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–æ—Ö–æ–∂–∏–º–∏ –±–∏—Ç–∞–º–∏ –º–æ–≥—É—Ç –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—Ç—å—Å—è –∫–∞–∫ –ø–æ—Ö–æ–∂–∏–µ
- –ù–µ –¥–ª—è –≤—Å–µ—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ ‚Äî –ª–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ö—É–∂–µ
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ø–æ—Ä—è–¥–∫–∞ ‚Äî —Ä–∞–∑–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ Label Encoding –¥–∞—Å—Ç —Ä–∞–∑–Ω—ã–µ –±–∏—Ç—ã

**üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç:**
Binary Encoding –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, –∫–æ–≥–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Å—Ç—Ä–∞–Ω–∞ ‚Üí —Ä–µ–≥–∏–æ–Ω ‚Üí –≥–æ—Ä–æ–¥), —Ç–∞–∫ –∫–∞–∫ –ø–æ—Ö–æ–∂–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–ª—É—á–∞—Ç –ø–æ—Ö–æ–∂–∏–µ –±–∏—Ç–æ–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.

| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π | One-Hot —Å—Ç–æ–ª–±—Ü–æ–≤ | Binary —Å—Ç–æ–ª–±—Ü–æ–≤ | –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ |
|---------------------|------------------|-----------------|-----------------|
| $8$                   | $8$                | $3$               | $62.5\%$           |
| $32$                  | $32$               | $5$               | $84.4\%$           |
| $100$                 | $100$              | $7$               | $93\%$             |
| $1000$                | $1000$             | $10$              | $99\%$             |

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ $50$-—Ç–∏ —Å—Ç—Ä–∞–Ω: Binary vs One-Hot.~~</summary>

–†–µ–∞–ª–∏–∑—É–µ–º Binary Encoding –≤—Ä—É—á–Ω—É—é –∏ —Å—Ä–∞–≤–Ω–∏–º —Å –±–∏–±–ª–∏–æ—Ç–µ—á–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π `BinaryEncoder`.

–î–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—É—é –≤–µ—Ä—Å–∏—é, –æ—Å—Ç–∞–≤–ª—è—è —Ä—É—á–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª–µ–π.

–†–µ–∞–ª–∏–∑—É–µ–º Binary Encoding –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è $50$ —Å—Ç—Ä–∞–Ω (–≤—Ä—É—á–Ω—É—é –∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏), –∞ —Ç–∞–∫–∂–µ —Å—Ä–∞–≤–Ω–∏–º –∫–∞–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞–º —É–¥–∞–ª–æ—Å—å —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å One-Hot Encoding.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import category_encoders
except ImportError:
    install_package("category_encoders")

import pandas as pd
import numpy as np
import math
from category_encoders import BinaryEncoder

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ - 50 —Å—Ç—Ä–∞–Ω
np.random.seed(42)
countries = ['–°–®–ê', '–ö–∏—Ç–∞–π', '–Ø–ø–æ–Ω–∏—è', '–ì–µ—Ä–º–∞–Ω–∏—è', '–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è',
             '–§—Ä–∞–Ω—Ü–∏—è', '–ò–Ω–¥–∏—è', '–ë—Ä–∞–∑–∏–ª–∏—è', '–ò—Ç–∞–ª–∏—è', '–ö–∞–Ω–∞–¥–∞',
             '–Æ–∂–Ω–∞—è –ö–æ—Ä–µ—è', '–†–æ—Å—Å–∏—è', '–ê–≤—Å—Ç—Ä–∞–ª–∏—è', '–ò—Å–ø–∞–Ω–∏—è', '–ú–µ–∫—Å–∏–∫–∞',
             '–ò–Ω–¥–æ–Ω–µ–∑–∏—è', '–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã', '–°–∞—É–¥–æ–≤—Å–∫–∞—è –ê—Ä–∞–≤–∏—è', '–¢—É—Ä—Ü–∏—è', '–®–≤–µ–π—Ü–∞—Ä–∏—è',
             '–ê—Ä–≥–µ–Ω—Ç–∏–Ω–∞', '–®–≤–µ—Ü–∏—è', '–ü–æ–ª—å—à–∞', '–ë–µ–ª—å–≥–∏—è', '–¢–∞–∏–ª–∞–Ω–¥',
             '–ò—Ä–∞–Ω', '–ê–≤—Å—Ç—Ä–∏—è', '–ù–æ—Ä–≤–µ–≥–∏—è', '–û–ê–≠', '–ò–∑—Ä–∞–∏–ª—å',
             '–Æ–ê–†', '–§–∏–Ω–ª—è–Ω–¥–∏—è', '–î–∞–Ω–∏—è', '–°–∏–Ω–≥–∞–ø—É—Ä', '–ú–∞–ª–∞–π–∑–∏—è',
             '–§–∏–ª–∏–ø–ø–∏–Ω—ã', '–ö–æ–ª—É–º–±–∏—è', '–ï–≥–∏–ø–µ—Ç', '–ß–∏–ª–∏', '–ü–∞–∫–∏—Å—Ç–∞–Ω',
             '–ò—Ä–ª–∞–Ω–¥–∏—è', '–ì—Ä–µ—Ü–∏—è', '–ü–æ—Ä—Ç—É–≥–∞–ª–∏—è', '–í—å–µ—Ç–Ω–∞–º', '–ß–µ—Ö–∏—è',
             '–ü–µ—Ä—É', '–ù–æ–≤–∞—è –ó–µ–ª–∞–Ω–¥–∏—è', '–†—É–º—ã–Ω–∏—è', '–ë–∞–Ω–≥–ª–∞–¥–µ—à', '–í–µ–Ω–≥—Ä–∏—è']

df = pd.DataFrame({'—Å—Ç—Ä–∞–Ω–∞': np.random.choice(countries, 200)})

print(f"–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω: {len(df['—Å—Ç—Ä–∞–Ω–∞'].unique())}\n")
print(df['—Å—Ç—Ä–∞–Ω–∞'].value_counts().head())

# 1. –†—É—á–Ω–æ–π Binary Encoding
print("\n=== –†—É—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Binary Encoding ===")

# Label Encoding
country_codes = {country: idx for idx, country in enumerate(df['—Å—Ç—Ä–∞–Ω–∞'].unique())}
df['country_code'] = df['—Å—Ç—Ä–∞–Ω–∞'].map(country_codes)

# –í—ã—á–∏—Å–ª—è–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç
n_bits = math.ceil(math.log2(len(country_codes)))

# –°–æ–∑–¥–∞–µ–º –±–∏–Ω–∞—Ä–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã
for bit in range(n_bits):
    df[f'bit_{bit}'] = (df['country_code'].values >> bit) & 1

binary_cols = [f'bit_{bit}' for bit in range(n_bits)]
print("\n–ü—Ä–∏–º–µ—Ä —Ä—É—á–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:")
print(df[['—Å—Ç—Ä–∞–Ω–∞'] + binary_cols].drop_duplicates().head(5))

# 2. Binary Encoding —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
print("\n=== –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BinaryEncoder –∏–∑ category_encoders ===")

encoder = BinaryEncoder(cols=['—Å—Ç—Ä–∞–Ω–∞'])
df_encoded = encoder.fit_transform(df['—Å—Ç—Ä–∞–Ω–∞'])

print("\n–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É:")
print(pd.concat([
    df['—Å—Ç—Ä–∞–Ω–∞'], 
    df_encoded[encoder.get_feature_names_out()]
], axis=1).drop_duplicates().head(5))

# 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å One-Hot Encoding
one_hot = pd.get_dummies(df['—Å—Ç—Ä–∞–Ω–∞'])
print(f"\nOne-Hot —Å–æ–∑–¥–∞–µ—Ç {len(one_hot.columns)} —Å—Ç–æ–ª–±—Ü–æ–≤")
print(f"Binary Encoding –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ–≥–æ {n_bits} —Å—Ç–æ–ª–±—Ü–æ–≤")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)
</details>

<br>

<details>
<summary>~~–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ `BinaryEncoder` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `category_encoders`~~</summary>

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**

- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –±–∏—Ç: –°–∞–º–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç.
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: –ò–º–µ–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–Ω–µ–µ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–≤—à–∏—Ö—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

```python
encoder = BinaryEncoder(cols=['—Å—Ç—Ä–∞–Ω–∞'], handle_unknown='indicator')
```

2. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**

```python
BinaryEncoder(
    cols=None,                  # –ö–∞–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å (None - –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ)
    drop_invariant=False,       # –£–¥–∞–ª—è—Ç—å –Ω–µ–∏–∑–º–µ–Ω—è—é—â–∏–µ—Å—è —Å—Ç–æ–ª–±—Ü—ã
    return_df=True,             # –í–æ–∑–≤—Ä–∞—â–∞—Ç—å DataFrame (–Ω–µ numpy array)
    handle_unknown='value',     # –°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π ('error', 'value', 'indicator')
    handle_missing='value',     # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ ('error', 'value', 'indicator', 'return_nan')
)
```

3. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**:

```python
# –ü—Ä–∏–º–µ—Ä —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
df_with_na = df.copy()
df_with_na.loc[0, '—Å—Ç—Ä–∞–Ω–∞'] = np.nan

encoder = BinaryEncoder(handle_missing='indicator')
encoded = encoder.fit_transform(df_with_na)
```

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏**:

```python
import pickle

# –°–æ—Ö—Ä–∞–Ω—è–µ–º encoder
with open('encoder.pkl', 'wb') as f:
    pickle.dump(encoder, f)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
with open('encoder.pkl', 'rb') as f:
    loaded_encoder = pickle.load(f)
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Pipeline**:

```python
from sklearn.pipeline import Pipeline
from sklearn.ensemble import RandomForestClassifier

pipe = Pipeline([
    ('encoder', BinaryEncoder(cols=['—Å—Ç—Ä–∞–Ω–∞'])),
    ('model', RandomForestClassifier())
])
```

4. **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü**: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —á–∞—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —á–µ—Ç–Ω–æ—Å—Ç–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤—ã–º.
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞—Ç—Ä–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ —Ü–∏–∫–ª–æ–≤. –†–∞–±–æ—Ç–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å scikit-learn**: –ò–º–µ–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã `fit()`, `transform()`, `fit_transform()`. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç sklearn-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

</details>

<br>

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

| **Label Encoding** | **One-Hot Encoding** | **Target Encoding** | **Binary Encoding** |
|---|---|---|---|
| –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —á–∏—Å–ª–∞–º–∏ | –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ | –ó–∞–º–µ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è —ç—Ç–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π | –ö–æ–º–±–∏–Ω–∞—Ü–∏—è Label Encoding –∏ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ (—Ä–∞–∑—Ä—è–¥—ã –≤ —Å—Ç–æ–ª–±—Ü—ã) |
| –¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ–º | –î–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –º–∞–ª—ã–º —á–∏—Å–ª–æ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π | –î–ª—è –∑–∞–¥–∞—á —Å —á–µ—Ç–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π | –î–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é |
| + –ü—Ä–æ—Å—Ç–æ—Ç–∞<br>+ –ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö | + –£—Å—Ç—Ä–∞–Ω—è–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫<br>+ –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ | + –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π<br>+ –ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å | + –≠–∫–æ–Ω–æ–º–∏—Ç –ø–∞–º—è—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å One-Hot<br>+ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —á–∞—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ö–æ–¥—Å—Ç–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π |
| - –°–æ–∑–¥–∞–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö<br>- –ú–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –º–æ–¥–µ–ª—å –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ | - –ü—Ä–æ–∫–ª—è—Ç–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏<br>- –ü–ª–æ—Ö–æ –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é | - –†–∏—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è (–Ω—É–∂–Ω–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è)<br>- –¢—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ | - –ú–µ–Ω–µ–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å One-Hot<br>- –û—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∞—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ—Ä—è–¥–∫–æ–≤–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å |
  
@quizQuestion(`–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –¥–ª—è –Ω–∏—Ö –º–µ—Ç–æ–¥–∞–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:`)

<!-- data-randomize -->
- [(Label Encoding) (One-Hot Encoding) (Target Encoding) (Binary Encoding)]
- [ (x) ( ) ( ) ( )]  –†–∞–∑–º–µ—Ä –æ–¥–µ–∂–¥—ã (XS, S, M, L, XL)
- [ ( ) (x) ( ) ( )]  –¶–≤–µ—Ç —Ç–æ–≤–∞—Ä–∞ (–∫—Ä–∞—Å–Ω—ã–π, —Å–∏–Ω–∏–π, –∑–µ–ª—ë–Ω—ã–π)
- [ ( ) ( ) (x) ( )]  –ì–æ—Ä–æ–¥ ($50$+ –≥–æ—Ä–æ–¥–æ–≤) + –µ—Å—Ç—å —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
- [ ( ) ( ) ( ) (x)]  –ë—Ä–µ–Ω–¥ —Ç–æ–≤–∞—Ä–∞ ($100$+ –±—Ä–µ–Ω–¥–æ–≤)

**üìã –ü—Ä–∏–º–µ—Ä.** –ó–∞–∫–æ–¥–∏—Ä—É–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞.

```python
import pandas as pd
import numpy as np

# –î–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞
products = pd.DataFrame({
    '–∫–∞—Ç–µ–≥–æ—Ä–∏—è': ['–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', '–û–¥–µ–∂–¥–∞', '–ö–Ω–∏–≥–∏', '–°–ø–æ—Ä—Ç'] * 25,
    '–±—Ä–µ–Ω–¥': [f'–ë—Ä–µ–Ω–¥_{i}' for i in range(20)] * 5,  # 20 –±—Ä–µ–Ω–¥–æ–≤
    '—Ä–∞–∑–º–µ—Ä': ['XS', 'S', 'M', 'L', 'XL', '–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ'] * 16 + ['S'] * 4,
    '—Ä–µ–π—Ç–∏–Ω–≥': ['‚òÖ', '‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ'] * 20,
    '—Ü–µ–Ω–∞': np.random.randint(100, 10000, 100)
})

print("–î–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:")
print(products.head())
print("\n–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:")
for col in ['–∫–∞—Ç–µ–≥–æ—Ä–∏—è', '–±—Ä–µ–Ω–¥', '—Ä–∞–∑–º–µ—Ä', '—Ä–µ–π—Ç–∏–Ω–≥']:
    print(f"{col}: {products[col].nunique()}")

# –í–∞—à–∞ –∑–∞–¥–∞—á–∞: –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
# TODO: –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

<details>
<summary>**~~üéØ –í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ~~**</summary>

``` python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import category_encoders
except ImportError:
    install_package("category_encoders")

import pandas as pd
import numpy as np
from sklearn.preprocessing import LabelEncoder, OneHotEncoder
import category_encoders as ce  # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Binary Encoding

# –î–∞–Ω–Ω—ã–µ
products = pd.DataFrame({
    '–∫–∞—Ç–µ–≥–æ—Ä–∏—è': ['–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', '–û–¥–µ–∂–¥–∞', '–ö–Ω–∏–≥–∏', '–°–ø–æ—Ä—Ç'] * 25,
    '–±—Ä–µ–Ω–¥': [f'–ë—Ä–µ–Ω–¥_{i}' for i in range(20)] * 5,
    '—Ä–∞–∑–º–µ—Ä': ['XS', 'S', 'M', 'L', 'XL', '–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ'] * 16 + ['S'] * 4,
    '—Ä–µ–π—Ç–∏–Ω–≥': ['‚òÖ', '‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ'] * 20,
    '—Ü–µ–Ω–∞': np.random.randint(100, 10000, 100)
})

# 1. One-Hot –¥–ª—è '–∫–∞—Ç–µ–≥–æ—Ä–∏—è'
onehot_encoder = OneHotEncoder(sparse_output=False, drop='first')
category_encoded = onehot_encoder.fit_transform(products[['–∫–∞—Ç–µ–≥–æ—Ä–∏—è']])
category_columns = onehot_encoder.get_feature_names_out(['–∫–∞—Ç–µ–≥–æ—Ä–∏—è'])
products_onehot = pd.concat([
    products.drop('–∫–∞—Ç–µ–≥–æ—Ä–∏—è', axis=1),
    pd.DataFrame(category_encoded, columns=category_columns)
], axis=1)

# 2. Binary Encoding –¥–ª—è '–±—Ä–µ–Ω–¥'
binary_encoder = ce.BinaryEncoder(cols=['–±—Ä–µ–Ω–¥'])
products_encoded = binary_encoder.fit_transform(products_onehot)

# 3. Label Encoding –¥–ª—è '—Ä–∞–∑–º–µ—Ä' —Å –∑–∞–¥–∞–Ω–Ω—ã–º –ø–æ—Ä—è–¥–∫–æ–º
size_order = ['XS', 'S', 'M', 'L', 'XL', '–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ']
products_encoded['—Ä–∞–∑–º–µ—Ä'] = products_encoded['—Ä–∞–∑–º–µ—Ä'].map(
    {size: idx for idx, size in enumerate(size_order)}
)

# 4. Label Encoding –¥–ª—è '—Ä–µ–π—Ç–∏–Ω–≥' (–ø–æ—Ä—è–¥–∫–æ–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫)
rating_order = ['‚òÖ', '‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ‚òÖ', '‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ']
products_encoded['—Ä–µ–π—Ç–∏–Ω–≥'] = products_encoded['—Ä–µ–π—Ç–∏–Ω–≥'].map(
    {rating: idx+1 for idx, rating in enumerate(rating_order)}
)

print("\n–ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(products_encoded.head())
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

---

#### –ü—Ä–æ–±–ª–µ–º–∞: –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö


```python
from sklearn.preprocessing import OneHotEncoder
import pandas as pd
import numpy as np

# –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
train_cities = ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ö–∞–∑–∞–Ω—å', '–ú–æ—Å–∫–≤–∞', '–°–ü–±']
# –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω–æ–≤—ã–π –≥–æ—Ä–æ–¥!
test_cities = ['–ú–æ—Å–∫–≤–∞', '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥', '–°–ü–±']  # –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ - –Ω–æ–≤—ã–π!

train_df = pd.DataFrame({'–≥–æ—Ä–æ–¥': train_cities})
test_df = pd.DataFrame({'–≥–æ—Ä–æ–¥': test_cities})

print("–û–±—É—á–∞—é—â–∏–µ –≥–æ—Ä–æ–¥–∞:", train_df['–≥–æ—Ä–æ–¥'].unique())
print("–¢–µ—Å—Ç–æ–≤—ã–µ –≥–æ—Ä–æ–¥–∞:", test_df['–≥–æ—Ä–æ–¥'].unique())

# ‚ùå –û–±—ã—á–Ω—ã–π OneHotEncoder —É–ø–∞–¥—ë—Ç –Ω–∞ –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
try:
    encoder_bad = OneHotEncoder()
    encoder_bad.fit(train_df[['–≥–æ—Ä–æ–¥']])
    train_encoded = encoder_bad.transform(train_df[['–≥–æ—Ä–æ–¥']])
    test_encoded = encoder_bad.transform(test_df[['–≥–æ—Ä–æ–¥']])  # –û—à–∏–±–∫–∞!
except ValueError as e:
    print(f"‚ùå –û—à–∏–±–∫–∞: {e}")

# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
encoder_good = OneHotEncoder(handle_unknown='ignore')  # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
encoder_good.fit(train_df[['–≥–æ—Ä–æ–¥']])
train_encoded = encoder_good.transform(train_df[['–≥–æ—Ä–æ–¥']])
test_encoded = encoder_good.transform(test_df[['–≥–æ—Ä–æ–¥']])

print("‚úÖ –° handle_unknown='ignore' –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –≤–µ–∫—Ç–æ—Ä –Ω—É–ª–µ–π")
print(f"–†–∞–∑–º–µ—Ä train: {train_encoded.shape}, —Ä–∞–∑–º–µ—Ä test: {test_encoded.shape}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

---
### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è

> **üèÉ‚Äç‚ôÇÔ∏è –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –∑–∞–±–µ–≥**: –û–¥–∏–Ω –±–µ–≥—É–Ω –∏–∑–º–µ—Ä—è–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –≤ –∫–º/—á ($15$ –∫–º/—á), –¥—Ä—É–≥–æ–π –≤ –º/—Å ($4.2$ –º/—Å). –ï—Å–ª–∏ –Ω–µ –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è, —Ç–æ –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –≤—Ç–æ—Ä–æ–π –±–µ–≥—É–Ω –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –æ–Ω–∏ –±–µ–≥—É—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ! –ê–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è "–≤–∏–¥—è—Ç" —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–∞ –∏ –º–æ–≥—É—Ç –æ—à–∏–±–æ—á–Ω–æ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –ø–µ—Ä–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –≤–∞–∂–Ω–µ–µ –ø—Ä–æ—Å—Ç–æ –∏–∑-–∑–∞ –±–æ–ª—å—à–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∞.

–í –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ –º–Ω–æ–≥–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –º–∞—Å—à—Ç–∞–±—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –ï—Å–ª–∏ –æ–¥–Ω–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑–º–µ—Ä—è—é—Ç—Å—è –≤ —Ç—ã—Å—è—á–∞—Ö (–∑–∞—Ä–ø–ª–∞—Ç–∞), –∞ –¥—Ä—É–≥–∏–µ –≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö (–≤–æ–∑—Ä–∞—Å—Ç), —ç—Ç–æ –º–æ–∂–µ—Ç –∏—Å–∫–∞–∑–∏—Ç—å —Ä–∞–±–æ—Ç—É –º–æ–¥–µ–ª–∏.

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**

- **–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫** —Å—Ö–æ–¥–∏—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º –º–∞—Å—à—Ç–∞–±–µ
- **–ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è** (KNN, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è) –∏—Å–∫–∞–∂–∞—é—Ç—Å—è
- **–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è** –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ —à—Ç—Ä–∞—Ñ—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –±–æ–ª—å—à–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.~~</summary>

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∑–∞–¥–∞—á—É –∫—Ä–µ–¥–∏—Ç–Ω–æ–≥–æ —Å–∫–æ—Ä–∏–Ω–≥–∞, –≥–¥–µ –±–∞–Ω–∫ —Ä–µ—à–∞–µ—Ç –¥–∞–≤–∞—Ç—å –ª–∏ –∫—Ä–µ–¥–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ ($20$-$70$ –ª–µ—Ç) –∏ –¥–æ—Ö–æ–¥–∞ ($20$-$200$ —Ç—ã—Å—è—á). –ë–µ–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º KNN –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å —Ä–∞–∑–ª–∏—á–∏–µ –≤ –¥–æ—Ö–æ–¥–∞—Ö –≤ $10$ —Ç—ã—Å—è—á —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω—ã–º —Ä–∞–∑–ª–∏—á–∏—é –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –Ω–∞ $10$ –ª–µ—Ç, —á—Ç–æ –Ω–µ–≤–µ—Ä–Ω–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import pandas as pd
import numpy as np
from sklearn.neighbors import KNeighborsClassifier
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

# –°–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–∞–Ω–∫–∞
np.random.seed(42)
n = 1000

# –î–≤–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞: –≤–æ–∑—Ä–∞—Å—Ç (20-70) –∏ –¥–æ—Ö–æ–¥ (20k-200k)
age = np.random.randint(20, 71, n)
income = np.random.randint(20000, 200001, n)

# –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è: –ø–æ–ª—É—á–∏—Ç –∫—Ä–µ–¥–∏—Ç –∏–ª–∏ –Ω–µ—Ç
# –ó–∞–≤–∏—Å–∏—Ç –ò –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞, –ò –æ—Ç –¥–æ—Ö–æ–¥–∞
credit_approved = ((age > 25) & (age < 60) & (income > 50000)).astype(int)

df = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': age,
    '–¥–æ—Ö–æ–¥': income,
    '–∫—Ä–µ–¥–∏—Ç_–æ–¥–æ–±—Ä–µ–Ω': credit_approved
})

print("–ù–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:")
print(df.head())
print(f"\n–ú–∞—Å—à—Ç–∞–±—ã —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è:")
print(f"–í–æ–∑—Ä–∞—Å—Ç: {df['–≤–æ–∑—Ä–∞—Å—Ç'].min()}-{df['–≤–æ–∑—Ä–∞—Å—Ç'].max()}")
print(f"–î–æ—Ö–æ–¥: {df['–¥–æ—Ö–æ–¥'].min()}-{df['–¥–æ—Ö–æ–¥'].max()}")

# –†–∞–∑–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
X = df[['–≤–æ–∑—Ä–∞—Å—Ç', '–¥–æ—Ö–æ–¥']]
y = df['–∫—Ä–µ–¥–∏—Ç_–æ–¥–æ–±—Ä–µ–Ω']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# –ú–æ–¥–µ–ª—å KNN –ë–ï–ó –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
knn_no_scaling = KNeighborsClassifier(n_neighbors=5)
knn_no_scaling.fit(X_train, y_train)
accuracy_no_scaling = accuracy_score(y_test, knn_no_scaling.predict(X_test))

# –ú–æ–¥–µ–ª—å KNN –° –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

knn_with_scaling = KNeighborsClassifier(n_neighbors=5)
knn_with_scaling.fit(X_train_scaled, y_train)
accuracy_with_scaling = accuracy_score(y_test, knn_with_scaling.predict(X_test_scaled))

print(f"\n–¢–æ—á–Ω–æ—Å—Ç—å KNN –±–µ–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è: {accuracy_no_scaling:.3f}")
print(f"–¢–æ—á–Ω–æ—Å—Ç—å KNN —Å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º: {accuracy_with_scaling:.3f}")
print(f"–£–ª—É—á—à–µ–Ω–∏–µ: {accuracy_with_scaling - accuracy_no_scaling:.3f}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

**–í—ã–≤–æ–¥ –∏–∑ –ø—Ä–∏–º–µ—Ä–∞:** –ë–µ–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫ "–¥–æ—Ö–æ–¥" –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç –Ω–∞–¥ –ø—Ä–∏–∑–Ω–∞–∫–æ–º "–≤–æ–∑—Ä–∞—Å—Ç" –∏–∑-–∑–∞ —Ä–∞–∑–Ω–∏—Ü—ã –≤ –º–∞—Å—à—Ç–∞–±–∞—Ö (—Ç—ã—Å—è—á–∏ vs –¥–µ—Å—è—Ç–∫–∏). KNN –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç "–ø–æ—Ö–æ–∂–∏—Ö" –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –æ–±–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞ –∫ –æ–¥–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É, –ø–æ–∑–≤–æ–ª—è—è –∞–ª–≥–æ—Ä–∏—Ç–º—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Å—Ö–æ–¥—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤.

</details>

<br>

#### –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è (Z-score)

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è** (—Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞–µ–º–∞—è Z-score normalization) ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ –∏–º–µ–ª–∏ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 0 –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ 1. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—É—Ç—ë–º –≤—ã—á–∏—Ç–∞–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–∞–∂–¥–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ.

$$X_{standardized} = \frac{X - Œº}{œÉ}$$

–≥–¥–µ $Œº$ ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, $œÉ$ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ.

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- –î–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫ –º–∞—Å—à—Ç–∞–±—É (–ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è, SVM, –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏)
- –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ (L1/L2)
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—Ç–µ –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –≤—ã–±—Ä–∞—Ç—å

**‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º ‚Äî –æ–Ω–∏ —Å–∏–ª—å–Ω–æ –≤–ª–∏—è—é—Ç –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
- –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≥—Ä–∞–Ω–∏—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, [0,1])
- –ú–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.~~</summary>

–ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—é –∫ –≤–æ–∑—Ä–∞—Å—Ç—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —Å—Ä–µ–¥–Ω–µ–µ$=35$, std$=10$) –∏ –∏—Ö –∑–∞—Ä–ø–ª–∞—Ç–∞–º (—Å—Ä–µ–¥–Ω–µ–µ$=70$k, std$=20$k). –ü–æ—Å–ª–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –æ–±–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞ –±—É–¥—É—Ç –∏–º–µ—Ç—å —Å—Ä–µ–¥–Ω–µ–µ$‚âà0$ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ$‚âà1$. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º —Ä–∞–≤–Ω–æ—Ü–µ–Ω–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –æ–±–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è ‚Äî —Å–∞–º—ã–π —Å—Ç–∞—Ä—à–∏–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Å–∞–º—ã–º —Å—Ç–∞—Ä—à–∏–º –∏ –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

from sklearn.preprocessing import StandardScaler
import pandas as pd
import numpy as np

# –°–æ–∑–¥–∞—ë–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
np.random.seed(42)
ages = np.random.normal(35, 10, 1000)  # —Å—Ä–µ–¥–Ω–µ–µ=35, —Å—Ç–¥=10
salaries = np.random.normal(70000, 20000, 1000)  # —Å—Ä–µ–¥–Ω–µ–µ=70k, —Å—Ç–¥=20k

df = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': ages,
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': salaries
})

print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(df.describe())

# –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—é
scaler = StandardScaler()
df_scaled = pd.DataFrame(
    scaler.fit_transform(df),
    columns=['–≤–æ–∑—Ä–∞—Å—Ç_scaled', '–∑–∞—Ä–ø–ª–∞—Ç–∞_scaled']
)

print("\n–ü–æ—Å–ª–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏:")
print(df_scaled.describe())
print("\n–í–∏–¥–∏—Ç–µ? –°—Ä–µ–¥–Ω–µ–µ ‚âà 0, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ‚âà 1!")

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
comparison = pd.concat([df, df_scaled], axis=1)
print("\n–°—Ä–∞–≤–Ω–µ–Ω–∏–µ (–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫):")
print(comparison.head())
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

#### Min-Max –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

**Min-Max –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è** –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –∑–∞–¥–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω, –æ–±—ã—á–Ω–æ $[0, 1]$. –ú–µ—Ç–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ø–∞–¥—É—Ç –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω.

$$X_{scaled} = \frac{X - X_{min}}{X_{max} - X_{min}}$$

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω —Å—Ç—Ä–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, $[0,1]$)
- –î–ª—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π ‚Äî –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ª—É—á—à–µ —Å –≤—Ö–æ–¥–∞–º–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ $[0,1]$
- –ö–æ–≥–¥–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö
- –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–∏–∫—Å–µ–ª–∏ $0$-$255$ ‚Üí $0$-$1)

**‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –û—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º ‚Äî –æ–¥–∏–Ω —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–π –≤—ã–±—Ä–æ—Å "—Å–∂–∏–º–∞–µ—Ç" –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –æ–±—É—á–∞—é—â–∏—Ö min/max, –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –≤–Ω–µ $[0,1]$
- –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** Min-Max –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏.~~</summary>

–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –±–∞–ª–ª—ã —ç–∫–∑–∞–º–µ–Ω–∞ ($0$-$100$) –∏ –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã ($0$-$40$ –ª–µ—Ç) ‚Äî –¥–∞–Ω–Ω—ã–µ —Å —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏. Min-Max –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç, —Ç–∞–∫ –∫–∞–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–º—ã—Å–ª –≥—Ä–∞–Ω–∏—Ü –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –≤—Å—ë –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É $[0,1]$. 

–î–∞–≤–∞–π—Ç–µ —Ä–µ–∞–ª–∏–∑—É–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä—É—á–Ω—É—é —Å –ø–æ–º–æ—â—å—é —Ñ–æ—Ä–º—É–ª—ã –∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º sklearn –∏ —Å—Ä–∞–≤–Ω–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

from sklearn.preprocessing import MinMaxScaler
import pandas as pd
import numpy as np

# –î–∞–Ω–Ω—ã–µ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
exam_scores = np.random.randint(0, 101, 100)  # –ë–∞–ª–ª—ã —ç–∫–∑–∞–º–µ–Ω–∞ 0-100
years_experience = np.random.randint(0, 41, 100)  # –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã 0-40 –ª–µ—Ç

df = pd.DataFrame({
    '–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞': exam_scores,
    '–æ–ø—ã—Ç_–ª–µ—Ç': years_experience
})

print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(df.describe())

# Min-Max –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
scaler = MinMaxScaler()
df_normalized = pd.DataFrame(
    scaler.fit_transform(df),
    columns=['–±–∞–ª–ª—ã_norm', '–æ–ø—ã—Ç_norm']
)

print("\n–ü–æ—Å–ª–µ Min-Max –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:")
print(df_normalized.describe())
print("–í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, 1]!")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º—É–ª—É
print(f"\n–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è –±–∞–ª–ª–æ–≤:")
print(f"–ú–∏–Ω: {df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].min()}, –ú–∞–∫—Å: {df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].max()}")
first_score = df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].iloc[0]
normalized_manual = (first_score - df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].min()) / (df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].max() - df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].min())
print(f"–†—É—á–Ω–æ–π —Ä–∞—Å—á—ë—Ç: ({first_score} - {df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].min()}) / ({df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].max()} - {df['–±–∞–ª–ª—ã_—ç–∫–∑–∞–º–µ–Ω–∞'].min()}) = {normalized_manual:.3f}")
print(f"Sklearn —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {df_normalized['–±–∞–ª–ª—ã_norm'].iloc[0]:.3f}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

–†–æ–±–∞—Å—Ç–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
----

**–†–æ–±–∞—Å—Ç–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–¥–∏–∞–Ω—É –∏ –º–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–∞—Ö ($IQR$) –≤–º–µ—Å—Ç–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –º–µ—Ç–æ–¥ —É—Å—Ç–æ–π—á–∏–≤—ã–º –∫ –≤—ã–±—Ä–æ—Å–∞–º, —Ç–∞–∫ –∫–∞–∫ –º–µ–¥–∏–∞–Ω–∞ –∏ –∫–≤–∞—Ä—Ç–∏–ª–∏ –º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º.

$$X_{robust} = \frac{X - median(X)}{IQR(X)}$$

–≥–¥–µ $IQR = Q_3 - Q_1$ ($75$-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å –º–∏–Ω—É—Å $25$-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å).

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –í –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–ª—å–Ω–æ —Å–∫–æ—à–µ–Ω–æ –∏–ª–∏ –∏–º–µ–µ—Ç —Ç—è–∂—ë–ª—ã–µ —Ö–≤–æ—Å—Ç—ã
- –ö–æ–≥–¥–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∏ Min-Max –¥–∞—é—Ç –ø–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑-–∑–∞ –≤—ã–±—Ä–æ—Å–æ–≤
- –í —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –≤—ã–±—Ä–æ—Å—ã —á–∞—Å—Ç—ã

**‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –ù–µ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ $0$ (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏)
- –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –≤—ã–±—Ä–æ—Å–∞–º.~~</summary>

–°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∑–∞—Ä–ø–ª–∞—Ç–∞—Ö: $95\%$ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏–º–µ—é—Ç –æ–±—ã—á–Ω—ã–µ –∑–∞—Ä–ø–ª–∞—Ç—ã (–æ–∫–æ–ª–æ $50k$), –Ω–æ –µ—Å—Ç—å $5\%$ –º–∏–ª–ª–∏–æ–Ω–µ—Ä–æ–≤ ($500k$-$5M$). –°—Ä–∞–≤–Ω–∏–º, –∫–∞–∫ —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å —Ç–∞–∫–∏–º–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–º–∏ –≤—ã–±—Ä–æ—Å–∞–º–∏.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

from sklearn.preprocessing import RobustScaler
import pandas as pd
import numpy as np

# –°–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏
np.random.seed(42)
normal_salaries = np.random.normal(50000, 15000, 95)
outlier_salaries = [500000, 800000, 1200000, 2000000, 5000000]  # –ú–∏–ª–ª–∏–æ–Ω–µ—Ä—ã!

all_salaries = np.concatenate([normal_salaries, outlier_salaries])

df = pd.DataFrame({'–∑–∞—Ä–ø–ª–∞—Ç–∞': all_salaries})

print("–î–∞–Ω–Ω—ã–µ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏:")
print(df.describe())
print(f"\n–í—ã–±—Ä–æ—Å—ã –≤–∏–¥–Ω—ã! –ú–∞–∫—Å: {df['–∑–∞—Ä–ø–ª–∞—Ç–∞'].max():,.0f}, –Ω–æ 75\%: {df['–∑–∞—Ä–ø–ª–∞—Ç–∞'].quantile(0.75):,.0f}")

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
from sklearn.preprocessing import StandardScaler, MinMaxScaler

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è
standard_scaler = StandardScaler()
df['standard'] = standard_scaler.fit_transform(df[['–∑–∞—Ä–ø–ª–∞—Ç–∞']])

# Min-Max
minmax_scaler = MinMaxScaler()
df['minmax'] = minmax_scaler.fit_transform(df[['–∑–∞—Ä–ø–ª–∞—Ç–∞']])

# –†–æ–±–∞—Å—Ç–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
robust_scaler = RobustScaler()
df['robust'] = robust_scaler.fit_transform(df[['–∑–∞—Ä–ø–ª–∞—Ç–∞']])

print("\n–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ (–ø–µ—Ä–≤—ã–µ 10 —Å—Ç—Ä–æ–∫):")
print(df.head(10))

print(f"\n–í–ª–∏—è–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:")
print(f"Standard: –º–∏–Ω={df['standard'].min():.2f}, –º–∞–∫—Å={df['standard'].max():.2f}")
print(f"MinMax: –º–∏–Ω={df['minmax'].min():.2f}, –º–∞–∫—Å={df['minmax'].max():.2f}")
print(f"Robust: –º–∏–Ω={df['robust'].min():.2f}, –º–∞–∫—Å={df['robust'].max():.2f}")
print("Robust Scaler –º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º!")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

**–í—ã–≤–æ–¥—ã –∏–∑ –ø—Ä–∏–º–µ—Ä–∞:** –í—ã–±—Ä–æ—Å—ã (–º–∏–ª–ª–∏–æ–Ω–µ—Ä—ã) –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∏ –∏—Å–∫–∞–∂–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã StandardScaler –∏ MinMaxScaler ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ –¥–∞–Ω–Ω—ã—Ö "—Å–∂–∏–º–∞–µ—Ç—Å—è" –≤ —É–∑–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω, —Ç–µ—Ä—è—è —Ä–∞–∑–ª–∏—á–∏–º–æ—Å—Ç—å. RobustScaler –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–º–µ—Ä–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤, –ø–æ—Å–∫–æ–ª—å–∫—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–¥–∏–∞–Ω—É –∏ –∫–≤–∞—Ä—Ç–∏–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ —É—Å—Ç–æ–π—á–∏–≤—ã –∫ –≤—ã–±—Ä–æ—Å–∞–º. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –≤—ã–±–æ—Ä–æ–º –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.

</details>

<br>

#### –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö**:

   - –ï—Å—Ç—å –ª–∏ –≤—ã–±—Ä–æ—Å—ã? (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ boxplot, describe(), IQR-–∞–Ω–∞–ª–∏–∑)
   - –ö–∞–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ? (–≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞, —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å)
   - –ï—Å—Ç—å –ª–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã? (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ—Ü–µ–Ω—Ç—ã $0$-$100\%$, –ø–∏–∫—Å–µ–ª–∏ $0$-$255$)

2. **–ê–Ω–∞–ª–∏–∑ –∞–ª–≥–æ—Ä–∏—Ç–º–∞**:

   - –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ª–∏ –∫ –º–∞—Å—à—Ç–∞–±—É? (KNN, SVM, –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ ‚Äî –î–ê; –¥–µ—Ä–µ–≤—å—è ‚Äî –ù–ï–¢)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–∏ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é? (L1/L2 ‚Äî –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
   - –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è–º–∏? (–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è, KNN ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)

3. **–í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏**:

| –°–∏—Ç—É–∞—Ü–∏—è | –ú–µ—Ç–æ–¥ | –ü–æ—á–µ–º—É |
|----------|-------|---------|
| –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –Ω–µ—Ç –≤—ã–±—Ä–æ—Å–æ–≤ | StandardScaler | –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ |
| –ï—Å—Ç—å –≤—ã–±—Ä–æ—Å—ã ($>5\%$ –¥–∞–Ω–Ω—ã—Ö) | RobustScaler | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–¥–∏–∞–Ω—É –∏ IQR |
| –ù—É–∂–µ–Ω –¥–∏–∞–ø–∞–∑–æ–Ω $[0,1]$ | MinMaxScaler | –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç $[0,1]$ |
| –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã (%, –ø–∏–∫—Å–µ–ª–∏) | MinMaxScaler | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–º—ã—Å–ª –≥—Ä–∞–Ω–∏—Ü |
| –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ | StandardScaler | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä |

<details>

<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–æ–π—Å—Ç–≤ –¥–∞–Ω–Ω—ã—Ö.~~</summary>

–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª–∞ –±—ã –º–µ—Ç–æ–¥ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–æ–π—Å—Ç–≤ –¥–∞–Ω–Ω—ã—Ö. 

```python
import pandas as pd
import numpy as np
from scipy import stats

def choose_scaling_method(data, column_name):
    """
    –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –º–µ—Ç–æ–¥ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≤–æ–π—Å—Ç–≤ –¥–∞–Ω–Ω—ã—Ö
    """
    series = data[column_name]
    
    # –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    mean_val = series.mean()
    median_val = series.median()
    std_val = series.std()
    min_val = series.min()
    max_val = series.max()
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã–±—Ä–æ—Å—ã (IQR –º–µ—Ç–æ–¥)
    q1, q3 = series.quantile([0.25, 0.75])
    iqr = q3 - q1
    outliers = series[(series < q1 - 1.5*iqr) | (series > q3 + 1.5*iqr)]
    outlier_ratio = len(outliers) / len(series)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è)
    skewness = abs(series.skew())
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã
    has_zero_min = min_val >= 0
    has_upper_bound = max_val <= 100 or max_val <= 1  # —á–∞—Å—Ç—ã–µ —Å–ª—É—á–∞–∏
    
    print(f"\n--- –ê–Ω–∞–ª–∏–∑ —Å—Ç–æ–ª–±—Ü–∞ '{column_name}' ---")
    print(f"–°—Ä–µ–¥–Ω–µ–µ: {mean_val:.2f}, –ú–µ–¥–∏–∞–Ω–∞: {median_val:.2f}")
    print(f"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: {std_val:.2f}")
    print(f"–î–∏–∞–ø–∞–∑–æ–Ω: [{min_val:.2f}, {max_val:.2f}]")
    print(f"–î–æ–ª—è –≤—ã–±—Ä–æ—Å–æ–≤: {outlier_ratio:.1%}")
    print(f"–ê—Å–∏–º–º–µ—Ç—Ä–∏—è: {skewness:.2f}")
    
    # –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞
    # TODO: –î–æ–ø–∏—à–∏—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏
    if outlier_ratio > 0.05:  # –ë–æ–ª–µ–µ 5% –≤—ã–±—Ä–æ—Å–æ–≤
        recommendation = "RobustScaler"
        reason = f"–í—ã—Å–æ–∫–∞—è –¥–æ–ª—è –≤—ã–±—Ä–æ—Å–æ–≤ ({outlier_ratio:.1%})"
        
    #elif –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å:
    
    print(f"üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: {recommendation}")
    print(f"üí° –ü—Ä–∏—á–∏–Ω–∞: {reason}")
    
    return recommendation

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
np.random.seed(42)

test_datasets = pd.DataFrame({
    '–Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ_–¥–∞–Ω–Ω—ã–µ': np.random.normal(100, 15, 1000),
    '—Å_–≤—ã–±—Ä–æ—Å–∞–º–∏': np.concatenate([np.random.normal(50, 10, 990), [200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100]]),
    '–ø—Ä–æ—Ü–µ–Ω—Ç—ã': np.random.beta(2, 5, 1000) * 100,
    '–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ': np.random.exponential(2, 1000)
})

for column in test_datasets.columns:
    choose_scaling_method(test_datasets, column)
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

<details>

<summary>~~**üéØ –í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**~~</summary>

```python
    if outlier_ratio > 0.05:  # –ë–æ–ª–µ–µ 5% –≤—ã–±—Ä–æ—Å–æ–≤
        recommendation = "RobustScaler"
        reason = f"–í—ã—Å–æ–∫–∞—è –¥–æ–ª—è –≤—ã–±—Ä–æ—Å–æ–≤ ({outlier_ratio:.1%})"
        
    elif has_zero_min and has_upper_bound:
        recommendation = "MinMaxScaler"
        reason = "–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö"
        
    elif skewness > 1.5:  # –°–∏–ª—å–Ω–∞—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—è
        recommendation = "RobustScaler"
        reason = f"–°–∏–ª—å–Ω–∞—è –∞—Å–∏–º–º–µ—Ç—Ä–∏—è –¥–∞–Ω–Ω—ã—Ö (skew={skewness:.2f})"
        
    else:
        recommendation = "StandardScaler"
        reason = "–î–∞–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏"
```

</details>

</details>

<br>

@quizQuestion(`–£ –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫ "–¥–æ—Ö–æ–¥" —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–∏–ª–ª–∏–æ–Ω–µ—Ä–∞–º–∏ –≤ –¥–∞–Ω–Ω—ã—Ö. –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–±—Ä–∞—Ç—å?`)

<!-- data-randomize -->
[( )] StandardScaler
[( )] MinMaxScaler  
[(X)] RobustScaler
[( )] –ù–∏–∫–∞–∫–æ–π

#### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏

1. **–ü–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π:** –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ train/test –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –ø—Ä–∏–º–µ–Ω—è—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ. 

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π.~~</summary>

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —á–∞—Å—Ç—É—é –æ—à–∏–±–∫—É: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ –≤—Å–µ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É –¥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ train/test. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —É—Ç–µ—á–∫–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from sklearn.datasets import make_classification

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Å–∏–ª—å–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –æ—Ç –º–∞—Å—à—Ç–∞–±–∞
X, y = make_classification(
    n_samples=1000,
    n_features=20,
    n_informative=15,
    n_redundant=5,
    random_state=42,
    scale=100.0
)

# –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±—Ä–æ—Å—ã
np.random.seed(42)
outlier_mask = np.random.rand(len(X)) < 0.05
X[outlier_mask] *= 50

# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–†–Ø–î–û–ö - –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –î–û —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
scaler_wrong = StandardScaler()
X_scaled_wrong = scaler_wrong.fit_transform(X)  # –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö!
X_train_wrong, X_test_wrong, y_train, y_test = train_test_split(
    X_scaled_wrong, y, test_size=0.2, random_state=42
)

model_wrong = LogisticRegression(max_iter=1000)
model_wrong.fit(X_train_wrong, y_train)
y_pred_wrong = model_wrong.predict(X_test_wrong)
wrong_acc = accuracy_score(y_test, y_pred_wrong)

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–†–Ø–î–û–ö - —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–¥–µ–ª—è–µ–º, –ø–æ—Ç–æ–º –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

scaler_correct = StandardScaler()
X_train_scaled = scaler_correct.fit_transform(X_train)
X_test_scaled = scaler_correct.transform(X_test)  # –¢–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è

model_correct = LogisticRegression(max_iter=1000)
model_correct.fit(X_train_scaled, y_train)
y_pred_correct = model_correct.predict(X_test_scaled)
correct_acc = accuracy_score(y_test, y_pred_correct)

# –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º —Ä–∞–∑–Ω–∏—Ü—ã
print(f"‚ùå –ó–∞–≤—ã—à–µ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –î–û —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è): {wrong_acc:.4f}")
print(f"‚úÖ –†–µ–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û–°–õ–ï —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è): {correct_acc:.4f}")
print(f"\n–†–∞–∑–Ω–∏—Ü–∞: {wrong_acc - correct_acc:.4f} ({(wrong_acc - correct_acc)/correct_acc*100:.1f}% –∑–∞–≤—ã—à–µ–Ω–∏—è)")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

–ü—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è) –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≤—ã—à–µ–Ω–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö:

- –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (—Å—Ä–µ–¥–Ω–µ–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
- –ú–æ–¥–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

</details>

<br>

2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:** –í production-—Å–∏—Å—Ç–µ–º–∞—Ö –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ. –ï—Å–ª–∏ –ø–æ—Ç–µ—Ä—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (—Å—Ä–µ–¥–Ω–µ–µ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ, min/max), –º–æ–¥–µ–ª—å —Å—Ç–∞–Ω–µ—Ç –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ–π.

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∫–µ–π–ª–µ—Ä–∞.~~</summary>

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∫–µ–π–ª–µ—Ä–∞ –≤ —Ñ–∞–π–ª –∏ –µ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

```python
import pickle
from sklearn.preprocessing import StandardScaler

# –û–±—É—á–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∫–µ–π–ª–µ—Ä–∞
with open('scaler.pkl', 'wb') as f:
    pickle.dump(scaler, f)

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
with open('scaler.pkl', 'rb') as f:
    loaded_scaler = pickle.load(f)

# –ü—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
new_data_scaled = loaded_scaler.transform(new_data)

print("–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∫–µ–π–ª–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö!")
```

</details>

<br>

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:** –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –†–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç —Å–≤–æ–∏ –æ–∂–∏–¥–∞–µ–º—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä** –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.~~</summary>

–†–µ–∞–ª–∏–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–∂–∏–¥–∞–Ω–∏—è–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Ç–æ–¥–∞ –∏ –≤—ã–¥–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import numpy as np
from sklearn.preprocessing import StandardScaler

def check_scaling_results(original, scaled, method_name):
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è"""
    
    print(f"\n--- –ü—Ä–æ–≤–µ—Ä–∫–∞ {method_name} ---")
    
    # –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    print(f"–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –°—Ä–µ–¥–Ω–µ–µ: {original.mean():.2f}, –°—Ç–¥: {original.std():.2f}")
    print(f"–ü–æ—Å–ª–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è - –°—Ä–µ–¥–Ω–µ–µ: {scaled.mean():.2f}, –°—Ç–¥: {scaled.std():.2f}")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    print(f"–î–∏–∞–ø–∞–∑–æ–Ω: [{scaled.min():.2f}, {scaled.max():.2f}]")
    
    # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    if abs(scaled.mean()) > 0.1 and method_name == "StandardScaler":
        print("‚ö†Ô∏è –°—Ä–µ–¥–Ω–µ–µ –Ω–µ –±–ª–∏–∑–∫–æ –∫ 0 - –≤–æ–∑–º–æ–∂–Ω–∞ –æ—à–∏–±–∫–∞!")
        
    if abs(scaled.std() - 1) > 0.1 and method_name == "StandardScaler":
        print("‚ö†Ô∏è –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–µ –±–ª–∏–∑–∫–æ –∫ 1!")
        
    if (scaled.min() < -0.1 or scaled.max() > 1.1) and method_name == "MinMaxScaler":
        print("‚ö†Ô∏è –ó–Ω–∞—á–µ–Ω–∏—è –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –¥–∏–∞–ø–∞–∑–æ–Ω [0,1]!")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
original_data = np.random.normal(100, 20, 1000)
scaler = StandardScaler()
scaled_data = scaler.fit_transform(original_data.reshape(-1, 1)).flatten()

check_scaling_results(original_data, scaled_data, "StandardScaler")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

4. **–û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:** –ò–Ω–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–µ—Ä–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –∏–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –≤ –ø–æ–Ω—è—Ç–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–∏–¥–µ. –í—Å–µ —Å–∫–µ–π–ª–µ—Ä—ã sklearn –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `inverse_transform()`.

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä** –û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–±–æ—Ç–∞ —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.~~</summary>

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ ‚Üí –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚Üí –æ–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ `inverse_transform` —Ç–æ—á–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import numpy as np
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LinearRegression
from sklearn.datasets import make_regression
from sklearn.metrics import mean_squared_error

# 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
X, y = make_regression(n_samples=100, n_features=3, noise=10, random_state=42)
print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫):\n", X[:5])

# 2. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)
print("\n–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫):\n", X_scaled[:5])

# 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
model = LinearRegression()
model.fit(X_scaled, y)

# 4. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–≤–æ–∑—å–º–µ–º —á–∞—Å—Ç—å –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–∞–∫ "–Ω–æ–≤—ã–µ")
new_data = X[90:]  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 samples –∫–∞–∫ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
new_data_scaled = scaler.transform(new_data)  # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
predictions_scaled = model.predict(new_data_scaled)  # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ

# 5. –û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
# –î–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
new_data_unscaled = scaler.inverse_transform(new_data_scaled)
# –î–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π (–µ—Å–ª–∏ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ)
# (–≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —Ç–∞—Ä–≥–µ—Ç –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–ª—Å—è)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:")
print("–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n", new_data[:3])
print("–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n", new_data_unscaled[:3])

# –†–∞—Å—á–µ—Ç –æ—à–∏–±–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
reconstruction_error = mean_squared_error(new_data, new_data_unscaled)
print(f"\n–°—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: {reconstruction_error:.2e}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

–û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–∞—à–∏–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–∏–º–æ –∏ –Ω–µ —Ç–µ—Ä—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
</details>

<br>

5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –≤—ã–±—Ä–æ—Å–æ–≤:** –û—Å–æ–±–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –≤ production –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –±—ã–ª–æ –≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ. –≠—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –∫–∞–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Ç–∞–∫ –∏ —Å–∏—Ç—É–∞—Ü–∏–π —Å –≤—ã–±—Ä–æ—Å–∞–º–∏, –≤—ã—Ö–æ–¥—è—â–∏–º–∏ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –†–∞–±–æ—Ç–∞ —Å –Ω–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.~~</summary>

–ü–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –æ–±—É—á–∞—é—â–µ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–∫–µ–π–ª–µ—Ä–æ–≤.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import numpy as np
from sklearn.preprocessing import StandardScaler, MinMaxScaler, RobustScaler

# –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
X_train = np.array([[10], [20], [30], [40], [50]])
y_train = np.array([1, 0, 1, 0, 1])

# –ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
X_new = np.array([[5], [60], [100], [200]])  # –í—ã—Ö–æ–¥—è—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã [10, 50]

print("–û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:", X_train.flatten())
print("–ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:", X_new.flatten())

# –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ —Å–∫–µ–π–ª–µ—Ä—ã
scalers = {
    'StandardScaler': StandardScaler(),
    'MinMaxScaler': MinMaxScaler(),
    'RobustScaler': RobustScaler()
}

for name, scaler in scalers.items():
    # –û–±—É—á–∞–µ–º –Ω–∞ train –¥–∞–Ω–Ω—ã—Ö
    scaler.fit(X_train)
    
    # –ü—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
    X_new_scaled = scaler.transform(X_new)
    
    print(f"\n{name}:")
    print(f"–ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è: {X_new_scaled.flatten()}")
    
    if name == "MinMaxScaler":
        out_of_bounds = (X_new_scaled < 0) | (X_new_scaled > 1)
        if out_of_bounds.any():
            print("‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã [0,1]!")
    
    if name == "StandardScaler":
        extreme_values = np.abs(X_new_scaled) > 3
        if extreme_values.any():
            print("‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (>3 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π)!")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

MinMaxScaler –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ $[0,1]$ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. StandardScaler —Å–æ–∑–¥–∞–µ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–∞–ª–µ–∫–∏—Ö –æ—Ç –æ–±—É—á–∞—é—â–µ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞. RobustScaler –Ω–∞–∏–±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤ –∫ —Ç–∞–∫–∏–º —Å–∏—Ç—É–∞—Ü–∏—è–º –±–ª–∞–≥–æ–¥–∞—Ä—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∫–≤–∞—Ä—Ç–∏–ª–µ–π.
</details>

<br>

6. **–í–ª–∏—è–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:** –†–∞–∑–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø–æ-—Ä–∞–∑–Ω–æ–º—É —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏. –ï—Å–ª–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏–ª–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é ‚Äî –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.

<details>
<summary>~~**üìã –ü—Ä–∏–º–µ—Ä.** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –±–µ–∑.~~</summary>

–°—Ä–∞–≤–Ω–∏–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–∞–∑–Ω—ã–º–∏ –º–∞—Å—à—Ç–∞–±–∞–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier
from sklearn.svm import SVC
from sklearn.neighbors import KNeighborsClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.datasets import make_classification
import pandas as pd

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–Ω—ã–º–∏ –º–∞—Å—à—Ç–∞–±–∞–º–∏
X, y = make_classification(n_samples=1000, n_features=3, n_redundant=0, 
                          n_clusters_per_class=1, random_state=42)

# –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ–∑–¥–∞–µ–º —Ä–∞–∑–Ω—ã–µ –º–∞—Å—à—Ç–∞–±—ã
X[:, 0] *= 1        # –ü—Ä–∏–∑–Ω–∞–∫ 1: –º–∞—Å—à—Ç–∞–± 1
X[:, 1] *= 100      # –ü—Ä–∏–∑–Ω–∞–∫ 2: –º–∞—Å—à—Ç–∞–± 100
X[:, 2] *= 10000    # –ü—Ä–∏–∑–Ω–∞–∫ 3: –º–∞—Å—à—Ç–∞–± 10000

print("–ú–∞—Å—à—Ç–∞–±—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:")
print(f"–ü—Ä–∏–∑–Ω–∞–∫ 1: {X[:, 0].min():.1f} - {X[:, 0].max():.1f}")
print(f"–ü—Ä–∏–∑–Ω–∞–∫ 2: {X[:, 1].min():.0f} - {X[:, 1].max():.0f}")
print(f"–ü—Ä–∏–∑–Ω–∞–∫ 3: {X[:, 2].min():.0f} - {X[:, 2].max():.0f}")

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# –ê–ª–≥–æ—Ä–∏—Ç–º—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
algorithms = {
    'Logistic Regression': LogisticRegression(random_state=42, max_iter=1000),
    'SVM': SVC(random_state=42),
    'K-Nearest Neighbors': KNeighborsClassifier(),
    'Decision Tree': DecisionTreeClassifier(random_state=42),
    'Random Forest': RandomForestClassifier(random_state=42)
}

results = []

for name, model in algorithms.items():
    # –ë–µ–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
    model.fit(X_train, y_train)
    accuracy_no_scaling = model.score(X_test, y_test)
    
    # –° –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    model.fit(X_train_scaled, y_train)
    accuracy_with_scaling = model.score(X_test_scaled, y_test)
    
    # –£–ª—É—á—à–µ–Ω–∏–µ
    improvement = accuracy_with_scaling - accuracy_no_scaling
    
    results.append({
        'Algorithm': name,
        'Without Scaling': accuracy_no_scaling,
        'With Scaling': accuracy_with_scaling,
        'Improvement': improvement
    })

results_df = pd.DataFrame(results)
print("\n–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤:")
print(results_df.round(3))

print("\n–í—ã–≤–æ–¥—ã:")
for _, row in results_df.iterrows():
    if abs(row['Improvement']) > 0.01:
        direction = "—É–ª—É—á—à–µ–Ω–∏–µ" if row['Improvement'] > 0 else "—É—Ö—É–¥—à–µ–Ω–∏–µ"
        print(f"- {row['Algorithm']}: {direction} –Ω–∞ {abs(row['Improvement']):.3f}")
    else:
        print(f"- {row['Algorithm']}: –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –≤–ª–∏—è–µ—Ç")
``` 
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

- **–ê–ª–≥–æ—Ä–∏—Ç–º—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è—Ö** (KNN, SVM) –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
- **–õ–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏** (LogisticRegression) —Ç–∞–∫–∂–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –º–∞—Å—à—Ç–∞–±—É –∏–∑-–∑–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞
- **–î—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã** (DecisionTree, RandomForest) —É—Å—Ç–æ–π—á–∏–≤—ã –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ—Ä–æ–≥–æ–≤—ã–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

</details>

<br>

### –ü—Ä–æ–±–ª–µ–º–∞ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏
----

> **üèóÔ∏è –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é.** –£ –≤–∞—Å –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –¥–æ–º–∞—Ö: –ø–ª–æ—â–∞–¥—å –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–µ—Ç—Ä–∞—Ö, –ø–ª–æ—â–∞–¥—å –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Ñ—É—Ç–∞—Ö, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç –∏ –ø–ª–æ—â–∞–¥—å –Ω–∞ –∫–æ–º–Ω–∞—Ç—É. –í—Å–µ —ç—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π! –ï—Å–ª–∏ –ø–ª–æ—â–∞–¥—å –¥–æ–º–∞ —É–¥–≤–∞–∏–≤–∞–µ—Ç—Å—è, —Ç–æ –∏ –ø–ª–æ—â–∞–¥—å –≤ —Ñ—É—Ç–∞—Ö —É–¥–≤–∞–∏–≤–∞–µ—Ç—Å—è —Ç–æ–∂–µ. –ê–ª–≥–æ—Ä–∏—Ç–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–µ—Ç –∑–∞–ø—É—Ç–∞—Ç—å—Å—è: –∫–∞–∫–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–µ–Ω –¥–ª—è —Ü–µ–Ω—ã? –≠—Ç–æ –∏ –µ—Å—Ç—å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å.

**–ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å** –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –¥–≤–∞ –∏–ª–∏ –±–æ–ª–µ–µ –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤ –¥–∞–Ω–Ω—ã—Ö —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–¥–∏–Ω –ø—Ä–∏–∑–Ω–∞–∫ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥—Ä—É–≥–∏—Ö —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é.

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**

1. **–ù–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤** ‚Äî –º–∞–ª—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏
2. **–ó–∞—Ç—Ä—É–¥–Ω–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è** ‚Äî –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –ø—Ä–∏–∑–Ω–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é  
3. **–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ** ‚Äî –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–ø–æ–º–Ω–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
4. **–ü—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞—â–µ–Ω–∏–µ–º –º–∞—Ç—Ä–∏—Ü** ‚Äî –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è) –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ
5. **–ò–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å** ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–µ—Å—É—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

**–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

| –û–±–ª–∞—Å—Ç—å | –ö–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ | –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞–µ—Ç |
|---------|----------------------|------------------|
| **–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å** | –ü–ª–æ—â–∞–¥—å –≤ –º¬≤ ‚Üî –ü–ª–æ—â–∞–¥—å –≤ —Ñ—É—Ç–∞—Ö | –û–¥–Ω–∞ –∏ —Ç–∞ –∂–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö |
| **HR-–¥–∞–Ω–Ω—ã–µ** | –û–ø—ã—Ç –≤ –≥–æ–¥–∞—Ö ‚Üî –û–ø—ã—Ç –≤ –º–µ—Å—è—Ü–∞—Ö | –õ–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ |
| **–§–∏–Ω–∞–Ω—Å—ã** | –î–æ—Ö–æ–¥ ‚Üî –†–∞–∑–º–µ—Ä –∫—Ä–µ–¥–∏—Ç–∞ ‚Üî –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂ | –õ–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ |
| **–ú–µ–¥–∏—Ü–∏–Ω–∞** | –†–æ—Å—Ç ‚Üî –í–µ—Å ‚Üî –ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞ | –ò–ú–¢ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ—Å—Ç–∞ –∏ –≤–µ—Å–∞ |
| **E-commerce** | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫ ‚Üî –û–±—â–∞—è —Å—É–º–º–∞ ‚Üî –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ | –í–∑–∞–∏–º–æ–∑–∞–≤–∏—Å–∏–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ |

**–ö–æ–≥–¥–∞ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å –ù–ï –ø—Ä–æ–±–ª–µ–º–∞:**

- –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ä–µ–≤—å–µ–≤ (Random Forest, XGBoost) ‚Äî –æ–Ω–∏ —É—Å—Ç–æ–π—á–∏–≤—ã –∫ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º
- –í –∑–∞–¥–∞—á–∞—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –≥–¥–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –Ω–µ –≤–∞–∂–Ω–∞
- –ü—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏

@NB(`–í–∞–∂–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π. –ü–æ—Å–ª–µ–¥–Ω—è—è –∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞ –∏ –ø–æ–ª–µ–∑–Ω–∞ –¥–ª—è –º–æ–¥–µ–ª–∏!`)

#### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏

1. **–ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã**
----

**–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∞—Ä–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –≤ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–≥–ª—è–¥–Ω—ã–π —Å–ø–æ—Å–æ–± –≤—ã—è–≤–∏—Ç—å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å.

**–ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π:**

- $|r| < 0.3$ ‚Äî —Å–ª–∞–±–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, –ø—Ä–æ–±–ª–µ–º –Ω–µ—Ç
- $0.3 \leq |r| < 0.7$ ‚Äî —É–º–µ—Ä–µ–Ω–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, —Å—Ç–æ–∏—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å  
- $|r| \geq 0.7$ ‚Äî —Å–∏–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, –≤–µ—Ä–æ—è—Ç–Ω–∞ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å
- $|r| \geq 0.9$ ‚Äî –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, —Å–µ—Ä—å–µ–∑–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

@NB(`–ü–∞—Ä–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –æ–±—ä—è—Å–Ω—è—é—â–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–æ–≥—É—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å—Å—è –∫–∞–∫ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ, –Ω–æ ~~–Ω–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ —É—Å–ª–æ–≤–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏~~. –ï—Å–ª–∏ –≤—Å–µ –ø–∞—Ä–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–Ω—å—à–µ $1$, —ç—Ç–æ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–∏–∞—Ä–Ω–æ—Å—Ç–∏ –Ω–µ—Ç.`)

---
**üìã –ü—Ä–∏–º–µ—Ä.** –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö.

–°–æ–∑–¥–∞–¥–∏–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ HR-–æ—Ç–¥–µ–ª–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ç–∏–ø–∞–º–∏ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏: –ª–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (–æ–ø—ã—Ç –≤ –≥–æ–¥–∞—Ö/–º–µ—Å—è—Ü–∞—Ö), –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–∑–∞—Ä–ø–ª–∞—Ç–∞ –∏ –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ —Ç—ã—Å—è—á–∞—Ö), –∏ –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–æ–±—â–∏–π –±–∞–ª–ª –∫–∞–∫ —Å—É–º–º–∞ –¥—Ä—É–≥–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π).

–ü–æ—Å—Ç—Ä–æ–∏–º —Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –∏ –Ω–∞–π–¥–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–∞—Ä—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π –≤—ã—à–µ $0.8$.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import seaborn
except ImportError:
    install_package("seaborn")

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# –°–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ —Å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é
np.random.seed(42)
n = 1000

# –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
experience = np.random.randint(1, 21, n)  # –û–ø—ã—Ç 1-20 –ª–µ—Ç
education_score = np.random.randint(1, 11, n)  # –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ 1-10
performance = np.random.randint(1, 6, n)  # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 1-5

# –ó–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–ø—ã—Ç–∞ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
salary = 30000 + experience * 2000 + education_score * 1500 + performance * 3000 + np.random.normal(0, 5000, n)

# –ü–†–û–ë–õ–ï–ú–ê: —Å–æ–∑–¥–∞—ë–º –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
salary_thousands = salary / 1000  # –ó–∞—Ä–ø–ª–∞—Ç–∞ –≤ —Ç—ã—Å—è—á–∞—Ö (–∏–¥–µ–∞–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è!)
experience_months = experience * 12  # –û–ø—ã—Ç –≤ –º–µ—Å—è—Ü–∞—Ö (–∏–¥–µ–∞–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è!)
total_score = experience + education_score + performance  # –°—É–º–º–∞ –±–∞–ª–ª–æ–≤
education_years = education_score + np.random.normal(0, 0.5, n)  # –ü–æ—á—Ç–∏ —Ç–æ –∂–µ, —á—Ç–æ education_score

df = pd.DataFrame({
    '–æ–ø—ã—Ç_–ª–µ—Ç': experience,
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_–±–∞–ª–ª': education_score,
    '–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å': performance,
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': salary,
    '–∑–∞—Ä–ø–ª–∞—Ç–∞_—Ç—ã—Å': salary_thousands,  # –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫!
    '–æ–ø—ã—Ç_–º–µ—Å—è—Ü—ã': experience_months,  # –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫!
    '–æ–±—â–∏–π_–±–∞–ª–ª': total_score,  # –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫!
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_–ª–µ—Ç': education_years  # –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫!
})

print("–î–∞–Ω–Ω—ã–µ —Å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é:")
print(df.head())
print(f"\n–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: {df.shape}")

# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
correlation_matrix = df.corr()

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0, 
            square=True, linewidths=0.5, fmt='.2f')
plt.title('–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ (–ø–æ–∏—Å–∫ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏)')
plt.tight_layout()
plt.show()

# –ò—â–µ–º –≤—ã—Å–æ–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (>0.8)
def find_high_correlations(corr_matrix, threshold=0.8):
    high_corr_pairs = []
    for i in range(len(corr_matrix.columns)):
        for j in range(i+1, len(corr_matrix.columns)):
            if abs(corr_matrix.iloc[i, j]) > threshold:
                high_corr_pairs.append((
                    corr_matrix.columns[i], 
                    corr_matrix.columns[j], 
                    corr_matrix.iloc[i, j]
                ))
    return high_corr_pairs

high_correlations = find_high_correlations(correlation_matrix, 0.8)

print(f"\n–í—ã—Å–æ–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (>0.8):")
if high_correlations:
    for var1, var2, corr in high_correlations:
        print(f"   {var1} ‚Üî {var2}: {corr:.3f}")
else:
    print("   –í—ã—Å–æ–∫–∏—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

print(f"\n–í—Å–µ–≥–æ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø–∞—Ä: {len(high_correlations)}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

@img_sem03(corr_matrix.png, –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, 60)

2. **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç VIF (Variance Inflation Factor)**
----

–î–ª—è —É—á–µ—Ç–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –ø–∞—Ä–Ω—ã—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π, –Ω–æ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–µ—Ç—Ä–∏–∫—É VIF.

**VIF (Variance Inflation Factor)** ‚Äî —ç—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –º–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≤–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–∏—Å–ø–µ—Ä—Å–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞ –∏–∑-–∑–∞ –Ω–∞–ª–∏—á–∏—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏. –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, VIF –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –æ–¥–∏–Ω –ø—Ä–∏–∑–Ω–∞–∫ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

$$VIF_i = \frac{1}{1 - R_i^2}$$

–≥–¥–µ $R_i^2$ ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ –ø—Ä–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ $i$-–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –Ω–∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.

–í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ª—é–±–æ–≥–æ $VIF_j$ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å. –ß–µ–º –≤—ã—à–µ $VIF_j$, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å.

- $VIF_j = 1$ ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è $X_j$ –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–∞ –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º (–Ω–µ—Ç –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏)
- $VIF_j > 1$ ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è $X_j$ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–∞ —Å –¥—Ä—É–≥–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- $VIF_j > 5$ ‚Äî —É–º–µ—Ä–µ–Ω–Ω–∞—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å
- $VIF_j > 10$ ‚Äî —Å–µ—Ä—å–µ–∑–Ω–∞—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å

---
**üìã –ü—Ä–∏–º–µ—Ä.** –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è VIF –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏.


```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import statsmodels
except ImportError:
    install_package("statsmodels")

import statsmodels.api as sm
from statsmodels.stats.outliers_influence import variance_inflation_factor
import pandas as pd
import numpy as np

# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
np.random.seed(42)
n = 1000

experience = np.random.randint(1, 21, n)
education_score = np.random.randint(1, 11, n)
performance = np.random.randint(1, 6, n)
salary = 30000 + experience * 2000 + education_score * 1500 + performance * 3000 + np.random.normal(0, 5000, n)

df = pd.DataFrame({
    '–æ–ø—ã—Ç_–ª–µ—Ç': experience,
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_–±–∞–ª–ª': education_score,
    '–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å': performance,
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': salary,
    '–∑–∞—Ä–ø–ª–∞—Ç–∞_—Ç—ã—Å': salary / 1000,
    '–æ–ø—ã—Ç_–º–µ—Å—è—Ü—ã': experience * 12,
    '–æ–±—â–∏–π_–±–∞–ª–ª': experience + education_score + performance
})

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ (–±–µ–∑ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π)
X = df.drop(columns=['–∑–∞—Ä–ø–ª–∞—Ç–∞'])

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É (–¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ VIF)
X_with_const = sm.add_constant(X)  

# –†–∞—Å—á–µ—Ç VIF
vif_data = pd.DataFrame()
vif_data["feature"] = X_with_const.columns
vif_data["VIF"] = [variance_inflation_factor(X_with_const.values, i) 
                  for i in range(X_with_const.shape[1])]

print("VIF –¥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:")
print(vif_data)

# 3. –£–¥–∞–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
features_clean = ['–∑–∞—Ä–ø–ª–∞—Ç–∞_—Ç—ã—Å', '–æ–ø—ã—Ç_–º–µ—Å—è—Ü—ã', '–æ–±—â–∏–π_–±–∞–ª–ª']
X_clean = sm.add_constant(X.drop(columns=features_clean))

vif_clean = pd.DataFrame()
vif_clean["feature"] = X_clean.columns
vif_clean["VIF"] = [variance_inflation_factor(X_clean.values, i) 
                   for i in range(X_clean.shape[1])]

print("\nVIF –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:")
print(vif_clean)
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

@quizQuestion(`–ö–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ VIF —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–µ—Ä—å—ë–∑–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏?`)

<!-- data-randomize -->
[( )] VIF = 2
[( )] VIF = 5
[(X)] VIF = 15
[( )] VIF = 0.5

#### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–Ω—è—Ç—å –º–µ—Ä—ã –ø–æ –µ—ë —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –æ—Ç –ø—Ä–æ—Å—Ç—ã—Ö –∫ —Å–ª–æ–∂–Ω—ã–º.

1. **–£–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**
----

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ —á–∞—Å—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî —É–¥–∞–ª–∏—Ç—å –æ–¥–∏–Ω –∏–∑ —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –≠—Ç–æ –ª–æ–≥–∏—á–Ω–æ, –µ—Å–ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–µ—Å—É—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

**–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:**

1. –î–æ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è ‚Äî —É–¥–∞–ª—è–µ–º –º–µ–Ω–µ–µ –≤–∞–∂–Ω—ã–π —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å–∞
2. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫ —Å –±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å target
3. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫  
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ ‚Äî —É–¥–∞–ª—è–µ–º –æ–¥–∏–Ω –∏–∑ –ø–∞—Ä—ã —Å –Ω–∞–∏–≤—ã—Å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ü—Ä–∏–∑–Ω–∞–∫–∏ —è–≤–ª—è—é—Ç—Å—è —Ä–∞–∑–Ω—ã–º–∏ –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è –æ–¥–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã (–º¬≤ –∏ —Ñ—É—Ç—ã¬≤)
- –û–¥–∏–Ω –ø—Ä–∏–∑–Ω–∞–∫ —è–≤–ª—è–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –¥—Ä—É–≥–æ–≥–æ (–≥–æ–¥—ã ‚Üî –º–µ—Å—è—Ü—ã)
- –ï—Å—Ç—å —á–µ—Ç–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –≤–∞–∂–Ω–µ–µ

**‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –ü–æ—Ç–µ—Ä—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ ‚Äî –¥–∞–∂–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–≥—É—Ç –Ω–µ—Å—Ç–∏ —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –°—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ ‚Äî —Ä–µ—à–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫–æ–π –ø—Ä–∏–∑–Ω–∞–∫ —É–¥–∞–ª–∏—Ç—å
- –ù–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É —Å–∫—Ä—ã—Ç—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏

---
**üìã –ü—Ä–∏–º–µ—Ä.** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏.

–†–µ–∞–ª–∏–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –ø—Ä–∏–º–µ–Ω–∏–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–±–æ—Ä–∞.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import statsmodels
except ImportError:
    install_package("statsmodels")
try:
    import seaborn
except ImportError:
    install_package("seaborn")


import pandas as pd
import numpy as np
from statsmodels.stats.outliers_influence import variance_inflation_factor
import matplotlib.pyplot as plt
import seaborn as sns

def remove_correlated_features(df, target_col=None, threshold=0.8, method='first'):
    """
    –£–¥–∞–ª—è–µ—Ç —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
    
    Parameters:
    -----------
    df : DataFrame
        –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    target_col : str, optional
        –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    threshold : float, default=0.8
        –ü–æ—Ä–æ–≥ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    method : str, default='first'
        –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–±–æ—Ä–∞: 'first', 'target_corr', 'random'
    
    Returns:
    --------
    DataFrame –±–µ–∑ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    list —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    """
    
    # –ò—Å–∫–ª—é—á–∞–µ–º —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
    if target_col and target_col in df.columns:
        features = df.drop(columns=[target_col])
    else:
        features = df.copy()
    
    corr_matrix = features.corr().abs()
    
    # –ù–∞—Ö–æ–¥–∏–º –≤–µ—Ä—Ö–Ω–∏–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –º–∞—Ç—Ä–∏—Ü—ã (–∏–∑–±–µ–≥–∞–µ–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
    upper_triangle = corr_matrix.where(
        np.triu(np.ones_like(corr_matrix, dtype=bool), k=1)
    )
    
    # –ù–∞—Ö–æ–¥–∏–º –ø–∞—Ä—ã —Å –≤—ã—Å–æ–∫–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π
    high_corr_pairs = []
    for col in upper_triangle.columns:
        for idx in upper_triangle.index:
            if pd.notna(upper_triangle.loc[idx, col]) and upper_triangle.loc[idx, col] > threshold:
                high_corr_pairs.append((idx, col, upper_triangle.loc[idx, col]))
    
    print(f"–ù–∞–π–¥–µ–Ω–æ {len(high_corr_pairs)} –ø–∞—Ä —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π > {threshold}:")
    for var1, var2, corr in high_corr_pairs:
        print(f"  {var1} ‚Üî {var2}: {corr:.3f}")
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É–¥–∞–ª–∏—Ç—å
    to_drop = set()
    
    for var1, var2, corr in high_corr_pairs:
        if var1 in to_drop or var2 in to_drop:
            continue
            
        if method == 'first':
            # –£–¥–∞–ª—è–µ–º –≤—Ç–æ—Ä–æ–π –ø—Ä–∏–∑–Ω–∞–∫ (–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä)
            to_drop.add(var2)
        elif method == 'target_corr' and target_col:
            # –£–¥–∞–ª—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫ —Å –º–µ–Ω—å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
            corr1 = abs(df[var1].corr(df[target_col]))
            corr2 = abs(df[var2].corr(df[target_col]))
            if corr1 >= corr2:
                to_drop.add(var2)
            else:
                to_drop.add(var1)
        elif method == 'random':
            # –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä
            to_drop.add(np.random.choice([var1, var2]))

        #TODO: –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤—ã–±–æ—Ä–∞ –ø–æ VIF:
        #elif method == 'VIF':
        #–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å:

        else:
            # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —É–¥–∞–ª—è–µ–º –≤—Ç–æ—Ä–æ–π
            to_drop.add(var2)
    
    to_drop_list = list(to_drop)
    print(f"\n–ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è ({method}): {to_drop_list}")
    
    # –°–æ–∑–¥–∞–µ–º –æ—á–∏—â–µ–Ω–Ω—ã–π DataFrame
    cleaned_df = df.drop(columns=to_drop_list)
    
    return cleaned_df, to_drop_list

# –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
np.random.seed(42)
n = 500

# –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
area = np.random.randint(30, 150, n)
rooms = np.random.choice([1, 2, 3, 4, 5], n, p=[0.1, 0.3, 0.4, 0.15, 0.05])
floor = np.random.randint(1, 16, n)
year_built = np.random.randint(1980, 2024, n)

# –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ (–∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ) –ø—Ä–∏–∑–Ω–∞–∫–∏
area_sqft = area * 10.764  # –ü–ª–æ—â–∞–¥—å –≤ –∫–≤. —Ñ—É—Ç–∞—Ö
age = 2025 - year_built  # –í–æ–∑—Ä–∞—Å—Ç –∑–¥–∞–Ω–∏—è
area_per_room = area / rooms  # –ü–ª–æ—â–∞–¥—å –Ω–∞ –∫–æ–º–Ω–∞—Ç—É

# –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
price = (area * 100000 + rooms * 500000 + (year_built - 1980) * 10000 + 
         np.random.normal(0, 1000000, n))

df = pd.DataFrame({
    '–ø–ª–æ—â–∞–¥—å_–º2': area,
    '–∫–æ–º–Ω–∞—Ç—ã': rooms,
    '—ç—Ç–∞–∂': floor,
    '–≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏': year_built,
    '–ø–ª–æ—â–∞–¥—å_—Ñ—É—Ç—ã': area_sqft,  # –ü–†–û–ë–õ–ï–ú–ê: –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –ø–ª–æ—â–∞–¥—å_–º2
    '–≤–æ–∑—Ä–∞—Å—Ç_–ª–µ—Ç': age,  # –ü–†–û–ë–õ–ï–ú–ê: –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏
    '–º2_–Ω–∞_–∫–æ–º–Ω–∞—Ç—É': area_per_room,  # –ü–†–û–ë–õ–ï–ú–ê: —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –ø–ª–æ—â–∞–¥—å_–º2 –∏ –∫–æ–º–Ω–∞—Ç—ã
    '—Ü–µ–Ω–∞': price
})

print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(df.head())
print(f"–†–∞–∑–º–µ—Ä: {df.shape}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–æ –æ—á–∏—Å—Ç–∫–∏
correlation_matrix = df.corr()
plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0, 
            square=True, linewidths=0.5, fmt='.2f')
plt.title('–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –î–û –æ—á–∏—Å—Ç–∫–∏')
plt.show()

# –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
print("\n" + "="*50)
print("–°–¢–†–ê–¢–ï–ì–ò–Ø 1: –£–¥–∞–ª–µ–Ω–∏–µ '–ø–µ—Ä–≤–æ–≥–æ' –≤ –ø–∞—Ä–µ")
df_cleaned_1, dropped_1 = remove_correlated_features(df, '—Ü–µ–Ω–∞', threshold=0.8, method='first')

print("\n" + "="*50) 
print("–°–¢–†–ê–¢–ï–ì–ò–Ø 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å –±–æ–ª—å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π")
df_cleaned_2, dropped_2 = remove_correlated_features(df, '—Ü–µ–Ω–∞', threshold=0.8, method='target_corr')

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
print(f"\n–°–†–ê–í–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")
print(f"–ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä: {df.shape}")
print(f"–ü–æ—Å–ª–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ 1: {df_cleaned_1.shape}, —É–¥–∞–ª–µ–Ω–æ: {dropped_1}")
print(f"–ü–æ—Å–ª–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ 2: {df_cleaned_2.shape}, —É–¥–∞–ª–µ–Ω–æ: {dropped_2}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º VIF –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏
def calculate_vif_safe(dataframe):
    """–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ VIF —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫"""
    try:
        features = dataframe.select_dtypes(include=[np.number])
        if '—Ü–µ–Ω–∞' in features.columns:
            features = features.drop(columns=['—Ü–µ–Ω–∞'])
        
        if features.shape[1] == 0:
            return pd.DataFrame()
            
        vif_data = pd.DataFrame()
        vif_data["–ü—Ä–∏–∑–Ω–∞–∫"] = features.columns
        vif_data["VIF"] = [variance_inflation_factor(features.values, i) 
                          for i in range(features.shape[1])]
        return vif_data.sort_values('VIF', ascending=False)
    except:
        return pd.DataFrame()

vif_after_1 = calculate_vif_safe(df_cleaned_1)
vif_after_2 = calculate_vif_safe(df_cleaned_2)

print(f"\nVIF –ü–û–°–õ–ï –û–ß–ò–°–¢–ö–ò (–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1):")
if not vif_after_1.empty:
    print(vif_after_1.round(2))
else:
    print("–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å VIF")

print(f"\nVIF –ü–û–°–õ–ï –û–ß–ò–°–¢–ö–ò (–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2):")
if not vif_after_2.empty:
    print(vif_after_2.round(2))
else:
    print("–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å VIF")

#TODO: –≤—ã–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Ç—Ä–µ—Ç—å–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (–ø–æ –∑–Ω–∞—á–µ–Ω–∏—é VIF)

```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

@img_sem03(corr_matrix1.png, –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, 60)

**–ó–∞–¥–∞–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤—ã–±–æ—Ä–∞ –ø–æ –Ω–∞–∏–±–æ–ª—å—à–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é VIF.

<details>
<summary>**~~üéØ –í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ~~**</summary>

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import statsmodels
except ImportError:
    install_package("statsmodels")

import pandas as pd
import numpy as np
from statsmodels.stats.outliers_influence import variance_inflation_factor
import matplotlib.pyplot as plt
import seaborn as sns

def remove_correlated_features(df, target_col=None, threshold=0.8, method='first'):
    """
    –£–¥–∞–ª—è–µ—Ç —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
    
    Parameters:
    -----------
    df : DataFrame
        –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    target_col : str, optional
        –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    threshold : float, default=0.8
        –ü–æ—Ä–æ–≥ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    method : str, default='first'
        –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–±–æ—Ä–∞: 'first', 'target_corr', 'random', 'VIF'
    
    Returns:
    --------
    DataFrame –±–µ–∑ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    list —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    """
    
    # –ò—Å–∫–ª—é—á–∞–µ–º —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
    if target_col and target_col in df.columns:
        features = df.drop(columns=[target_col])
    else:
        features = df.copy()
    
    corr_matrix = features.corr().abs()
    
    # –ù–∞—Ö–æ–¥–∏–º –≤–µ—Ä—Ö–Ω–∏–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –º–∞—Ç—Ä–∏—Ü—ã (–∏–∑–±–µ–≥–∞–µ–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
    upper_triangle = corr_matrix.where(
        np.triu(np.ones_like(corr_matrix, dtype=bool), k=1)
    )
    
    # –ù–∞—Ö–æ–¥–∏–º –ø–∞—Ä—ã —Å –≤—ã—Å–æ–∫–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π
    high_corr_pairs = []
    for col in upper_triangle.columns:
        for idx in upper_triangle.index:
            if pd.notna(upper_triangle.loc[idx, col]) and upper_triangle.loc[idx, col] > threshold:
                high_corr_pairs.append((idx, col, upper_triangle.loc[idx, col]))
    
    print(f"–ù–∞–π–¥–µ–Ω–æ {len(high_corr_pairs)} –ø–∞—Ä —Å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π > {threshold}:")
    for var1, var2, corr in high_corr_pairs:
        print(f"  {var1} ‚Üî {var2}: {corr:.3f}")
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É–¥–∞–ª–∏—Ç—å
    to_drop = set()
    
    # –í—ã—á–∏—Å–ª—è–µ–º VIF –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–¥–∏–Ω —Ä–∞–∑, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è VIF
    if method == 'VIF':
        vif_data = pd.DataFrame()
        vif_data["feature"] = features.columns
        vif_data["VIF"] = [variance_inflation_factor(features.values, i) 
                          for i in range(features.shape[1])]
        vif_data = vif_data.set_index("feature")
    
    for var1, var2, corr in high_corr_pairs:
        if var1 in to_drop or var2 in to_drop:
            continue
            
        if method == 'first':
            # –£–¥–∞–ª—è–µ–º –≤—Ç–æ—Ä–æ–π –ø—Ä–∏–∑–Ω–∞–∫ (–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä)
            to_drop.add(var2)
        elif method == 'target_corr' and target_col:
            # –£–¥–∞–ª—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫ —Å –º–µ–Ω—å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
            corr1 = abs(df[var1].corr(df[target_col]))
            corr2 = abs(df[var2].corr(df[target_col]))
            if corr1 >= corr2:
                to_drop.add(var2)
            else:
                to_drop.add(var1)
        elif method == 'random':
            # –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä
            to_drop.add(np.random.choice([var1, var2]))
        elif method == 'VIF':
            # –£–¥–∞–ª—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫ —Å –±–æ–ª—å—à–∏–º VIF
            vif1 = vif_data.loc[var1, "VIF"]
            vif2 = vif_data.loc[var2, "VIF"]
            if vif1 >= vif2:
                to_drop.add(var1)
            else:
                to_drop.add(var2)
        else:
            # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —É–¥–∞–ª—è–µ–º –≤—Ç–æ—Ä–æ–π
            to_drop.add(var2)
    
    to_drop_list = list(to_drop)
    print(f"\n–ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è ({method}): {to_drop_list}")
    
    # –°–æ–∑–¥–∞–µ–º –æ—á–∏—â–µ–Ω–Ω—ã–π DataFrame
    cleaned_df = df.drop(columns=to_drop_list)
    
    return cleaned_df, to_drop_list

# –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
np.random.seed(42)
n = 500

# –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
area = np.random.randint(30, 150, n)
rooms = np.random.choice([1, 2, 3, 4, 5], n, p=[0.1, 0.3, 0.4, 0.15, 0.05])
floor = np.random.randint(1, 16, n)
year_built = np.random.randint(1980, 2024, n)

# –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ (–∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ) –ø—Ä–∏–∑–Ω–∞–∫–∏
area_sqft = area * 10.764  # –ü–ª–æ—â–∞–¥—å –≤ –∫–≤. —Ñ—É—Ç–∞—Ö
age = 2025 - year_built  # –í–æ–∑—Ä–∞—Å—Ç –∑–¥–∞–Ω–∏—è
area_per_room = area / rooms  # –ü–ª–æ—â–∞–¥—å –Ω–∞ –∫–æ–º–Ω–∞—Ç—É

# –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
price = (area * 100000 + rooms * 500000 + (year_built - 1980) * 10000 + 
         np.random.normal(0, 1000000, n))

df = pd.DataFrame({
    '–ø–ª–æ—â–∞–¥—å_–º2': area,
    '–∫–æ–º–Ω–∞—Ç—ã': rooms,
    '—ç—Ç–∞–∂': floor,
    '–≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏': year_built,
    '–ø–ª–æ—â–∞–¥—å_—Ñ—É—Ç—ã': area_sqft,  # –ü–†–û–ë–õ–ï–ú–ê: –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –ø–ª–æ—â–∞–¥—å_–º2
    '–≤–æ–∑—Ä–∞—Å—Ç_–ª–µ—Ç': age,  # –ü–†–û–ë–õ–ï–ú–ê: –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –≥–æ–¥_–ø–æ—Å—Ç—Ä–æ–π–∫–∏
    '–º2_–Ω–∞_–∫–æ–º–Ω–∞—Ç—É': area_per_room,  # –ü–†–û–ë–õ–ï–ú–ê: —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –ø–ª–æ—â–∞–¥—å_–º2 –∏ –∫–æ–º–Ω–∞—Ç—ã
    '—Ü–µ–Ω–∞': price
})

print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(df.head())
print(f"–†–∞–∑–º–µ—Ä: {df.shape}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–æ –æ—á–∏—Å—Ç–∫–∏
correlation_matrix = df.corr()
plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', center=0, 
            square=True, linewidths=0.5, fmt='.2f')
plt.title('–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –î–û –æ—á–∏—Å—Ç–∫–∏')
plt.show()

# –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
print("\n" + "="*50)
print("–°–¢–†–ê–¢–ï–ì–ò–Ø 1: –£–¥–∞–ª–µ–Ω–∏–µ '–ø–µ—Ä–≤–æ–≥–æ' –≤ –ø–∞—Ä–µ")
df_cleaned_1, dropped_1 = remove_correlated_features(df, '—Ü–µ–Ω–∞', threshold=0.8, method='first')

print("\n" + "="*50) 
print("–°–¢–†–ê–¢–ï–ì–ò–Ø 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å –±–æ–ª—å—à–µ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π")
df_cleaned_2, dropped_2 = remove_correlated_features(df, '—Ü–µ–Ω–∞', threshold=0.8, method='target_corr')

print("\n" + "="*50) 
print("–°–¢–†–ê–¢–ï–ì–ò–Ø 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å –º–µ–Ω—å—à–∏–º VIF")
df_cleaned_3, dropped_3 = remove_correlated_features(df, '—Ü–µ–Ω–∞', threshold=0.8, method='VIF')

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
print(f"\n–°–†–ê–í–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")
print(f"–ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä: {df.shape}")
print(f"–ü–æ—Å–ª–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ 1: {df_cleaned_1.shape}, —É–¥–∞–ª–µ–Ω–æ: {dropped_1}")
print(f"–ü–æ—Å–ª–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ 2: {df_cleaned_2.shape}, —É–¥–∞–ª–µ–Ω–æ: {dropped_2}")
print(f"–ü–æ—Å–ª–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ 3: {df_cleaned_3.shape}, —É–¥–∞–ª–µ–Ω–æ: {dropped_3}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º VIF –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏
def calculate_vif_safe(dataframe):
    """–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ VIF —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫"""
    try:
        features = dataframe.select_dtypes(include=[np.number])
        if '—Ü–µ–Ω–∞' in features.columns:
            features = features.drop(columns=['—Ü–µ–Ω–∞'])
        
        if features.shape[1] == 0:
            return pd.DataFrame()
            
        vif_data = pd.DataFrame()
        vif_data["–ü—Ä–∏–∑–Ω–∞–∫"] = features.columns
        vif_data["VIF"] = [variance_inflation_factor(features.values, i) 
                          for i in range(features.shape[1])]
        return vif_data.sort_values('VIF', ascending=False)
    except:
        return pd.DataFrame()

vif_after_1 = calculate_vif_safe(df_cleaned_1)
vif_after_2 = calculate_vif_safe(df_cleaned_2)
vif_after_3 = calculate_vif_safe(df_cleaned_3)

print(f"\nVIF –ü–û–°–õ–ï –û–ß–ò–°–¢–ö–ò (–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1):")
if not vif_after_1.empty:
    print(vif_after_1.round(2))
else:
    print("–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å VIF")

print(f"\nVIF –ü–û–°–õ–ï –û–ß–ò–°–¢–ö–ò (–°—Ç—Ä–∞—Ç–µ–≥–∏—è 2):")
if not vif_after_2.empty:
    print(vif_after_2.round(2))
else:
    print("–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å VIF")

print(f"\nVIF –ü–û–°–õ–ï –û–ß–ò–°–¢–ö–ò (–°—Ç—Ä–∞—Ç–µ–≥–∏—è 3 - VIF):")
if not vif_after_3.empty:
    print(vif_after_3.round(2))
else:
    print("–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å VIF")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

2. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Feature Engineering)**
----

–í–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å.

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:**

1. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —Ä–∞–∑–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –æ–±—â–µ–º—É –º–∞—Å—à—Ç–∞–±—É
3. –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
4. –ê–≥—Ä–µ–≥–∞—Ü–∏—è ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫ –≤ –æ–¥–Ω—É

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ö–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–π —Å–º—ã—Å–ª, –Ω–æ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã
- –í–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ï—Å—Ç—å –¥–æ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π

**‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –¢—Ä–µ–±—É–µ—Ç —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–æ–∑–¥–∞–Ω–∏—é —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –ù–µ –≤—Å–µ–≥–¥–∞ –æ—á–µ–≤–∏–¥–Ω–æ, –∫–∞–∫–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å

---
**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –ø–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º.

–£ –Ω–∞—Å –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–∞—Ü–∏–µ–Ω—Ç–∞—Ö: —Ä–æ—Å—Ç, –≤–µ—Å –∏ –≤–æ–∑—Ä–∞—Å—Ç. –≠—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç –º–µ–∂–¥—É —Å–æ–±–æ–π, –Ω–æ –∫–∞–∂–¥—ã–π –≤–∞–∂–µ–Ω! –ü—Ä–æ—Å—Ç–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ª—é–±–æ–≥–æ –∏–∑ –Ω–∏—Ö –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–æ—Ç–µ—Ä–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –°–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç—Ä–∞–∂–∞—é—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import statsmodels
except ImportError:
    install_package("statsmodels")

import pandas as pd
import numpy as np
from statsmodels.stats.outliers_influence import variance_inflation_factor

# –°–æ–∑–¥–∞–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
np.random.seed(42)
n = 300

# –ë–∞–∑–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç!)
height = np.random.normal(170, 10, n)  # –†–æ—Å—Ç –≤ —Å–º
age = np.random.randint(20, 80, n)     # –í–æ–∑—Ä–∞—Å—Ç
# –í–µ—Å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–æ—Å—Ç–∞ –∏ –≤–æ–∑—Ä–∞—Å—Ç–∞
weight = 0.5 * height - 20 + 0.2 * age + np.random.normal(0, 10, n)

# –†–∏—Å–∫ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Å–µ—Ö —Ç—Ä–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –ø–æ-—Ä–∞–∑–Ω–æ–º—É
health_risk = (abs(weight/(height/100)**2 - 22) * 2 +  # –ò–ú–¢ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –Ω–æ—Ä–º—ã
               (age - 40) * 0.1 +                      # –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä
               abs(height - 170) * 0.05 +              # –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Ä–æ—Å—Ç–∞
               np.random.normal(0, 3, n))

df = pd.DataFrame({
    '—Ä–æ—Å—Ç_—Å–º': height,
    '–≤–µ—Å_–∫–≥': weight, 
    '–≤–æ–∑—Ä–∞—Å—Ç_–ª–µ—Ç': age,
    '—Ä–∏—Å–∫_–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π': health_risk
})

print("–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:")
print(df.head())

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å
def calculate_vif(dataframe, exclude_col='—Ä–∏—Å–∫_–∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π'):
    features = dataframe.drop(columns=[exclude_col])
    vif_data = pd.DataFrame()
    vif_data["–ü—Ä–∏–∑–Ω–∞–∫"] = features.columns
    vif_data["VIF"] = [variance_inflation_factor(features.values, i) 
                      for i in range(features.shape[1])]
    return vif_data.sort_values('VIF', ascending=False)

print("\n–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:")
corr_matrix = df[['—Ä–æ—Å—Ç_—Å–º', '–≤–µ—Å_–∫–≥', '–≤–æ–∑—Ä–∞—Å—Ç_–ª–µ—Ç']].corr()
print(corr_matrix.round(3))

print("\nVIF –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏:")
vif_before = calculate_vif(df)
print(vif_before.round(2))

# Feature Engineering: —Å–æ–∑–¥–∞–µ–º –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
df_new = df.copy()

# 1. –ò–ú–¢ (–∏–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) - –∫–ª—é—á–µ–≤–æ–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å
df_new['–ò–ú–¢'] = df_new['–≤–µ—Å_–∫–≥'] / (df_new['—Ä–æ—Å—Ç_—Å–º'] / 100) ** 2

# 2. –í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞ (–≤–º–µ—Å—Ç–æ —Ç–æ—á–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞)
df_new['–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞'] = pd.cut(df_new['–≤–æ–∑—Ä–∞—Å—Ç_–ª–µ—Ç'], 
                                     bins=[0, 30, 50, 70, 100], 
                                     labels=['–º–æ–ª–æ–¥–æ–π', '—Å—Ä–µ–¥–Ω–∏–π', '–ø–æ–∂–∏–ª–æ–π', '—Å—Ç–∞—Ä—ã–π'])

# 3. –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏—è
df_new['—Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'] = '–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ'
df_new.loc[df_new['–ò–ú–¢'] < 18.5, '—Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'] = '–Ω–µ–¥–æ–≤–µ—Å'
df_new.loc[df_new['–ò–ú–¢'] > 25, '—Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'] = '–∏–∑–±—ã—Ç–æ—á–Ω—ã–π_–≤–µ—Å'
df_new.loc[df_new['–ò–ú–¢'] > 30, '—Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'] = '–æ–∂–∏—Ä–µ–Ω–∏–µ'

# –£–¥–∞–ª—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
df_final = df_new.drop(columns=['—Ä–æ—Å—Ç_—Å–º', '–≤–µ—Å_–∫–≥', '–≤–æ–∑—Ä–∞—Å—Ç_–ª–µ—Ç'])

print("\n–î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ feature engineering:")
print(df_final.head())

# –ö–æ–¥–∏—Ä—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è VIF
from sklearn.preprocessing import LabelEncoder
df_for_vif = df_final.copy()
le1 = LabelEncoder()
le2 = LabelEncoder()
df_for_vif['–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞'] = le1.fit_transform(df_for_vif['–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è_–≥—Ä—É–ø–ø–∞'])
df_for_vif['—Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'] = le2.fit_transform(df_for_vif['—Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'])

print("\nVIF –ø–æ—Å–ª–µ feature engineering:")
vif_after = calculate_vif(df_for_vif)
print(vif_after.round(2))
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

–ü–æ—á–µ–º—É –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ Feature Engineering –ª—É—á—à–µ –ø—Ä–æ—Å—Ç–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

- –†–æ—Å—Ç, –≤–µ—Å, –≤–æ–∑—Ä–∞—Å—Ç - –≤—Å–µ –≤–∞–∂–Ω—ã –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- –ò–ú–¢ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–æ—Å—Ç –∏ –≤–µ—Å –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å
- –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç–∞ –±–µ–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- –ù–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ–Ω—è—Ç–Ω—ã –≤—Ä–∞—á–∞–º –∏ –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã

3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ PCA (Principal Component Analysis)**
----

**PCA (–ê–Ω–∞–ª–∏–∑ –≥–ª–∞–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)** ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ —Å–Ω–∏–∂–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–≥–ª–∞–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã) –∫–∞–∫ –ª–∏–Ω–µ–π–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∏—Å—Ö–æ–¥–Ω—ã—Ö. –ì–ª–∞–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ã –¥—Ä—É–≥ –¥—Ä—É–≥—É, —á—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç PCA:**

1. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Å—Ä–µ–¥–Ω–µ–µ $= 0$, –¥–∏—Å–ø–µ—Ä—Å–∏—è $= 1$)
2. –í—ã—á–∏—Å–ª—è–µ—Ç –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É
3. –ù–∞—Ö–æ–¥–∏—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
4. –†–∞–Ω–∂–∏—Ä—É–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ –æ–±—ä—è—Å–Ω—è–µ–º–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏
5. –í—ã–±–∏—Ä–∞–µ—Ç —Ç–æ–ø-$K$ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏

**‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –ú–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å –≤—ã—Å–æ–∫–æ–π –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é
- –ù—É–∂–Ω–æ —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ —Å–Ω–∏–∑–∏—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∑–∞–¥–∞—á–∞—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è)
- –¢—Ä–µ–±—É–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏

**‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –ü–æ—Ç–µ—Ä—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ ‚Äî –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å–ª–æ–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –±–∏–∑–Ω–µ—Å—É
- –õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è ‚Äî –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏  
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –º–∞—Å—à—Ç–∞–±—É ‚Äî —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏
- –ü–æ—Ç–µ—Ä—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ ‚Äî –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —Ç–µ—Ä—è–µ—Ç—Å—è —á–∞—Å—Ç—å –¥–∏—Å–ø–µ—Ä—Å–∏–∏

---
**üìã –ü—Ä–∏–º–µ—Ä.** –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ PCA –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ —Å –∞–Ω–∞–ª–∏–∑–æ–º –æ–±—ä—è—Å–Ω—è–µ–º–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏.

–ü—Ä–∏–º–µ–Ω–∏–º PCA –∫ –¥–∞–Ω–Ω—ã–º —Å —Å–∏–ª—å–Ω–æ–π –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º, —Å–∫–æ–ª—å–∫–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω—É–∂–Ω–æ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è $95\%$ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ü–æ–∫–∞–∂–µ–º, –∫–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–ª–∞–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ –∏—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")
try:
    import seaborn
except ImportError:
    install_package("seaborn")

from sklearn.decomposition import PCA
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_absolute_error
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Å–∏–ª—å–Ω–æ–π –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é
np.random.seed(42)
n = 800

# –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
experience = np.random.randint(1, 21, n)
education = np.random.randint(12, 21, n)  # –õ–µ—Ç –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
performance = np.random.normal(3.5, 0.8, n)  # –û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

# –ó–∞—Ä–ø–ª–∞—Ç–∞ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
salary = (30000 + experience * 2500 + education * 3000 + performance * 8000 + 
          np.random.normal(0, 7000, n))

# –°–æ–∑–¥–∞–µ–º –ú–ù–û–ì–û –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–∏–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞)
df_multicollinear = pd.DataFrame({
    '–æ–ø—ã—Ç_–ª–µ—Ç': experience,
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_–ª–µ—Ç': education,
    '–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å': performance,
    '–æ–ø—ã—Ç_–º–µ—Å—è—Ü—ã': experience * 12,  # –ò–¥–µ–∞–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è
    '–æ–ø—ã—Ç_–Ω–µ–¥–µ–ª–∏': experience * 52,  # –ò–¥–µ–∞–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è  
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_–±–∞–ª–ª': education * 10,  # –õ–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
    '–∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è': experience + education,  # –°—É–º–º–∞ –¥–≤—É—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    '–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å_100': performance * 100,  # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
    '–æ–±—â–∏–π_—Å–∫–æ—Ä': experience + education + performance,  # –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫
    '–æ–ø—ã—Ç_–≤_–∫–≤–∞–¥—Ä–∞—Ç–µ': experience ** 2,  # –ù–µ–ª–∏–Ω–µ–π–Ω–∞—è, –Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∞—è
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ_–Ω–æ—Ä–º': education / 20,  # –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
    '—Å–ª–æ–∂–Ω—ã–π_–ø—Ä–∏–∑–Ω–∞–∫': 0.6 * experience + 0.4 * education + np.random.normal(0, 2, n),
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': salary
})

print("–î–∞–Ω–Ω—ã–µ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é:")
print(df_multicollinear.head())
print(f"–†–∞–∑–º–µ—Ä: {df_multicollinear.shape}")

# –í—ã–¥–µ–ª—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
X = df_multicollinear.drop('–∑–∞—Ä–ø–ª–∞—Ç–∞', axis=1)
y = df_multicollinear['–∑–∞—Ä–ø–ª–∞—Ç–∞']

print(f"\n–ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è PCA: {list(X.columns)}")

# –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –î–û PCA
correlation_matrix = X.corr()
print(f"\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –î–û PCA:")
high_corr_pairs = 0
for i in range(len(correlation_matrix.columns)):
    for j in range(i+1, len(correlation_matrix.columns)):
        if abs(correlation_matrix.iloc[i, j]) > 0.8:
            high_corr_pairs += 1

print(f"–ü–∞—Ä —Å |–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è| > 0.8: {high_corr_pairs}")
print(f"–°—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è: {correlation_matrix.abs().values[np.triu_indices_from(correlation_matrix.values, k=1)].mean():.3f}")

# –†–∞–∑–¥–µ–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è PCA!)
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

print(f"\n–î–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è PCA")

# –ü—Ä–∏–º–µ–Ω—è–µ–º PCA —Å –∞–Ω–∞–ª–∏–∑–æ–º –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
pca_full = PCA()
pca_full.fit(X_train_scaled)

explained_variance = pca_full.explained_variance_ratio_
cumulative_variance = np.cumsum(explained_variance)

print(f"\nüìä –ê–ù–ê–õ–ò–ó –ì–õ–ê–í–ù–´–• –ö–û–ú–ü–û–ù–ï–ù–¢:")
print("–ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –î–∏—Å–ø–µ—Ä—Å–∏—è | –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ")
print("-" * 35)
for i, (individual, cumulative) in enumerate(zip(explained_variance, cumulative_variance)):
    print(f"   PC{i+1:2d}    |   {individual:.3f}   |    {cumulative:.3f}")
    if i >= 9:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 10
        break

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è 95% –¥–∏—Å–ø–µ—Ä—Å–∏–∏
n_components_95 = np.argmax(cumulative_variance >= 0.95) + 1
n_components_90 = np.argmax(cumulative_variance >= 0.90) + 1

print(f"\n–î–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è 90% –¥–∏—Å–ø–µ—Ä—Å–∏–∏: {n_components_90} –∫–æ–º–ø–æ–Ω–µ–Ω—Ç")
print(f"–î–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è 95% –¥–∏—Å–ø–µ—Ä—Å–∏–∏: {n_components_95} –∫–æ–º–ø–æ–Ω–µ–Ω—Ç")
print(f"–ò—Å—Ö–æ–¥–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: {X.shape[1]}")
print(f"–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏: {X.shape[1]} ‚Üí {n_components_95} (—ç–∫–æ–Ω–æ–º–∏—è {((X.shape[1] - n_components_95) / X.shape[1] * 100):.1f}%)")

# –ü—Ä–∏–º–µ–Ω—è–µ–º PCA —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
pca_reduced = PCA(n_components=n_components_95)
X_train_pca = pca_reduced.fit_transform(X_train_scaled)
X_test_pca = pca_reduced.transform(X_test_scaled)

# –°–æ–∑–¥–∞–µ–º DataFrame —Å PCA –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
df_pca = pd.DataFrame(
    X_train_pca,
    columns=[f'PC{i+1}' for i in range(n_components_95)]
)

print(f"\n–î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ PCA:")
print(df_pca.head())

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–û–°–õ–ï PCA
pca_correlations = df_pca.corr()
max_pca_corr = pca_correlations.abs().values[np.triu_indices_from(pca_correlations.values, k=1)].max()
print(f"\n–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É PCA –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏: {max_pca_corr:.6f}")
print("‚úÖ PCA —Å–æ–∑–¥–∞–µ—Ç –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ‚Üí –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞!")

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π
print(f"\nüîç –°–†–ê–í–ù–ï–ù–ò–ï –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò –ú–û–î–ï–õ–ï–ô:")

# –ú–æ–¥–µ–ª—å –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
lr_original = LinearRegression()
lr_original.fit(X_train_scaled, y_train)
y_pred_original = lr_original.predict(X_test_scaled)
r2_original = r2_score(y_test, y_pred_original)
mae_original = mean_absolute_error(y_test, y_pred_original)

# –ú–æ–¥–µ–ª—å –Ω–∞ PCA –¥–∞–Ω–Ω—ã—Ö
lr_pca = LinearRegression()
lr_pca.fit(X_train_pca, y_train)
y_pred_pca = lr_pca.predict(X_test_pca)
r2_pca = r2_score(y_test, y_pred_pca)
mae_pca = mean_absolute_error(y_test, y_pred_pca)

print(f"–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ     - R¬≤: {r2_original:.4f}, MAE: {mae_original:.0f}")
print(f"–ü–æ—Å–ª–µ PCA ({n_components_95} –∫–æ–º–ø–æ–Ω–µ–Ω—Ç) - R¬≤: {r2_pca:.4f}, MAE: {mae_pca:.0f}")
print(f"–ü–æ—Ç–µ—Ä—è –∫–∞—á–µ—Å—Ç–≤–∞: R¬≤ {r2_original - r2_pca:.4f}, MAE +{mae_pca - mae_original:.0f}")

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≥–ª–∞–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
print(f"\nüîç –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–Ø –ì–õ–ê–í–ù–´–• –ö–û–ú–ü–û–ù–ï–ù–¢:")
components_df = pd.DataFrame(
    pca_reduced.components_[:3].T,  # –ü–µ—Ä–≤—ã–µ 3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    columns=['PC1', 'PC2', 'PC3'],
    index=X.columns
)

print("–í–∫–ª–∞–¥ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –ø–µ—Ä–≤—ã–µ 3 –≥–ª–∞–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:")
print(components_df.round(3))

# –ù–∞—Ö–æ–¥–∏–º –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
for i, pc in enumerate(['PC1', 'PC2', 'PC3'], 1):
    top_features = components_df[pc].abs().sort_values(ascending=False).head(3)
    print(f"\nPC{i} –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è:")
    for feature, weight in top_features.items():
        print(f"  {feature}: {weight:.3f}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä—è—Å–Ω—è–µ–º–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏
plt.figure(figsize=(12, 5))

plt.subplot(1, 2, 1)
plt.plot(range(1, len(explained_variance) + 1), explained_variance, 'bo-')
plt.axhline(y=0.1, color='r', linestyle='--', alpha=0.7)
plt.xlabel('–ù–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞')
plt.ylabel('–î–æ–ª—è –æ–±—ä—è—Å–Ω—è–µ–º–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏')
plt.title('–û–±—ä—è—Å–Ω—è–µ–º–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º')
plt.grid(True, alpha=0.3)

plt.subplot(1, 2, 2)
plt.plot(range(1, len(cumulative_variance) + 1), cumulative_variance, 'ro-')
plt.axhline(y=0.95, color='g', linestyle='--', alpha=0.7, label='95%')
plt.axhline(y=0.90, color='orange', linestyle='--', alpha=0.7, label='90%')
plt.xlabel('–ù–æ–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞')
plt.ylabel('–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è')
plt.title('–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—ä—è—Å–Ω—è–µ–º–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è')
plt.legend()
plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏

| –ú–µ—Ç–æ–¥ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ü–æ—Ç–µ—Ä—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-------|-----------|-------------------|-------------------|-------------------|
| **–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è | –ü—Ä–æ—Å—Ç—ã–µ —Å–ª—É—á–∞–∏, —è—Å–Ω—ã–µ –¥—É–±–ª–∏ |
| **Feature Engineering** | –í—ã—Å–æ–∫–∞—è | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è | –ï—Å—Ç—å –¥–æ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è |
| **PCA** | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–∞—è | –ú–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –Ω–µ –≤–∞–∂–Ω–∞ |

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å –∞–Ω–∞–ª–∏–∑–∞** ‚Äî –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∏ VIF –ø–æ–∫–∞–∂—É—Ç –º–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã

2. **–í—ã–±–∏—Ä–∞–π—Ç–µ –º–µ—Ç–æ–¥ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:**

   - –ë–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ ‚Üí —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–ª–∏ feature engineering  
   - –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ ‚Üí PCA
   - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏ ‚Üí feature engineering

3. **–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –ø–æ–¥—Ö–æ–¥—ã:**

   - –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç–µ –æ—á–µ–≤–∏–¥–Ω—ã–µ –¥—É–±–ª–∏
   - –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–π—Ç–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
   - –í –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ PCA

4. **–û—Ü–µ–Ω–∏–≤–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ VIF –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –°—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –¥–æ/–ø–æ—Å–ª–µ
   - –£–±–µ–∂–¥–∞–π—Ç–µ—Å—å, —á—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø–æ–Ω—è—Ç–Ω–æ –±–∏–∑–Ω–µ—Å—É

@quizQuestion(`–ö–∞–∫–æ–π –º–µ—Ç–æ–¥ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –ª—É—á—à–µ –≤—ã–±—Ä–∞—Ç—å, –µ—Å–ª–∏ –≤–∞–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞?`)

<!-- data-randomize -->
[( )] PCA
[(X)] Feature Engineering  
[( )] –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
[( )] –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

---
**üìã –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã.** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö HR-–æ—Ç–¥–µ–ª–∞

–í–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö IT-–∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã. –í –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π, –Ω–æ –Ω–µ —è–≤–ª—è—é—Ç—Å—è —Ç–æ—á–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

**–í–∞—à–∞ –∑–∞–¥–∞—á–∞:**

1. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ VIF
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≥—Ä—É–ø–ø—ã —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
3. –†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –±–∏–∑–Ω–µ—Å-—Å–º—ã—Å–ª–∞
4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ –æ—Ü–µ–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
5. –°—Ä–∞–≤–Ω–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –¥–æ –∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è:**

- –í—Å–µ VIF $< 5$
- –ü–æ—Ç–µ—Ä—è –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ $< 5\%$
- –ù–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–º–µ—é—Ç –±–∏–∑–Ω–µ—Å-—Å–º—ã—Å–ª

```python
import pandas as pd
import numpy as np

# –î–∞–Ω–Ω—ã–µ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö IT-–∫–æ–º–ø–∞–Ω–∏–∏
np.random.seed(42)
n = 500

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
years_experience = np.random.uniform(0.5, 15, n)
projects_completed = (years_experience * 2 + np.random.normal(3, 2, n)).clip(1, 30)
technical_score = (40 + years_experience * 3 + projects_completed * 0.8 + 
                  np.random.normal(0, 8, n)).clip(0, 100)
leadership_score = (20 + years_experience * 2.5 + np.random.normal(0, 15, n)).clip(0, 100)
languages_known = (2 + years_experience * 0.4 + np.random.normal(0, 1.5, n)).clip(1, 8)
certifications = (years_experience * 0.3 + np.random.exponential(1, n)).clip(0, 10)
communication_score = (30 + leadership_score * 0.3 + np.random.normal(0, 20, n)).clip(0, 100)

# –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
salary = (30000 + 
          years_experience * 8000 +
          technical_score * 400 + 
          leadership_score * 200 +
          projects_completed * 500 +
          languages_known * 2000 +
          certifications * 1500 +
          communication_score * 100 +
          np.random.normal(0, 10000, n))

df_hr = pd.DataFrame({
    '–æ–ø—ã—Ç_–ª–µ—Ç': years_experience,
    '–ø—Ä–æ–µ–∫—Ç—ã': projects_completed,
    '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞': technical_score,
    '–ª–∏–¥–µ—Ä—Å—Ç–≤–æ': leadership_score,
    '—è–∑—ã–∫–∏_–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è': languages_known,
    '—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã': certifications,
    '–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è': communication_score,
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': salary
})

print("–î–∞–Ω–Ω—ã–µ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö:")
print(df_hr.head())
print(f"–†–∞–∑–º–µ—Ä: {df_hr.shape}")
print("\n–û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
print(df_hr.describe().round(2))

# TODO: –í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –∑–¥–µ—Å—å
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

**–ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è:**

<details>
<summary>**~~üí° –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º~~**</summary>

```python
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ VIF
def calculate_vif(dataframe, exclude_col='–∑–∞—Ä–ø–ª–∞—Ç–∞'):
    from statsmodels.stats.outliers_influence import variance_inflation_factor
    features = dataframe.drop(columns=[exclude_col])
    vif_data = pd.DataFrame()
    vif_data["–ü—Ä–∏–∑–Ω–∞–∫"] = features.columns
    vif_data["VIF"] = [variance_inflation_factor(features.values, i) 
                      for i in range(features.shape[1])]
    return vif_data.sort_values('VIF', ascending=False)

# –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
features = df_hr.drop(columns=['–∑–∞—Ä–ø–ª–∞—Ç–∞'])
corr_matrix = features.corr()
print("–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞:")
print(corr_matrix.round(3))

# –ü–æ–∏—Å–∫ –≤—ã—Å–æ–∫–∏—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
high_corr_pairs = []
for i in range(len(corr_matrix.columns)):
    for j in range(i+1, len(corr_matrix.columns)):
        if abs(corr_matrix.iloc[i, j]) > 0.6:  # –ø–æ—Ä–æ–≥ 0.6
            high_corr_pairs.append((
                corr_matrix.columns[i], 
                corr_matrix.columns[j], 
                corr_matrix.iloc[i, j]
            ))

print("\n–í—ã—Å–æ–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (>0.6):")
for var1, var2, corr in high_corr_pairs:
    print(f"  {var1} ‚Üî {var2}: {corr:.3f}")
```
</details>

<br>

<details>
<summary>**~~üí° –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤~~**</summary>

–ü–æ–¥—É–º–∞–π—Ç–µ –æ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –≥—Ä—É–ø–ø–∞—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞**: –æ–ø—ã—Ç_–ª–µ—Ç, –ø—Ä–æ–µ–∫—Ç—ã, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞
- **–ú—è–≥–∫–∏–µ –Ω–∞–≤—ã–∫–∏**: –ª–∏–¥–µ—Ä—Å—Ç–≤–æ, –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è  
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏**: —è–∑—ã–∫–∏_–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

–î–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –º–æ–∂–Ω–æ:

- –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –í—ã–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫
</details>

<br>

<details>
<summary>**~~üí° Feature Engineering~~**</summary>

```python
# –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–æ–∑–∏—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞
# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫ [0,1]
def normalize_feature(series):
    return (series - series.min()) / (series.max() - series.min())

# –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã
df_new = df_hr.copy()
df_new['–æ–ø—ã—Ç_norm'] = normalize_feature(df_new['–æ–ø—ã—Ç_–ª–µ—Ç'])
df_new['–ø—Ä–æ–µ–∫—Ç—ã_norm'] = normalize_feature(df_new['–ø—Ä–æ–µ–∫—Ç—ã'])
df_new['—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞_norm'] = normalize_feature(df_new['—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞'])

df_new['–∏–Ω–¥–µ–∫—Å_—ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã'] = (0.4 * df_new['–æ–ø—ã—Ç_norm'] + 
                              0.3 * df_new['–ø—Ä–æ–µ–∫—Ç—ã_norm'] + 
                              0.3 * df_new['—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞_norm'])

# –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
df_new['—É—Ä–æ–≤–µ–Ω—å_—ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã'] = 'junior'
df_new.loc[df_new['–∏–Ω–¥–µ–∫—Å_—ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã'] > 0.4, '—É—Ä–æ–≤–µ–Ω—å_—ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã'] = 'middle'
df_new.loc[df_new['–∏–Ω–¥–µ–∫—Å_—ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã'] > 0.7, '—É—Ä–æ–≤–µ–Ω—å_—ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã'] = 'senior'
```
</details>

<br>

<details>
<summary>**~~üí° –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞~~**</summary>

```python
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import r2_score

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
X_original = df_hr.drop(columns=['–∑–∞—Ä–ø–ª–∞—Ç–∞'])
X_processed = # –≤–∞—à–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
y = df_hr['–∑–∞—Ä–ø–ª–∞—Ç–∞']

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
X_train_orig, X_test_orig, y_train, y_test = train_test_split(
    X_original, y, test_size=0.3, random_state=42)
X_train_proc, X_test_proc, _, _ = train_test_split(
    X_processed, y, test_size=0.3, random_state=42)

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
model_orig = LinearRegression().fit(X_train_orig, y_train)
model_proc = LinearRegression().fit(X_train_proc, y_train)

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
r2_orig = model_orig.score(X_test_orig, y_test)
r2_proc = model_proc.score(X_test_proc, y_test)

print(f"R¬≤ –∏—Å—Ö–æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏: {r2_orig:.4f}")
print(f"R¬≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏: {r2_proc:.4f}")
```
</details>

<br>

<details>
<summary>**~~üéØ –í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ~~**</summary>

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import statsmodels
except ImportError:
    install_package("statsmodels")
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

import pandas as pd
import numpy as np
from statsmodels.stats.outliers_influence import variance_inflation_factor
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import r2_score
from sklearn.preprocessing import LabelEncoder
from statsmodels.api import add_constant

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ IT-—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
np.random.seed(42)
n = 500

years_experience = np.random.uniform(0.5, 15, n)
projects_completed = (years_experience * 2 + np.random.normal(3, 2, n)).clip(1, 30)
technical_score = (40 + years_experience * 3 + projects_completed * 0.8 +
                  np.random.normal(0, 8, n)).clip(0, 100)
leadership_score = (20 + years_experience * 2.5 + np.random.normal(0, 15, n)).clip(0, 100)
languages_known = (2 + years_experience * 0.4 + np.random.normal(0, 1.5, n)).clip(1, 8)
certifications = (years_experience * 0.3 + np.random.exponential(1, n)).clip(0, 10)
communication_score = (30 + leadership_score * 0.3 + np.random.normal(0, 20, n)).clip(0, 100)
salary = (30000 +
          years_experience * 8000 +
          technical_score * 400 +
          leadership_score * 200 +
          projects_completed * 500 +
          languages_known * 2000 +
          certifications * 1500 +
          communication_score * 100 +
          np.random.normal(0, 10000, n))

df = pd.DataFrame({
    '–æ–ø—ã—Ç_–ª–µ—Ç': years_experience,
    '–ø—Ä–æ–µ–∫—Ç—ã': projects_completed,
    '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞': technical_score,
    '–ª–∏–¥–µ—Ä—Å—Ç–≤–æ': leadership_score,
    '—è–∑—ã–∫–∏_–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è': languages_known,
    '—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã': certifications,
    '–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è': communication_score,
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': salary
})

print("–î–∞–Ω–Ω—ã–µ –æ IT-—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö:")
print(df.head())
print(f"–†–∞–∑–º–µ—Ä: {df.shape}")

def calculate_vif(dataframe, exclude_col='–∑–∞—Ä–ø–ª–∞—Ç–∞'):
    # –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    features = dataframe.select_dtypes(include=np.number)

    if exclude_col is not None and exclude_col in features.columns:
        features = features.drop(columns=[exclude_col])

    # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
    if features.empty:
        return pd.DataFrame(columns=['–ü—Ä–∏–∑–Ω–∞–∫', 'VIF'])

    df_with_const = add_constant(features, has_constant='add')

    vif_data = pd.DataFrame()
    vif_data["–ü—Ä–∏–∑–Ω–∞–∫"] = df_with_const.columns
    vif_data["VIF"] = [variance_inflation_factor(df_with_const.values, i)
                      for i in range(df_with_const.shape[1])]
    vif_data = vif_data[vif_data['–ü—Ä–∏–∑–Ω–∞–∫'] != 'const']

    return vif_data.sort_values('VIF', ascending=False)

# –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π
features = df.drop(columns=['–∑–∞—Ä–ø–ª–∞—Ç–∞'])
corr_matrix = features.corr()
print("\n–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞:")
print(corr_matrix.round(3))

# VIF –∞–Ω–∞–ª–∏–∑
print("\nVIF –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏:")
vif_before = calculate_vif(df)
print(vif_before.round(2))

print(f"\n–ü—Ä–æ–±–ª–µ–º—ã:")
high_vif = vif_before[vif_before['VIF'] >= 5]
for _, row in high_vif.iterrows():
    print(f"‚Ä¢ {row['–ü—Ä–∏–∑–Ω–∞–∫']}: VIF = {row['VIF']:.1f}")

# === –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ ===
print(f"\n=== –£–°–¢–†–ê–ù–ï–ù–ò–ï –ú–£–õ–¨–¢–ò–ö–û–õ–õ–ò–ù–ï–ê–†–ù–û–°–¢–ò ===")

df_clean = df.copy()

# –°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
# –û–ø—ã—Ç, –ø—Ä–æ–µ–∫—Ç—ã, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ - —Å–æ–∑–¥–∞–µ–º "–∏–Ω–¥–µ–∫—Å —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã"
expertise_components = ['–æ–ø—ã—Ç_–ª–µ—Ç', '–ø—Ä–æ–µ–∫—Ç—ã', '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞']

# –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫ [0,1]
for col in expertise_components:
    min_val, max_val = df_clean[col].min(), df_clean[col].max()
    df_clean[f'{col}_norm'] = (df_clean[col] - min_val) / (max_val - min_val)

# –°–æ–∑–¥–∞–µ–º –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã
df_clean['–∏–Ω–¥–µ–∫—Å_—ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã'] = (0.4 * df_clean['–æ–ø—ã—Ç_–ª–µ—Ç_norm'] +
                                0.3 * df_clean['–ø—Ä–æ–µ–∫—Ç—ã_norm'] +
                                0.3 * df_clean['—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞_norm'])

# –°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
# –õ–∏–¥–µ—Ä—Å—Ç–≤–æ –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è -> –∫–∞—Ç–µ–≥–æ—Ä–∏—è "soft skills"
df_clean['soft_skills'] = '–Ω–∏–∑–∫–∏–µ'
soft_skills_score = (df_clean['–ª–∏–¥–µ—Ä—Å—Ç–≤–æ'] + df_clean['–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è']) / 2
df_clean.loc[soft_skills_score > 40, 'soft_skills'] = '—Å—Ä–µ–¥–Ω–∏–µ'
df_clean.loc[soft_skills_score > 70, 'soft_skills'] = '–≤—ã—Å–æ–∫–∏–µ'

# –°—Ç—Ä–∞—Ç–µ–≥–∏—è 3: –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤
df_clean['—É—Ä–æ–≤–µ–Ω—å_—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö_–Ω–∞–≤—ã–∫–æ–≤'] = 'junior'
tech_level = df_clean['—è–∑—ã–∫–∏_–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è'] + df_clean['—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã']
df_clean.loc[tech_level > 6, '—É—Ä–æ–≤–µ–Ω—å_—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö_–Ω–∞–≤—ã–∫–æ–≤'] = 'middle'
df_clean.loc[tech_level > 10, '—É—Ä–æ–≤–µ–Ω—å_—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö_–Ω–∞–≤—ã–∫–æ–≤'] = 'senior'

# –£–¥–∞–ª—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
cols_to_drop = ['–æ–ø—ã—Ç_–ª–µ—Ç', '–ø—Ä–æ–µ–∫—Ç—ã', '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞', '–ª–∏–¥–µ—Ä—Å—Ç–≤–æ',
                '–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è', '—è–∑—ã–∫–∏_–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è', '—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã',
                '–æ–ø—ã—Ç_–ª–µ—Ç_norm', '–ø—Ä–æ–µ–∫—Ç—ã_norm', '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è_–æ—Ü–µ–Ω–∫–∞_norm']

df_final = df_clean.drop(columns=cols_to_drop)

print("–ò—Ç–æ–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(df_final.head())

# –ö–æ–¥–∏—Ä—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è VIF
# Use LabelEncoder for categorical features before VIF calculation
df_for_vif = df_final.drop(columns=['–∑–∞—Ä–ø–ª–∞—Ç–∞']).copy()
le1 = LabelEncoder()
le2 = LabelEncoder()
df_for_vif['soft_skills'] = le1.fit_transform(df_for_vif['soft_skills'])
df_for_vif['—É—Ä–æ–≤–µ–Ω—å_—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö_–Ω–∞–≤—ã–∫–æ–≤'] = le2.fit_transform(df_for_vif['—É—Ä–æ–≤–µ–Ω—å_—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö_–Ω–∞–≤—ã–∫–æ–≤'])

print(f"\n–û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏:")
for col in df_for_vif.columns:
    print(f"‚Ä¢ {col}")

print(f"\nVIF –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏:")
# Pass the numerically encoded DataFrame to calculate_vif
# Corrected call: Pass df_for_vif and specify exclude_col as None
vif_after = calculate_vif(df_for_vif, exclude_col=None)
print(vif_after.round(2))

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import r2_score

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –º–æ–¥–µ–ª–∏ –¥–æ –∏ –ø–æ—Å–ª–µ
X_original = df.drop(columns=['–∑–∞—Ä–ø–ª–∞—Ç–∞'])
X_final = df_for_vif # Use the numerically encoded features
y = df['–∑–∞—Ä–ø–ª–∞—Ç–∞']

X_train_orig, X_test_orig, y_train, y_test = train_test_split(X_original, y, test_size=0.3, random_state=42)
X_train_final, X_test_final, _, _ = train_test_split(X_final, y, test_size=0.3, random_state=42)

# –ú–æ–¥–µ–ª—å –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
model_orig = LinearRegression()
model_orig.fit(X_train_orig, y_train)
r2_orig = model_orig.score(X_test_orig, y_test)

# –ú–æ–¥–µ–ª—å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
model_final = LinearRegression()
model_final.fit(X_train_final, y_train)
r2_final = model_final.score(X_test_final, y_test)

print(f"\n=== –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢ ===")
print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: {len(X_original.columns)} ‚Üí {len(X_final.columns)}")
print(f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π VIF: {vif_before['VIF'].max():.1f} ‚Üí {vif_after['VIF'].max():.1f}")
print(f"R¬≤ –º–æ–¥–µ–ª–∏: {r2_orig:.4f} ‚Üí {r2_final:.4f}")

if vif_after['VIF'].max() < 5:
    print(f"\n‚úÖ –£–°–ü–ï–•: –ú—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞!")
    print(f"‚Ä¢ –í—Å–µ VIF < 5")
    print(f"‚Ä¢ –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ (–ø–æ—Ç–µ—Ä—è R¬≤: {r2_orig - r2_final:.4f})")
else:
    print(f"\n‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û–ï –£–õ–£–ß–®–ï–ù–ò–ï: VIF —Å–Ω–∏–∂–µ–Ω –¥–æ {vif_after['VIF'].max():.1f}")

print(f"\n=== –ü–†–ò–ú–ï–ù–ï–ù–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø ===")
print("1. –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã (–æ–ø—ã—Ç + –ø—Ä–æ–µ–∫—Ç—ã + —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞)")
print("2. –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è soft skills (–ª–∏–¥–µ—Ä—Å—Ç–≤–æ + –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è)")
print("3. –£—Ä–æ–≤–Ω–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤ (—è–∑—ã–∫–∏ + —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã)")
print("4. –°–æ—Ö—Ä–∞–Ω–∏–ª–∏ —Å–º—ã—Å–ª –¥–∞–Ω–Ω—ã—Ö, –Ω–æ —É—Å—Ç—Ä–∞–Ω–∏–ª–∏ –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (TODO)
---

> **üè≠ –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω–≤–µ–π–µ—Ä –Ω–∞ –∑–∞–≤–æ–¥–µ.** –°—ã—Ä—å–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω–∫–æ–≤: —Ä–µ–∑–∫–∞, —à–ª–∏—Ñ–æ–≤–∫–∞, –ø–æ–∫—Ä–∞—Å–∫–∞, —Å–±–æ—Ä–∫–∞. –ö–∞–∂–¥—ã–π —Å—Ç–∞–Ω–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ç–∞–∫—É—é –∂–µ –¥–µ—Ç–∞–ª—å –∑–∞–≤—Ç—Ä–∞, –≤–∞–º –Ω—É–∂–Ω—ã —Ç–µ –∂–µ —Å—Ç–∞–Ω–∫–∏ —Å —Ç–µ–º–∏ –∂–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏! –í –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ —Ä–æ–ª—å —Å—Ç–∞–Ω–∫–æ–≤ –∏–≥—Ä–∞—é—Ç –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏.

**Pipeline (–∫–æ–Ω–≤–µ–π–µ—Ä)** ‚Äî —ç—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –≤ –µ–¥–∏–Ω—ã–π –æ–±—ä–µ–∫—Ç. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º.

@NB(`**–ß–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞**: –û–±—É—á–∏—Ç—å —Å–∫–µ–π–ª–µ—Ä –Ω–∞ –æ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –∞ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –¥—Ä—É–≥–æ–π —Å–∫–µ–π–ª–µ—Ä –∫ —Ç–µ—Å—Ç–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º. –ò–ª–∏ –∑–∞–±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–∞–∫–æ–π-—Ç–æ —à–∞–≥ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏. Pipeline —Ä–µ—à–∞–µ—Ç —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã!`)

–°–æ–∑–¥–∞–Ω–∏–µ Pipeline
----

Pipeline –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —ç—Ç–∞–ø—ã –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –µ–¥–∏–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

---
**üìã –ü—Ä–∏–º–µ—Ä.** –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ Pipeline –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

```python
#—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
import subprocess
import sys
def install_package(package):
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--quiet", package])
try:
    import sklearn
except ImportError:
    install_package("scikit-learn")

from sklearn.pipeline import Pipeline
from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import StandardScaler, OneHotEncoder
from sklearn.impute import SimpleImputer
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
import pandas as pd
import numpy as np
import joblib
import pickle

# –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
np.random.seed(42)
n = 500

df = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': np.random.randint(18, 70, n),
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': np.random.randint(20000, 150000, n),
    '–æ–ø—ã—Ç_–ª–µ—Ç': np.random.randint(0, 30, n),
    '–≥–æ—Ä–æ–¥': np.random.choice(['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ö–∞–∑–∞–Ω—å', '–°–æ—á–∏'], n),
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': np.random.choice(['—Å—Ä–µ–¥–Ω–µ–µ', '–≤—ã—Å—à–µ–µ', '–º–∞–≥–∏—Å—Ç—Ä'], n),
    '–æ—Ç–¥–µ–ª': np.random.choice(['IT', 'HR', '–ü—Ä–æ–¥–∞–∂–∏'], n),
    '—É–≤–æ–ª–∏–ª—Å—è': np.random.choice([0, 1], n)
})

# –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏
missing_indices = np.random.choice(n, 50, replace=False)
df.loc[missing_indices[:20], '–≤–æ–∑—Ä–∞—Å—Ç'] = np.nan
df.loc[missing_indices[20:40], '–∑–∞—Ä–ø–ª–∞—Ç–∞'] = np.nan
df.loc[missing_indices[40:], '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'] = np.nan

print("–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(df.head())
print(f"\n–ü—Ä–æ–ø—É—Å–∫–∏:\n{df.isnull().sum()}")

# –†–∞–∑–¥–µ–ª—è–µ–º –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
X = df.drop('—É–≤–æ–ª–∏–ª—Å—è', axis=1)
y = df['—É–≤–æ–ª–∏–ª—Å—è']

# –†–∞–∑–¥–µ–ª—è–µ–º –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

print(f"\n–†–∞–∑–º–µ—Ä—ã –≤—ã–±–æ—Ä–æ–∫:")
print(f"Train: {X_train.shape}")
print(f"Test: {X_test.shape}")

# –®–ê–ì 1: –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
numerical_features = ['–≤–æ–∑—Ä–∞—Å—Ç', '–∑–∞—Ä–ø–ª–∞—Ç–∞', '–æ–ø—ã—Ç_–ª–µ—Ç']
categorical_features = ['–≥–æ—Ä–æ–¥', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '–æ—Ç–¥–µ–ª']

print(f"\n–ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: {numerical_features}")
print(f"–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: {categorical_features}")

# –®–ê–ì 2: –°–æ–∑–¥–∞–µ–º –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

# –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
numerical_transformer = Pipeline(steps=[
    ('imputer', SimpleImputer(strategy='median')),  # –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –º–µ–¥–∏–∞–Ω–æ–π
    ('scaler', StandardScaler())  # –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è
])

# –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
categorical_transformer = Pipeline(steps=[
    ('imputer', SimpleImputer(strategy='constant', fill_value='missing')),  # –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤
    ('onehot', OneHotEncoder(handle_unknown='ignore'))  # One-hot –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
])

# –®–ê–ì 3: –û–±—ä–µ–¥–∏–Ω—è–µ–º –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã —Å –ø–æ–º–æ—â—å—é ColumnTransformer
preprocessor = ColumnTransformer(
    transformers=[
        ('num', numerical_transformer, numerical_features),
        ('cat', categorical_transformer, categorical_features)
    ])

# –®–ê–ì 4: –°–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω—ã–π Pipeline —Å –º–æ–¥–µ–ª—å—é
full_pipeline = Pipeline(steps=[
    ('preprocessor', preprocessor),
    ('classifier', LogisticRegression(random_state=42))
])

print("\n" + "="*60)
print("–°–¢–†–£–ö–¢–£–†–ê PIPELINE:")
print("="*60)
print(full_pipeline)

# –®–ê–ì 5: –û–±—É—á–∞–µ–º Pipeline
print("\nüéØ –û–±—É—á–µ–Ω–∏–µ Pipeline...")
full_pipeline.fit(X_train, y_train)

# –®–ê–ì 6: –î–µ–ª–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
y_pred = full_pipeline.predict(X_test)
accuracy = (y_pred == y_test).mean()
print(f"–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: {accuracy:.3f}")

# –®–ê–ì 7: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ Pipeline –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
new_data = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': [25, None, 45],
    '–∑–∞—Ä–ø–ª–∞—Ç–∞': [45000, 80000, None],
    '–æ–ø—ã—Ç_–ª–µ—Ç': [2, 10, 15],
    '–≥–æ—Ä–æ–¥': ['–ú–æ—Å–∫–≤–∞', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', '–°–ü–±'],  # –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫ –Ω–µ –±—ã–ª –≤ –æ–±—É—á–µ–Ω–∏–∏!
    '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': ['–≤—ã—Å—à–µ–µ', None, '–º–∞–≥–∏—Å—Ç—Ä'],
    '–æ—Ç–¥–µ–ª': ['IT', 'HR', '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥']  # –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –Ω–µ –±—ã–ª –≤ –æ–±—É—á–µ–Ω–∏–∏!
})

print("\nüìã –ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:")
print(new_data)

predictions = full_pipeline.predict(new_data)
probabilities = full_pipeline.predict_proba(new_data)

print(f"\n–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: {predictions}")
print(f"–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —É–≤–æ–ª—å–Ω–µ–Ω–∏—è: {probabilities[:, 1].round(3)}")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ Pipeline
----

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ–±—É—á–µ–Ω–∏—è Pipeline –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ production.

---
**üìã –ü—Ä–∏–º–µ—Ä.** –†–∞–∑–ª–∏—á–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è Pipeline.

```python
import joblib
import pickle
import json
from datetime import datetime

# –°–ü–û–°–û–ë 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ joblib (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è sklearn)
print("="*60)
print("–°–ü–û–°–û–ë 1: JOBLIB")
print("="*60)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
joblib.dump(full_pipeline, 'pipeline_joblib.pkl')
print("‚úÖ Pipeline —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ 'pipeline_joblib.pkl'")

# –ó–∞–≥—Ä—É–∑–∫–∞
loaded_pipeline_joblib = joblib.load('pipeline_joblib.pkl')
print("‚úÖ Pipeline –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ 'pipeline_joblib.pkl'")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
test_predictions = loaded_pipeline_joblib.predict(X_test[:5])
print(f"–¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: {test_predictions}")

# –°–ü–û–°–û–ë 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pickle
print("\n" + "="*60)
print("–°–ü–û–°–û–ë 2: PICKLE")
print("="*60)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
with open('pipeline_pickle.pkl', 'wb') as f:
    pickle.dump(full_pipeline, f)
print("‚úÖ Pipeline —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ 'pipeline_pickle.pkl'")

# –ó–∞–≥—Ä—É–∑–∫–∞
with open('pipeline_pickle.pkl', 'rb') as f:
    loaded_pipeline_pickle = pickle.load(f)
print("‚úÖ Pipeline –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ 'pipeline_pickle.pkl'")

# –°–ü–û–°–û–ë 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
print("\n" + "="*60)
print("–°–ü–û–°–û–ë 3: PIPELINE –° –ú–ï–¢–ê–î–ê–ù–ù–´–ú–ò")
print("="*60)

# –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å —Å Pipeline –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
pipeline_package = {
    'pipeline': full_pipeline,
    'feature_names': numerical_features + categorical_features,
    'numerical_features': numerical_features,
    'categorical_features': categorical_features,
    'model_type': 'LogisticRegression',
    'created_at': datetime.now().isoformat(),
    'accuracy': accuracy,
    'version': '1.0.0',
    'training_samples': len(X_train),
    'description': 'Pipeline –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —É–≤–æ–ª—å–Ω–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤'
}

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞–∫–µ—Ç
joblib.dump(pipeline_package, 'pipeline_package.pkl')
print("‚úÖ Pipeline —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω")

# –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º
loaded_package = joblib.load('pipeline_package.pkl')
print("\nüì¶ –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –ø–∞–∫–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:")
for key, value in loaded_package.items():
    if key != 'pipeline':
        print(f"  {key}: {value}")

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ—Ç–¥–µ–ª—å–Ω–æ –≤ JSON –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
metadata = {k: v for k, v in pipeline_package.items() if k != 'pipeline'}
with open('pipeline_metadata.json', 'w', encoding='utf-8') as f:
    json.dump(metadata, f, ensure_ascii=False, indent=2)
print("\nüìÑ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ 'pipeline_metadata.json'")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

–°–æ–∑–¥–∞–Ω–∏–µ custom transformers
----

–ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω—ã —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ sklearn. –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã.

---
**üìã –ü—Ä–∏–º–µ—Ä.** –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –¥–ª—è Pipeline.

```python
from sklearn.base import BaseEstimator, TransformerMixin
import pandas as pd
import numpy as np

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±—Ä–æ—Å–æ–≤
class OutlierHandler(BaseEstimator, TransformerMixin):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±—Ä–æ—Å–æ–≤ –º–µ—Ç–æ–¥–æ–º IQR
    """
    def __init__(self, factor=1.5, method='cap'):
        self.factor = factor
        self.method = method
        self.bounds_ = {}
    
    def fit(self, X, y=None):
        """–í—ã—á–∏—Å–ª—è–µ–º –≥—Ä–∞–Ω–∏—Ü—ã –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö"""
        X_df = pd.DataFrame(X)
        
        for col in X_df.columns:
            Q1 = X_df[col].quantile(0.25)
            Q3 = X_df[col].quantile(0.75)
            IQR = Q3 - Q1
            
            lower_bound = Q1 - self.factor * IQR
            upper_bound = Q3 + self.factor * IQR
            
            self.bounds_[col] = (lower_bound, upper_bound)
        
        return self
    
    def transform(self, X):
        """–ü—Ä–∏–º–µ–Ω—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—ã–±—Ä–æ—Å–æ–≤"""
        X_df = pd.DataFrame(X).copy()
        
        for col in X_df.columns:
            lower, upper = self.bounds_[col]
            
            if self.method == 'cap':
                # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
                X_df[col] = X_df[col].clip(lower, upper)
            elif self.method == 'remove':
                # –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ NaN (–ø–æ—Ç–æ–º –Ω—É–∂–µ–Ω –∏–º–ø—É—Ç–µ—Ä)
                mask = (X_df[col] < lower) | (X_df[col] > upper)
                X_df.loc[mask, col] = np.nan
        
        return X_df.values

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
class FeatureEngineer(BaseEstimator, TransformerMixin):
    """
    –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    """
    def __init__(self, create_ratios=True, create_logs=True):
        self.create_ratios = create_ratios
        self.create_logs = create_logs
    
    def fit(self, X, y=None):
        return self
    
    def transform(self, X):
        X_df = pd.DataFrame(X)
        
        # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –ø–µ—Ä–≤—ã–µ 3 —Å—Ç–æ–ª–±—Ü–∞ —ç—Ç–æ –≤–æ–∑—Ä–∞—Å—Ç, –∑–∞—Ä–ø–ª–∞—Ç–∞, –æ–ø—ã—Ç
        if self.create_ratios and X_df.shape[1] >= 3:
            # –ó–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∞ –≥–æ–¥ –æ–ø—ã—Ç–∞
            X_df['salary_per_year'] = X_df.iloc[:, 1] / (X_df.iloc[:, 2] + 1)
            # –í–æ–∑—Ä–∞—Å—Ç –º–∏–Ω—É—Å –æ–ø—ã—Ç (–ø—Ä–∏–º–µ—Ä–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã)
            X_df['start_age'] = X_df.iloc[:, 0] - X_df.iloc[:, 2]
        
        if self.create_logs:
            # –õ–æ–≥–∞—Ä–∏—Ñ–º –∑–∞—Ä–ø–ª–∞—Ç—ã
            X_df['log_salary'] = np.log1p(X_df.iloc[:, 1])
        
        return X_df.values

# –°–æ–∑–¥–∞–µ–º Pipeline —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞–º–∏
print("="*60)
print("PIPELINE –° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ú–ò –¢–†–ê–ù–°–§–û–†–ú–ï–†–ê–ú–ò")
print("="*60)

# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
advanced_numerical_transformer = Pipeline(steps=[
    ('outlier_handler', OutlierHandler(factor=3, method='cap')),
    ('imputer', SimpleImputer(strategy='median')),
    ('feature_engineer', FeatureEngineer()),
    ('scaler', StandardScaler())
])

# –ù–æ–≤—ã–π –ø–æ–ª–Ω—ã–π Pipeline
advanced_preprocessor = ColumnTransformer(
    transformers=[
        ('num', advanced_numerical_transformer, numerical_features),
        ('cat', categorical_transformer, categorical_features)
    ])

advanced_pipeline = Pipeline(steps=[
    ('preprocessor', advanced_preprocessor),
    ('classifier', LogisticRegression(random_state=42, max_iter=1000))
])

# –û–±—É—á–∞–µ–º
print("üéØ –û–±—É—á–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ Pipeline...")
advanced_pipeline.fit(X_train, y_train)

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
from sklearn.metrics import classification_report

y_pred_basic = full_pipeline.predict(X_test)
y_pred_advanced = advanced_pipeline.predict(X_test)

print("\nüìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Pipeline:")
print("\n–ë–∞–∑–æ–≤—ã–π Pipeline:")
print(classification_report(y_test, y_pred_basic, target_names=['–û—Å—Ç–∞–ª—Å—è', '–£–≤–æ–ª–∏–ª—Å—è']))

print("–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π Pipeline:")
print(classification_report(y_test, y_pred_advanced, target_names=['–û—Å—Ç–∞–ª—Å—è', '–£–≤–æ–ª–∏–ª—Å—è']))

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π Pipeline
joblib.dump(advanced_pipeline, 'advanced_pipeline.pkl')
print("\n‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π Pipeline —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
----

–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---
**üìã –ü—Ä–∏–º–µ—Ä.** –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Pipeline.

```python
import json
import hashlib
from datetime import datetime
import pandas as pd

class PipelineManager:
    """
    –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏—è–º–∏ Pipeline
    """
    def __init__(self, base_path='./pipelines'):
        self.base_path = base_path
        self.history = []
    
    def save_pipeline(self, pipeline, X_train, y_train, description="", version=None):
        """
        –°–æ—Ö—Ä–∞–Ω—è–µ—Ç Pipeline —Å –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
        """
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–µ—Ä—Å–∏—é –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–∞
        if version is None:
            version = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        # –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
        doc = {
            'version': version,
            'created_at': datetime.now().isoformat(),
            'description': description,
            'training_data': {
                'n_samples': len(X_train),
                'n_features': X_train.shape[1],
                'features': list(X_train.columns) if hasattr(X_train, 'columns') else None,
                'target_distribution': pd.Series(y_train).value_counts().to_dict()
            },
            'pipeline_structure': str(pipeline),
            'preprocessing_steps': self._extract_steps(pipeline),
            'parameters': pipeline.get_params()
        }
        
        # –°–æ–∑–¥–∞–µ–º —Ö—ç—à –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
        pipeline_bytes = pickle.dumps(pipeline)
        doc['hash'] = hashlib.sha256(pipeline_bytes).hexdigest()
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º Pipeline
        pipeline_file = f"{self.base_path}/pipeline_{version}.pkl"
        joblib.dump(pipeline, pipeline_file)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
        doc_file = f"{self.base_path}/pipeline_{version}_doc.json"
        with open(doc_file, 'w', encoding='utf-8') as f:
            json.dump(doc, f, ensure_ascii=False, indent=2)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        self.history.append(doc)
        
        print(f"‚úÖ Pipeline –≤–µ—Ä—Å–∏–∏ {version} —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
        print(f"üìÅ –§–∞–π–ª—ã: {pipeline_file}, {doc_file}")
        
        return version
    
    def _extract_steps(self, pipeline):
        """–ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —à–∞–≥–∞—Ö Pipeline"""
        steps_info = []
        
        if hasattr(pipeline, 'steps'):
            for name, step in pipeline.steps:
                step_info = {
                    'name': name,
                    'class': step.__class__.__name__,
                    'parameters': step.get_params() if hasattr(step, 'get_params') else {}
                }
                steps_info.append(step_info)
        
        return steps_info
    
    def load_pipeline(self, version):
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç Pipeline —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏"""
        pipeline_file = f"{self.base_path}/pipeline_{version}.pkl"
        doc_file = f"{self.base_path}/pipeline_{version}_doc.json"
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º Pipeline
        pipeline = joblib.load(pipeline_file)
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
        with open(doc_file, 'r', encoding='utf-8') as f:
            doc = json.load(f)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
        pipeline_bytes = pickle.dumps(pipeline)
        current_hash = hashlib.sha256(pipeline_bytes).hexdigest()
        
        if current_hash != doc['hash']:
            print("‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: —Ö—ç—à Pipeline –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç! –í–æ–∑–º–æ–∂–Ω–æ —Ñ–∞–π–ª –±—ã–ª –∏–∑–º–µ–Ω–µ–Ω.")
        
        return pipeline, doc
    
    def compare_versions(self, version1, version2):
        """–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –¥–≤–µ –≤–µ—Ä—Å–∏–∏ Pipeline"""
        _, doc1 = self.load_pipeline(version1)
        _, doc2 = self.load_pipeline(version2)
        
        print(f"üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π {version1} –∏ {version2}")
        print("="*50)
        
        # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        comparisons = [
            ('–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è', doc1['created_at'], doc2['created_at']),
            ('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—É—á–∞—é—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤', 
             doc1['training_data']['n_samples'], 
             doc2['training_data']['n_samples']),
            ('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤', 
             doc1['training_data']['n_features'], 
             doc2['training_data']['n_features']),
            ('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤', 
             len(doc1['preprocessing_steps']), 
             len(doc2['preprocessing_steps']))
        ]
        
        for name, val1, val2 in comparisons:
            status = "‚úÖ" if val1 == val2 else "‚ùå"
            print(f"{status} {name}: {val1} vs {val2}")
        
        return doc1, doc2

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
import os
os.makedirs('./pipelines', exist_ok=True)

manager = PipelineManager()

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∞–∑–æ–≤—É—é –≤–µ—Ä—Å–∏—é
version1 = manager.save_pipeline(
    full_pipeline,
    X_train,
    y_train,
    description="–ë–∞–∑–æ–≤—ã–π Pipeline —Å –∏–º–ø—É—Ç–∞—Ü–∏–µ–π –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–µ–π"
)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —É–ª—É—á—à–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
version2 = manager.save_pipeline(
    advanced_pipeline,
    X_train,
    y_train,
    description="–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π Pipeline —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤—ã–±—Ä–æ—Å–æ–≤ –∏ feature engineering"
)

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –≤–µ—Ä—Å–∏–∏
print("\n")
manager.compare_versions(version1, version2)

# –°–æ–∑–¥–∞–µ–º –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
print("\n" + "="*60)
print("üìù –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø –ü–†–ï–î–û–ë–†–ê–ë–û–¢–ö–ò")
print("="*60)

documentation = """
## Pipeline –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö v2.0

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã:
1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤** (OutlierHandler)
   - –ú–µ—Ç–æ–¥: IQR —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º 3
   - –°—Ç—Ä–∞—Ç–µ–≥–∏—è: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π (capping)

2. **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤** (SimpleImputer)
   - –ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: –º–µ–¥–∏–∞–Ω–∞
   - –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ 'missing'

3. **Feature Engineering** (FeatureEngineer)
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π: –∑–∞—Ä–ø–ª–∞—Ç–∞/–æ–ø—ã—Ç
   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö: –≤–æ–∑—Ä–∞—Å—Ç –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
   - –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** (StandardScaler)
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

5. **–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** (OneHotEncoder)
   - One-hot –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å handle_unknown='ignore'

### –í–∞–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:
- –í—ã–±—Ä–æ—Å—ã –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è, –∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ–¥–∏–∞–Ω–∞ –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –≤—ã–±—Ä–æ—Å–∞–º
- –ù–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ production –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –í–µ—Ä—Å–∏–∏:
- v1.0: –ë–∞–∑–æ–≤–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
- v2.0: –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ feature engineering

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞:
- Accuracy –Ω–∞ —Ç–µ—Å—Ç–µ: {:.3f}
""".format(accuracy)

print(documentation)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
with open('./pipelines/README.md', 'w', encoding='utf-8') as f:
    f.write(documentation)

print("‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ './pipelines/README.md'")
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

Best Practices –¥–ª—è Pipeline
----

**1. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Pipeline –≤ production**

- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–æ—Ä—è–¥–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
- –£–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

**2. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä—É–π—Ç–µ –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ**

- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ Pipeline
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏—á–∏–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π (Git)

**3. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ Pipeline**

```python
def test_pipeline(pipeline, X_sample):
    """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Pipeline –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö"""
    
    # –¢–µ—Å—Ç 1: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
    X_with_nan = X_sample.copy()
    X_with_nan.iloc[0, 0] = np.nan
    try:
        pipeline.transform(X_with_nan)
        print("‚úÖ –¢–µ—Å—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø—Ä–æ–π–¥–µ–Ω")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤: {e}")
    
    # –¢–µ—Å—Ç 2: –ù–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    if '–≥–æ—Ä–æ–¥' in X_sample.columns:
        X_new_cat = X_sample.copy()
        X_new_cat.iloc[0, X_sample.columns.get_loc('–≥–æ—Ä–æ–¥')] = '–ù–æ–≤—ã–π–ì–æ—Ä–æ–¥'
        try:
            pipeline.transform(X_new_cat)
            print("‚úÖ –¢–µ—Å—Ç –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–æ–π–¥–µ–Ω")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {e}")
    
    # –¢–µ—Å—Ç 3: –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    X_extreme = X_sample.copy()
    X_extreme.iloc[0, 0] = X_sample.iloc[:, 0].max() * 100
    try:
        result = pipeline.transform(X_extreme)
        print("‚úÖ –¢–µ—Å—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–π–¥–µ–Ω")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: {e}")

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–∞—à Pipeline
test_pipeline(advanced_pipeline, X_test[:5])
```

**4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ production**

- –õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –ê–ª–µ—Ä—Ç–∏—Ç–µ –ø—Ä–∏ –∞–Ω–æ–º–∞–ª–∏—è—Ö

**5. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è**

- –ü–æ—á–µ–º—É –≤—ã–±—Ä–∞–Ω –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –∏–º–ø—É—Ç–∞—Ü–∏–∏?
- –ö–∞–∫–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–ª–∏—Å—å?
- –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–∏–ª–∏—Å—å?

@NB(`Pipeline –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω, —á—Ç–æ–±—ã –Ω–æ–≤—ã–π —á–ª–µ–Ω –∫–æ–º–∞–Ω–¥—ã –º–æ–≥ –ø–æ–Ω—è—Ç—å –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤—Å—é –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –±–µ–∑ –≤–∞—à–µ–π –ø–æ–º–æ—â–∏.`)

### –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

1. **–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö**

- [ ] `df.info()` -- —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–ø—É—Å–∫–∏
- [ ] `df.describe()` -- —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
- [ ] `df.value_counts()` -- –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö
- [ ] –ü–æ–∏—Å–∫ –∞–Ω–æ–º–∞–ª–∏–π –∏ –≤—ã–±—Ä–æ—Å–æ–≤

2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**

- [ ] `train_test_split` –î–û –ª—é–±–æ–π –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
- [ ] –°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –§–∏–∫—Å–∞—Ü–∏—è random_state

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**

- [ ] –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—Ä–æ–¥—ã –ø—Ä–æ–ø—É—Å–∫–æ–≤ (MCAR/MAR/MNAR)
- [ ] –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: —É–¥–∞–ª–µ–Ω–∏–µ/–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ/–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
- [ ] –î–ª—è —á–∏—Å–ª–æ–≤—ã—Ö: `mean`/`median` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
- [ ] –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö: `mode`/–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –æ—à–∏–±–æ–∫**

- [ ] –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±—Ä–æ—Å–æ–≤ (Boxplot, –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã, scatter-plot)
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ (—É–¥–∞–ª–µ–Ω–∏–µ, –∑–∞–º–µ–Ω–∞ –Ω–∞ –∫–≤–∞–Ω—Ç–∏–ª–∏, winsorization, –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—à–∏–±–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –æ–ø–µ—á–∞—Ç–∫–∏)

5. **–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**

- [ ] –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ/–ø–æ—Ä—è–¥–∫–æ–≤—ã–µ
- [ ] –ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ: One-Hot/Target/Binary encoding
- [ ] –ü–æ—Ä—è–¥–∫–æ–≤—ã–µ: Label encoding —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–æ—Ä—è–¥–∫–æ–º
- [ ] `handle_unknown='ignore'` –¥–ª—è One-Hot

6. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**

- [ ] `StandardScaler` –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] `RobustScaler` –ø—Ä–∏ –≤—ã–±—Ä–æ—Å–∞—Ö
- [ ] `MinMaxScaler` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- [ ] `Fit` —Ç–æ–ª—å–∫–æ –Ω–∞ train, `transform` –Ω–∞ train –∏ test

7. **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏**  

- [ ] –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ ($>0.8$ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ)
- [ ] VIF ($>10$ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ)
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ/PCA/Feature engineering –¥–ª—è –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

8. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏**

- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —É—Ç–µ—á–µ–∫
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π train/test
- [ ] –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è

9. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏**

- [ ] –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –≤ –æ–¥–∏–Ω –ø–∞–π–ø–ª–∞–π–Ω
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–≥–æ–≤ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏

### üìã –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö (TODO)

–í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö –≤ HR-–æ—Ç–¥–µ–ª–µ. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –æ—Ü–µ–Ω–∫–∏ –∑–∞—Ä–ø–ª–∞—Ç —Å–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö, –Ω–æ –æ–Ω–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

- –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–ª—é—á–µ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö
- –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å –º–µ–∂–¥—É HR-–º–µ—Ç—Ä–∏–∫–∞–º–∏
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ–±—É—é—â–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- –í—ã–±—Ä–æ—Å—ã –≤ –∑–∞—Ä–ø–ª–∞—Ç–∞—Ö

**–ë–∏–∑–Ω–µ—Å-—Ü–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —á–∏—Å—Ç—ã–π dataset –¥–ª—è –º–æ–¥–µ–ª–∏ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è:

- –í—ã—è–≤–ª–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç–Ω–æ–≥–æ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–π –æ–ø–ª–∞—Ç—ã –ø—Ä–∏ –Ω–∞–π–º–µ
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ä—å–µ—Ä–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

–ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—É—é –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö, –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—è—Å—å –Ω–∞ —á–µ–∫-–ª–∏—Å—Ç –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞. 

```python
import pandas as pd
import numpy as np

# –°–æ–∑–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏
np.random.seed(42)
n = 250

departments = ['–ò–¢', '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥', '–ü—Ä–æ–¥–∞–∂–∏', 'HR']
education_levels = ['–°—Ä–µ–¥–Ω–µ–µ', '–í—ã—Å—à–µ–µ', '–ú–∞–≥–∏—Å—Ç—Ä']
cities = ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ö–∞–∑–∞–Ω—å']

employees = []
for i in range(n):
    dept = np.random.choice(departments)
    education = np.random.choice(education_levels)
    experience = np.random.randint(0, 20)
    city = np.random.choice(cities)
    
    # –í–æ–∑—Ä–∞—Å—Ç —Å–≤—è–∑–∞–Ω —Å –æ–ø—ã—Ç–æ–º, –Ω–æ –Ω–µ —Ç–æ—á–Ω–æ
    age = 23 + experience + np.random.randint(-2, 4)
    
    # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–ø—ã—Ç–∞ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
    performance = np.clip((40 + experience * 2 + 
                          {'–°—Ä–µ–¥–Ω–µ–µ': 0, '–í—ã—Å—à–µ–µ': 10, '–ú–∞–≥–∏—Å—Ç—Ä': 20}[education] + 
                          np.random.normal(0, 12)), 0, 100)
    
    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å–≤—è–∑–∞–Ω–æ —Å –æ–ø—ã—Ç–æ–º –∏ –æ—Ç–¥–µ–ª–æ–º
    dept_factor = {'–ò–¢': 1.3, '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥': 0.9, '–ü—Ä–æ–¥–∞–∂–∏': 0.7, 'HR': 0.5}[dept]
    projects = int(np.clip((experience * 1.2 * dept_factor + np.random.normal(0, 2)), 0, 30))
    
    # –ó–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤
    base_salary = {'–ò–¢': 80000, '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥': 60000, '–ü—Ä–æ–¥–∞–∂–∏': 55000, 'HR': 50000}[dept]
    education_bonus = {'–°—Ä–µ–¥–Ω–µ–µ': 0, '–í—ã—Å—à–µ–µ': 10000, '–ú–∞–≥–∏—Å—Ç—Ä': 20000}[education]
    city_factor = {'–ú–æ—Å–∫–≤–∞': 1.4, '–°–ü–±': 1.1, '–ö–∞–∑–∞–Ω—å': 0.8}[city]
    
    salary = ((base_salary + education_bonus + experience * 2000 + performance * 150) * 
              city_factor + np.random.normal(0, 7000))
    
    employees.append({
        '–∏–º—è': f'–°–æ—Ç—Ä—É–¥–Ω–∏–∫_{i+1}',
        '–≤–æ–∑—Ä–∞—Å—Ç': age,
        '–æ—Ç–¥–µ–ª': dept,
        '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': education,
        '–æ–ø—ã—Ç_–ª–µ—Ç': experience,
        '–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å': performance,
        '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø—Ä–æ–µ–∫—Ç–æ–≤': projects,
        '–≥–æ—Ä–æ–¥': city,
        '–∑–∞—Ä–ø–ª–∞—Ç–∞': max(salary, 30000)
    })

df = pd.DataFrame(employees)

# === –î–û–ë–ê–í–õ–Ø–ï–ú –ú–£–õ–¨–¢–ò–ö–û–õ–õ–ò–ù–ï–ê–†–ù–û–°–¢–¨ ===

# 1. –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–æ–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞—Ä–ø–ª–∞—Ç—ã –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
df['—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å'] = np.clip((30 + df['–∑–∞—Ä–ø–ª–∞—Ç–∞'] / 2000 + 
                                  df['–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å'] * 0.5 + 
                                  np.random.normal(0, 12)), 0, 100)

# 2. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ (—Å–≤—è–∑–∞–Ω —Å –æ–ø—ã—Ç–æ–º, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏)
df['–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π_—Ä–µ–π—Ç–∏–Ω–≥'] = np.clip((20 + df['–æ–ø—ã—Ç_–ª–µ—Ç'] * 2.5 + 
                                         df['–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å'] * 0.4 + 
                                         df['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø—Ä–æ–µ–∫—Ç–æ–≤'] * 1.2 + 
                                         np.random.normal(0, 10)), 0, 100)

# 3. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π (—Ä–∞—Å—Ç–µ—Ç —Å –æ–ø—ã—Ç–æ–º –∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–º)
df['—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏'] = np.clip((df['–æ–ø—ã—Ç_–ª–µ—Ç'] * 0.3 + 
                             df['–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π_—Ä–µ–π—Ç–∏–Ω–≥'] * 0.08 + 
                             np.random.exponential(1)), 0, 12).astype(int)

# === –î–û–ë–ê–í–õ–Ø–ï–ú –ü–†–û–ü–£–°–ö–ò ===

# –ú–æ–ª–æ–¥—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —á–∞—â–µ –Ω–µ —É–∫–∞–∑—ã–≤–∞—é—Ç –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
young_mask = df['–≤–æ–∑—Ä–∞—Å—Ç'] < 28
missing_education_idx = np.random.choice(df[young_mask].index, 
                                       size=int(len(df[young_mask]) * 0.3), replace=False)
df.loc[missing_education_idx, '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ'] = np.nan

# –°–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
random_missing = np.random.choice(df.index, size=int(n * 0.12), replace=False)
df.loc[random_missing, '—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å'] = np.nan

# === –î–û–ë–ê–í–õ–Ø–ï–ú –í–´–ë–†–û–°–´ ===
outlier_indices = np.random.choice(df.index, size=6, replace=False)
df.loc[outlier_indices, '–∑–∞—Ä–ø–ª–∞—Ç–∞'] *= np.random.uniform(2.5, 3.5, len(outlier_indices))

print("–î–ê–ù–ù–´–ï –° –ü–†–û–ë–õ–ï–ú–ê–ú–ò:")
print(f"–†–∞–∑–º–µ—Ä: {df.shape}")
print("\n–ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫:")
print(df.head())

print(f"\n–û–∂–∏–¥–∞–µ–º—ã–µ —Å–≤—è–∑–∏:")
print("‚Ä¢ –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å ‚Üî –ó–∞—Ä–ø–ª–∞—Ç–∞ ‚Üî –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å")
print("‚Ä¢ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ ‚Üî –û–ø—ã—Ç ‚Üî –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚Üî –ü—Ä–æ–µ–∫—Ç—ã")
print("‚Ä¢ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ ‚Üî –û–ø—ã—Ç ‚Üî –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥")

print(f"\n–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:")
missing_summary = df.isnull().sum()
print(missing_summary[missing_summary > 0])

print(f"\n–í–ê–®–ê –ó–ê–î–ê–ß–ê:")
print("–ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—É—é –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ —á–µ–∫–ª–∏—Å—Ç—É")

print(f"\n–ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê:")
print("‚Ä¢ –í—Å–µ VIF < 5")
print("‚Ä¢ –ù–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤")
print("‚Ä¢ R¬≤ > 0.7")
print("‚Ä¢ Pipeline –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º")

# TODO: –í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –∑–¥–µ—Å—å!
```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

<details>
<summary>~~üí° **–ü–æ–¥—Å–∫–∞–∑–∫–∞ 1.** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º~~</summary>

```python

```

</details>

<br>

<details>
<summary>~~üí° **–ü–æ–¥—Å–∫–∞–∑–∫–∞ 2.** –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤~~</summary>

```python

```

</details>

<br>

<details>
<summary>~~üí° **–ü–æ–¥—Å–∫–∞–∑–∫–∞ 3.** –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏~~</summary>

```python

```

</details>

<br>

<details>
<summary>~~üí° **–ü–æ–¥—Å–∫–∞–∑–∫–∞ 4.** Pipeline –∏ –æ—Ü–µ–Ω–∫–∞~~</summary>

```python

```

</details>

<br>

<details>
<summary>**~~üéØ –í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ~~**</summary>

```python

```
@LIA.eval(`["main.py"]`, `python3`, `python3 main.py`)

</details>

<br>

---

### ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Ç–µ—Å—Ç

@quizQuestion(`–£ –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫ "–≤–æ–∑—Ä–∞—Å—Ç" —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏. –î–∞–Ω–Ω—ã–µ —Å–∏–ª—å–Ω–æ —Å–∫–æ—à–µ–Ω—ã –≤–ø—Ä–∞–≤–æ (–º–Ω–æ–≥–æ –º–æ–ª–æ–¥—ã—Ö –ª—é–¥–µ–π). –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞—Ç—å?`)

<!-- data-randomize -->
[( )] –°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ
[(X)] –ú–µ–¥–∏–∞–Ω–∞
[( )] –ú–æ–¥–∞
[( )] –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0)

@quizQuestion(`–î–ª—è –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∏—Ç Label Encoding?`)

<!-- data-randomize -->
[( )] –ù–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ü–≤–µ—Ç, –≥–æ—Ä–æ–¥)
[(X)] –ü–æ—Ä—è–¥–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ä–∞–∑–º–µ—Ä, —Ä–µ–π—Ç–∏–Ω–≥)
[( )] –õ—é–±—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
[( )] –¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

@quizQuestion(`–í—ã –æ–±—É—á–∞–µ—Ç–µ –º–æ–¥–µ–ª—å KNN –Ω–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏: "–≤–æ–∑—Ä–∞—Å—Ç" (20-80 –ª–µ—Ç) –∏ "–¥–æ—Ö–æ–¥" (20,000-200,000 —Ä—É–±). –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –±–µ–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è?`)

<!-- data-randomize -->
[( )] –ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
[(X)] –ü—Ä–∏–∑–Ω–∞–∫ "–¥–æ—Ö–æ–¥" –±—É–¥–µ—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –∏–∑-–∑–∞ –±–æ–ª—å—à–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∞
[( )] –ü—Ä–∏–∑–Ω–∞–∫ "–≤–æ–∑—Ä–∞—Å—Ç" –±—É–¥–µ—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞—Ç—å
[( )] –ù–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç

@quizQuestion(`–ö–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ VIF —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–µ—Ä—å—ë–∑–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏?`)

<!-- data-randomize -->
[( )] VIF = 2
[( )] VIF = 5
[(X)] VIF = 15
[( )] VIF = 0.5

@quizQuestion(`–ß—Ç–æ –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–æ–º —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö?`)

<!-- data-randomize -->
[( )] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏
[(X)] –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ train/test
[( )] –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ One-Hot Encoding
[( )] –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤

@quizQuestion(`–í –º–µ—Ç–æ–¥–µ TF-IDF –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ IDF –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–ª–æ–≤–æ:`)

<!-- data-randomize -->
[(X)] –†–µ–¥–∫–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
[( )] –ß–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ
[( )] –Ø–≤–ª—è–µ—Ç—Å—è —Å—Ç–æ–ø-—Å–ª–æ–≤–æ–º
[( )] –°–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–æ–≤

@quizQuestion(`–ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—ã–±—Ä–æ—Å–∞–º–∏ –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏?`)

<!-- data-randomize -->
[( )] StandardScaler
[( )] MinMaxScaler
[(X)] RobustScaler
[( )] –ù–∏–∫–∞–∫–æ–π

@quizQuestion(`–£ –≤–∞—Å –µ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ "–ø—Ä–æ—Ñ–µ—Å—Å–∏—è" —Å 500 —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. –ö–∞–∫–æ–π –º–µ—Ç–æ–¥ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –ù–ï –ø–æ–¥—Ö–æ–¥–∏—Ç?`)

<!-- data-randomize -->
[( )] Target Encoding
[( )] Binary Encoding
[(X)] One-Hot Encoding
[( )] Hashing Encoding

@quizQuestion(`–ß—Ç–æ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–æ–≤—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö?`)

<!-- data-randomize -->
[(X)] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å handle_unknown='ignore' –≤ OneHotEncoder
[( )] –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Å –Ω–æ–≤—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
[( )] –ü–µ—Ä–µ–æ–±—É—á–∏—Ç—å —ç–Ω–∫–æ–¥–µ—Ä –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
[( )] –ó–∞–º–µ–Ω–∏—Ç—å –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ —Å–∞–º—É—é —á–∞—Å—Ç—É—é

@quizQuestion(`–ö–∞–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è?`)

<!-- data-randomize -->
[(X)] –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ ‚Üí –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
[( )] –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ ‚Üí –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
[( )] –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
[( )] –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ ‚Üí –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ